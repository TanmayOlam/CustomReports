<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="Sales_Purchase Register_Report" language="groovy" pageWidth="1190" pageHeight="842" orientation="Landscape" columnWidth="1150" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" uuid="5227d69e-4586-4a40-9b03-1ae6164de77c">
	<property name="ireport.zoom" value="1.3636363636363635"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<property name="com.jaspersoft.studio.unit." value="pixel"/>
	<property name="net.sf.jasperreports.export.xls.font.size.fix.enabled" value="false"/>
	<property name="com.jaspersoft.studio.data.defaultdataadapter" value="OLAM_func_bi"/>
	<property name="net.sf.jasperreports.export.pdf.size.page.to.content" value="true"/>
	<property name="net.sf.jasperreports.export.xls.fit.width" value="1"/>
	<property name="net.sf.jasperreports.export.xls.ignore.cell.border" value="false"/>
	<style name="table">
		<box>
			<pen lineWidth="1.0" lineColor="#000000"/>
		</box>
	</style>
	<style name="table_TH" mode="Opaque" backcolor="#F0F8FF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="table_CH" mode="Opaque" backcolor="#FFCC00">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="table_TD" mode="Opaque" backcolor="#FFFFFF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="table 1">
		<box>
			<pen lineWidth="1.0" lineColor="#000000"/>
		</box>
	</style>
	<style name="table 1_TH" mode="Opaque" backcolor="#F0F8FF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="table 1_CH" mode="Opaque" backcolor="#BFE1FF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="table 1_TD" mode="Opaque" backcolor="#FFFFFF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<subDataset name="SPR" uuid="ad4dd323-20b6-4264-91da-bc906592733e">
		<parameter name="company" class="java.lang.String"/>
		<parameter name="cbk" class="java.util.Collection"/>
		<parameter name="LE_Filter" class="java.lang.String">
			<parameterDescription><![CDATA[]]></parameterDescription>
			<defaultValueExpression><![CDATA[$P{LE_Filter}]]></defaultValueExpression>
		</parameter>
		<parameter name="datefrom" class="java.util.Date"/>
		<parameter name="dateto" class="java.util.Date"/>
		<parameter name="as_of_date" class="java.util.Date"/>
		<parameter name="p_profit_center" class="java.util.Collection">
			<defaultValueExpression><![CDATA["%"]]></defaultValueExpression>
		</parameter>
		<parameter name="p_commodity" class="java.util.Collection">
			<defaultValueExpression><![CDATA[]]></defaultValueExpression>
		</parameter>
		<parameter name="s_profit_center" class="java.util.Collection">
			<defaultValueExpression><![CDATA[]]></defaultValueExpression>
		</parameter>
		<parameter name="s_commodity" class="java.util.Collection">
			<defaultValueExpression><![CDATA[]]></defaultValueExpression>
		</parameter>
		<parameter name="QSTR_Filter" class="java.lang.String" isForPrompting="false">
			<defaultValueExpression><![CDATA[" AND (B.CTRBOOKCODE IS NULL OR B.CTRBOOKCODE IN ('" + $P{LE_Filter} + "'))"]]></defaultValueExpression>
		</parameter>
		<parameter name="p_realized_type" class="java.lang.String"/>
		<queryString>
			<![CDATA[SELECT
	CASE WHEN ISNULL([SALES PROFIT CENTER],'N/A') = 'N/A' THEN [PURCHASE PROFIT CENTER] ELSE [SALES PROFIT CENTER] END AS PROFIT_CENTER,
	[PURCHASE CTR. REF#] ,
	[PURCHASE PROFIT CENTER] ,
	[PURCHASE CONTRACT BOOK] ,
	[PURCHASE BL NO] ,
	[PURCHASE VOUCHER] ,
	[VOUCHER POST DATE] ,
	[VOUCHER DOC DATE] ,
	[VOUCHER DUE DATE] ,
	[VOUCHER APPLY DATE] ,
	[PURCHASE COMMODITY] ,
	[PURCHASE COUNTERPARTY] ,
	[PURCHASE COUNTERPARTY CATEGORY] ,
	[SUPPLIER COUNTRY] ,
	[ALOCATION TYPE] ,
	[ALLOCATION REF#] ,
	[PUR. DOC. TYPE] ,
	[PUR. DOC. CAUSE] ,
	[PURCHASE FIXED QTY] + [PURCHASE PROVISIONAL QTY] AS 'PURCHASE QUANTITY' ,
	[PURCHASE VALUE IN COMPANY CURR] ,
	[PURCHASE COMPANY CURRENCY] ,
	[PURCHASE UNIT PRICE] * [PURCHASE FX RATE TO COMPANY CURR] AS 'PURCHASE UNIT PRICE IN USD/MT' ,
	[PURCHASE VALUE] ,
	[VOUCHER CURRENCY] ,
	[PURCHASE UNIT PRICE] ,
	[PURCHASE FX RATE TO COMPANY CURR] ,
	[PURCHASE DISCHARGE QUANTITY] ,
	[PURCHASE PROVISIONAL QTY] ,
	[PURCHASE FIXED QTY] ,
	[PURCHASE BALANCE TO FIX] ,
	[PURCHASE FIXED PRICE] ,
	[PURCHASE TRANSPORT / TRIP NO] ,
	[REALIZED QTY] AS [PURCHASE REALIZED QTY] ,
	[SALES CTR. REF#] ,
	[SALES COMPANY] ,
	[SALES PROFIT CENTER] ,
	[SALES CONTRACT BOOK] ,
	[SALES INCOTERM] ,
	[SALES COST CENTER] ,
	[SALES GRADE] ,
	[SALES GRADE DESC] ,
	[SALES TRADER NAME] ,
	[SALES BL NO] ,
	[SALES LOAD DATE] ,
	[SALES INVOICE] ,
	[SALES EXTERNAL REFERENCE] ,
	[INVOICE DOC DATE] ,
	[INVOICE DUE DATE] ,
	[INVOICE APPLY DATE] ,
	[SALES COMMODITY] ,
	[SALES CONTRACTUAL COUNTERPARTY] ,
	[SALES COUNTERPARTY] ,
	[INTERNAL/EXTERNAL COUNTERPARTY] ,
	[SALES COUNTERPARTY CATEGORY] ,
	[CUSTOMER COUNTRY] ,
	[SALES DOC. TYPE] ,
	[SALES DOC. CAUSE] ,
	[SALES FIXED QTY] + [SALES PROVISIONAL QTY] AS 'SALES QUANTITY' ,
	[SALES VALUE IN COMPANY CURRENCY] ,
	[SALES COMPANY CURRENCY] ,
	[SALES UNIT PRICE] * [SALES FX RATE TO COMPANY CURR] AS 'SALES UNIT PRICE IN USD/MT' ,
	[SALES VALUE] ,
	[INVOICE CURRENCY] ,
	[SALES UNIT PRICE] ,
	[SALES UOM] ,
	[SALES FX RATE TO COMPANY CURR] ,
	[SALES DISCHARGE QUANTITY] ,
	[SALES PROVISIONAL QTY] ,
	[SALES FIXED QTY] ,
	[SALES BALANCE TO FIX] ,
	[SALES FIXED PRICE] ,
	[SALES TRANSPORT / TRIP NO] ,
	[REALIZED QTY] AS [SALES REALIZED QTY] ,
	[INVOICE POST DATE] ,
	[INVOICE STATUS] ,
	[VOUCHER STATUS] ,
	[REPORT STATUS] ,
	[LINKAGE VOUCHER/INVOICE] ,
	[LINKAGE STATUS]
	, [QUANTITY]
	/*v36 Addditonal field*/
	, [STOCK ADJUSTED QTY]
	, [STOCK ADJUSTMENT VALUE]
	, [PURCHASE ORIGINAL UNIT PRICE]
	/*v38 Addditonal field*/
	, [ORIGINAL PURCHASE VALUE]
	, [ORIGINAL PURCHASE VALUE IN COMPANY CURR]
	, [STOCK ADJUSTMENT VALUE IN COMPANY CURR]
FROM (
       /*STOCK*/
       SELECT DISTINCT C.CTRREF                                                                                                            AS 'PURCHASE CTR. REF#',
                       PC.PCNAME                                                                                                           AS 'PURCHASE PROFIT CENTER',
                       B.CTRBOOKNAME                                                                                                       AS 'PURCHASE CONTRACT BOOK',
                       CONVERT(NVARCHAR(100), L.REFERENCE_BLNO)                                                                            AS 'PURCHASE BL NO',
                       AH.APREF                                                                                                            AS 'PURCHASE VOUCHER',
                       CASE
                         WHEN APO.APBATCHID IS NOT NULL THEN APB.POSTDATE
                         ELSE NULL
                       END                                                                                                                 AS 'VOUCHER POST DATE',
                       AH.DOCDATE                                                                                                          AS 'VOUCHER DOC DATE',
                       AH.DUEDATE                                                                                                          AS 'VOUCHER DUE DATE',
                       AH.APPLYDATE                                                                                                        AS 'VOUCHER APPLY DATE',
                       C.COMMODITYID                                                                                                       AS 'PURCHASE COMMODITY',
                       PCP.MBRNAME                                                                                                         AS 'PURCHASE COUNTERPARTY',
                       PCC.NAME                                                                                                            AS 'PURCHASE COUNTERPARTY CATEGORY',
                       PCPC.COUNTRYNAME                                                                                                    AS 'SUPPLIER COUNTRY',
                       AL.DISCRIMINATOR_TYPE                                                                                               AS 'ALOCATION TYPE',
                       AL.REFERENCE                                                                                                        AS 'ALLOCATION REF#',
                       DT.LONGNAME                                                                                                         AS 'PUR. DOC. TYPE',
                       AC.DOCCAUSE                                                                                                         AS 'PUR. DOC. CAUSE',
                       CASE
                         WHEN ILM.NETWEIGHT IS NULL THEN AH.APBLQTY
                         ELSE ILM.NETWEIGHT
                       END                                                                                                                 AS 'QUANTITY',
                       (SELECT TOP 1 UPRICE * CASE
                                                WHEN ILM.NETWEIGHT IS NULL THEN QTY
                                                ELSE ILM.NETWEIGHT
                                              END * PERONINVVAL / 100
                        FROM   APDETAILS AD
                        WHERE  AD.APID = AH.APID
                               AND LOADID = L.ID
                               AND QTY > 0)                                                                                                AS 'ORIGINAL PURCHASE VALUE',
                       (SELECT TOP 1 UPRICE * CASE
                                                WHEN ILM.NETWEIGHT IS NULL THEN QTY
                                                ELSE ILM.NETWEIGHT
                                              END * PERONINVVAL / 100
                        FROM   APDETAILS AD
                        WHERE  AD.APID = AH.APID
                               AND LOADID = L.ID
                               AND QTY > 0) * AH.EXCHRATE                                                                                  AS 'ORIGINAL PURCHASE VALUE IN COMPANY CURR',
                       CASE
                         WHEN ILM.NETWEIGHT IS NULL THEN L.NET_WEIGHT - (SELECT COALESCE(Sum(NET_WEIGHT), 0)
                                                                         FROM   DISCHARGE
                                                                         WHERE  LOAD_ID = L.ID
                                                                                AND STATUS = 'UNLOADED')
                         ELSE ILM.NETWEIGHT - ( ILM.NETWEIGHT * (SELECT COALESCE(Sum(NET_WEIGHT), 0)
                                                                 FROM   DISCHARGE
                                                                 WHERE  LOAD_ID = L.ID
                                                                        AND STATUS = 'UNLOADED') / L.NET_WEIGHT )
                       END                                                                                                                 AS 'STOCK ADJUSTED QTY',
                       CASE
                         WHEN ILM.NETWEIGHT IS NULL THEN L.NET_WEIGHT - (SELECT COALESCE(Sum(NET_WEIGHT), 0)
                                                                         FROM   DISCHARGE
                                                                         WHERE  LOAD_ID = L.ID
                                                                                AND STATUS = 'UNLOADED')
                         ELSE ILM.NETWEIGHT - ( ILM.NETWEIGHT * (SELECT COALESCE(Sum(NET_WEIGHT), 0)
                                                                 FROM   DISCHARGE
                                                                 WHERE  LOAD_ID = L.ID
                                                                        AND STATUS = 'UNLOADED') / L.NET_WEIGHT )
                       END * (SELECT TOP 1 UPRICE
                              FROM   APDETAILS AD
                              WHERE  AD.APID = AH.APID
                                     AND LOADID = L.ID
                                     AND QTY > 0)                                                                                          AS 'STOCK ADJUSTMENT VALUE',
                       CASE
                         WHEN ILM.NETWEIGHT IS NULL THEN L.NET_WEIGHT - (SELECT COALESCE(Sum(NET_WEIGHT), 0)
                                                                         FROM   DISCHARGE
                                                                         WHERE  LOAD_ID = L.ID
                                                                                AND STATUS = 'UNLOADED')
                         ELSE ILM.NETWEIGHT - ( ILM.NETWEIGHT * (SELECT COALESCE(Sum(NET_WEIGHT), 0)
                                                                 FROM   DISCHARGE
                                                                 WHERE  LOAD_ID = L.ID
                                                                        AND STATUS = 'UNLOADED') / L.NET_WEIGHT )
                       END * (SELECT TOP 1 UPRICE
                              FROM   APDETAILS AD
                              WHERE  AD.APID = AH.APID
                                     AND LOADID = L.ID
                                     AND QTY > 0) * AH.EXCHRATE                                                                            AS 'STOCK ADJUSTMENT VALUE IN COMPANY CURR',
                       ( (SELECT TOP 1 UPRICE * CASE
                                                  WHEN ILM.NETWEIGHT IS NULL THEN 1
                                                  ELSE L.NET_WEIGHT / (SELECT COALESCE(Sum(NET_WEIGHT), 0)
                                                                       FROM   DISCHARGE
                                                                       WHERE  LOAD_ID = L.ID
                                                                              AND STATUS = 'UNLOADED')
                                                END * CASE
                                                        WHEN ILM.NETWEIGHT IS NULL THEN QTY
                                                        ELSE ILM.NETWEIGHT
                                                      END * PERONINVVAL / 100
                          FROM   APDETAILS AD
                          WHERE  AD.APID = AH.APID
                                 AND LOADID = L.ID
                                 AND QTY > 0) * AH.EXCHRATE )                                                                              AS 'PURCHASE VALUE IN COMPANY CURR',
                       GLC.CURRENCYID                                                                                                      AS 'PURCHASE COMPANY CURRENCY',
                       (SELECT TOP 1 UPRICE * CASE
                                                WHEN ILM.NETWEIGHT IS NULL THEN 1
                                                ELSE L.NET_WEIGHT / (SELECT COALESCE(Sum(NET_WEIGHT), 0)
                                                                     FROM   DISCHARGE
                                                                     WHERE  LOAD_ID = L.ID
                                                                            AND STATUS = 'UNLOADED')
                                              END * CASE
                                                      WHEN ILM.NETWEIGHT IS NULL THEN QTY
                                                      ELSE ILM.NETWEIGHT
                                                    END * PERONINVVAL / 100
                        FROM   APDETAILS AD
                        WHERE  AD.APID = AH.APID
                               AND LOADID = L.ID
                               AND QTY > 0)                                                                                                AS 'PURCHASE VALUE',
                       AH.CURRENCYID                                                                                                       AS 'VOUCHER CURRENCY',
                       (SELECT TOP 1 UPRICE * CASE
                                                WHEN ILM.NETWEIGHT IS NULL THEN 1
                                                ELSE L.NET_WEIGHT / (SELECT COALESCE(Sum(NET_WEIGHT), 0)
                                                                     FROM   DISCHARGE
                                                                     WHERE  LOAD_ID = L.ID
                                                                            AND STATUS = 'UNLOADED')
                                              END
                        FROM   APDETAILS AD
                        WHERE  AD.APID = AH.APID
                               AND LOADID = L.ID
                               AND QTY > 0)                                                                                                AS 'PURCHASE UNIT PRICE',
                       (SELECT TOP 1 UPRICE
                        FROM   APDETAILS AD
                        WHERE  AD.APID = AH.APID
                               AND LOADID = L.ID
                               AND QTY > 0)                                                                                                AS 'PURCHASE ORIGINAL UNIT PRICE',
                       (SELECT TOP 1 EXCHRATE
                        FROM   APDETAILS AD
                        WHERE  AD.APID = AH.APID
                               AND LOADID = L.ID
                               AND QTY > 0)                                                                                                AS 'PURCHASE FX RATE',
                       (SELECT COALESCE(Sum(NET_WEIGHT), 0)
                        FROM   DISCHARGE
                        WHERE  LOAD_ID = L.ID
                               AND STATUS = 'UNLOADED')                                                                                    AS 'PURCHASE DISCHARGE QUANTITY',
                       CASE
                         WHEN C.PRICEBASISID > 0 THEN COALESCE((SELECT Sum(PRICEDQTY)
                                                                FROM   CTRVCHPRICINGCENTERMATCH
                                                                WHERE  APID = AH.APID
                                                                       AND LOADID = L.ID
                                                                       AND ISPROVPRICESETTLED = 1), 0)
                         ELSE 0
                       END                                                                                                                 AS 'PURCHASE PROVISIONAL QTY',
                       CASE
                         WHEN C.PRICEBASISID > 0 THEN COALESCE((SELECT Sum(PRICEDQTY)
                                                                FROM   CTRVCHPRICINGCENTERMATCH
                                                                WHERE  APID = AH.APID
                                                                       AND LOADID = L.ID
                                                                       AND ISPRICEFIX = 1), 0)
                         ELSE COALESCE(CASE
                                         WHEN C.ISGROSSWEIGHT = 1 THEN L.GROSS_WEIGHT
                                         ELSE L.NET_WEIGHT
                                       END, 0)
                       END                                                                                                                 AS 'PURCHASE FIXED QTY',
                       CASE
                         WHEN C.PRICEBASISID > 0 THEN COALESCE(CASE
                                                                 WHEN C.ISGROSSWEIGHT = 1 THEN L.GROSS_WEIGHT
                                                                 ELSE L.NET_WEIGHT
                                                               END, 0) - COALESCE((SELECT Sum(PRICEDQTY)
                                                                                   FROM   CTRVCHPRICINGCENTERMATCH
                                                                                   WHERE  LOADID = L.ID
                                                                                          AND ISPRICEFIX = 1
                                                                                          AND APID <= AH.APID), 0)
                         ELSE 0
                       END                                                                                                                 AS 'PURCHASE BALANCE TO FIX',
                       CASE
                         WHEN C.PRICEBASISID > 0 THEN COALESCE((SELECT Sum(PRICEDQTY * TOTALPRICE) / Sum(PRICEDQTY)
                                                                FROM   CTRVCHPRICINGCENTERMATCH
                                                                WHERE  APID = AH.APID
                                                                       AND LOADID = L.ID
                                                                       AND ISPRICEFIX = 1), 0) * (SELECT TOP 1 EXCHRATE
                                                                                                  FROM   APDETAILS AD
                                                                                                  WHERE  AD.APID = AH.APID
                                                                                                         AND LOADID = L.ID
                                                                                                         AND QTY > 0)
                         ELSE (SELECT TOP 1 UPRICE
                               FROM   APDETAILS AD
                               WHERE  AD.APID = AH.APID
                                      AND LOADID = L.ID
                                      AND QTY > 0)
                       END                                                                                                                 AS 'PURCHASE FIXED PRICE',
                       Replace(Replace(Replace(Ltrim(Rtrim(L.TRANSPORT + ' / ' + PMO.TRIPNO)), Char(10), ''), Char(13), ''), Char(09), '') AS 'PURCHASE TRANSPORT / TRIP NO',
                       ARC.CTRREF                                                                                                          AS 'SALES CTR. REF#',
                       ARGL.GLBOOKNAME                                                                                                     AS 'SALES COMPANY',
                       SPC.PCNAME                                                                                                          AS 'SALES PROFIT CENTER',
                       ARB.CTRBOOKNAME                                                                                                     AS 'SALES CONTRACT BOOK',
                       ARC.CTRBASISID                                                                                                      AS 'SALES INCOTERM',
                       (SELECT TOP 1 COSTCENTER
                        FROM   ARDETAILS AD
                        WHERE  AD.ARID = AR.ARID
                               AND LOADID = SL.ID)                                                                                         AS 'SALES COST CENTER',
                       JSP.SPECNAME                                                                                                        AS 'SALES GRADE',
                       JSP.SPECDESC                                                                                                        AS 'SALES GRADE DESC',
                       TRAD.FIRST_NAME + ' ' + TRAD.LAST_NAME                                                                              AS 'SALES TRADER NAME',
                       CASE
                         WHEN AR.ARID IS NOT NULL THEN CONVERT(NVARCHAR(100), SL.REFERENCE_BLNO)
                         ELSE NULL
                       END                                                                                                                 AS 'SALES BL NO',
                       CASE
                         WHEN AR.ARID IS NOT NULL THEN SL.LOAD_DATE
                         ELSE NULL
                       END                                                                                                                 AS 'SALES LOAD DATE',
                       AR.ARREF                                                                                                            AS 'SALES INVOICE',
                       AR.SRCDOCREF                                                                                                        AS 'SALES EXTERNAL REFERENCE',
                       AR.DOCDATE                                                                                                          AS 'INVOICE DOC DATE',
                       AR.DUEDATE                                                                                                          AS 'INVOICE DUE DATE',
                       AR.APPLYDATE                                                                                                        AS 'INVOICE APPLY DATE',
                       ARC.COMMODITYID                                                                                                     AS 'SALES COMMODITY',
                       SMBR.MBRNAME                                                                                                        AS 'SALES CONTRACTUAL COUNTERPARTY',
                       SCP.MBRNAME                                                                                                         AS 'SALES COUNTERPARTY',
                       CASE
                         WHEN SCP.ISINTERCO = 1 THEN 'INTERNAL'
                         ELSE 'EXTERNAL'
                       END                                                                                                                 AS 'INTERNAL/EXTERNAL COUNTERPARTY',
                       SCC.NAME                                                                                                            AS 'SALES COUNTERPARTY CATEGORY',
                       SCPC.COUNTRYNAME                                                                                                    AS 'CUSTOMER COUNTRY',
                       ARDT.LONGNAME                                                                                                       AS 'SALES DOC. TYPE',
                       DCS.DOCCAUSE                                                                                                        AS 'SALES DOC. CAUSE',
                       (SELECT TOP 1 UPRICE * CASE
                                                WHEN ILM.NETWEIGHT IS NULL THEN QTY
                                                ELSE ILM.NETWEIGHT
                                              END * PERONINVVAL / 100
                        FROM   ARDETAILS AD
                        WHERE  AD.ARID = AR.ARID
                               AND LOADID = SL.ID) * AR.EXCHRATE                                                                           AS 'SALES VALUE IN COMPANY CURRENCY',
                       ARGL.CURRENCYID                                                                                                     AS 'SALES COMPANY CURRENCY',
                       (SELECT TOP 1 UPRICE * CASE
                                                WHEN ILM.NETWEIGHT IS NULL THEN QTY
                                                ELSE ILM.NETWEIGHT
                                              END * PERONINVVAL / 100
                        FROM   ARDETAILS AD
                        WHERE  AD.ARID = AR.ARID
                               AND LOADID = SL.ID)                                                                                         AS 'SALES VALUE',
                       AR.CURRENCYID                                                                                                       AS 'INVOICE CURRENCY',
                       (SELECT TOP 1 UPRICE
                        FROM   ARDETAILS AD
                        WHERE  AD.ARID = AR.ARID
                               AND LOADID = SL.ID)                                                                                         AS 'SALES UNIT PRICE',
                       (SELECT TOP 1 JU.SHORTNAME
                        FROM   ARDETAILS AD
                               JOIN JCIVUOM JU
                                 ON JU.UOMID = AD.UOMID
                        WHERE  AD.ARID = AR.ARID
                               AND LOADID = SL.ID)                                                                                         AS 'SALES UOM',
                       (SELECT TOP 1 EXCHRATE
                        FROM   ARDETAILS AD
                        WHERE  AD.ARID = AR.ARID
                               AND LOADID = SL.ID)                                                                                         AS 'SALES FX RATE',
                       CASE
                         WHEN AR.ARID IS NOT NULL THEN (SELECT Sum(NET_WEIGHT)
                                                        FROM   DISCHARGE
                                                        WHERE  LOAD_ID = SL.ID)
                         ELSE NULL
                       END                                                                                                                 AS 'SALES DISCHARGE QUANTITY',
                       CASE
                         WHEN AR.ARID IS NULL THEN 0
                         WHEN ARC.PRICEBASISID > 0 THEN COALESCE((SELECT Sum(PRICEDQTY)
                                                                  FROM   CTRINVPRICINGCENTERMATCH
                                                                  WHERE  ARID = AR.ARID
                                                                         AND LOADID IN (SELECT SALESLOADID
                                                                                        FROM   INVOICELOADMATCHTOPURCHASE
                                                                                        WHERE  ARID = ILM.ARID
                                                                                               AND APID = ILM.APID)
                                                                         AND ISPROVPRICESETTLED = 1), 0)
                         ELSE 0
                       END                                                                                                                 AS 'SALES PROVISIONAL QTY',
                       CASE
                         WHEN AR.ARID IS NULL THEN 0
                         WHEN ARC.PRICEBASISID > 0 THEN COALESCE((SELECT Sum(PRICEDQTY)
                                                                  FROM   CTRINVPRICINGCENTERMATCH
                                                                  WHERE  ARID = AR.ARID
                                                                         AND LOADID IN (SELECT SALESLOADID
                                                                                        FROM   INVOICELOADMATCHTOPURCHASE
                                                                                        WHERE  ARID = ILM.ARID
                                                                                               AND APID = ILM.APID)
                                                                         AND ISPRICEFIX = 1), 0)
                         ELSE ILM.NETWEIGHT
                       END                                                                                                                 AS 'SALES FIXED QTY',
                       CASE
                         WHEN AR.ARID IS NULL THEN 0
                         WHEN ARC.PRICEBASISID > 0 THEN COALESCE(CASE
                                                                   WHEN ARC.ISGROSSWEIGHT = 1 THEN SL.GROSS_WEIGHT
                                                                   ELSE SL.NET_WEIGHT
                                                                 END, 0) - COALESCE((SELECT Sum(PRICEDQTY)
                                                                                     FROM   CTRINVPRICINGCENTERMATCH
                                                                                     WHERE  LOADID IN (SELECT SALESLOADID
                                                                                                       FROM   INVOICELOADMATCHTOPURCHASE
                                                                                                       WHERE  ARID = ILM.ARID
                                                                                                              AND APID = ILM.APID)
                                                                                            AND ISPRICEFIX = 1
                                                                                            AND ARID <= AR.ARID), 0)
                         ELSE 0
                       END                                                                                                                 AS 'SALES BALANCE TO FIX',
                       CASE
                         WHEN AR.ARID IS NULL THEN 0
                         WHEN ARC.PRICEBASISID > 0 THEN COALESCE((SELECT Sum(PRICEDQTY * TOTALPRICE) / Sum(PRICEDQTY)
                                                                  FROM   CTRINVPRICINGCENTERMATCH
                                                                  WHERE  ARID = AR.ARID
                                                                         AND LOADID = SL.ID
                                                                         AND ISPRICEFIX = 1), 0) * (SELECT TOP 1 EXCHRATE
                                                                                                    FROM   ARDETAILS AD
                                                                                                    WHERE  AD.ARID = AR.ARID
                                                                                                           AND LOADID = SL.ID)
                         ELSE (SELECT TOP 1 UPRICE
                               FROM   ARDETAILS AD
                               WHERE  AD.ARID = AR.ARID
                                      AND LOADID = SL.ID)
                       END                                                                                                                 AS 'SALES FIXED PRICE',
                       CASE
                         WHEN AR.ARID IS NOT NULL THEN Replace(Replace(Replace(Ltrim(Rtrim(SL.TRANSPORT + ' / ' + SMO.TRIPNO)), Char(10), ''), Char(13), ''), Char(09), '')
                         ELSE NULL
                       END                                                                                                                 AS 'SALES TRANSPORT / TRIP NO',
                       CASE
                         WHEN ARO.ARBATCHID IS NOT NULL
                              AND APO.APBATCHID IS NOT NULL THEN Iif((SELECT TOP 1 QTY
                                                                      FROM   APDETAILS AD
                                                                      WHERE  AD.APID = AH.APID
                                                                             AND LOADID = L.ID
                                                                             AND QTY > 0) > (SELECT TOP 1 QTY
                                                                                             FROM   ARDETAILS AD
                                                                                             WHERE  AD.ARID = AR.ARID
                                                                                                    AND LOADID = SL.ID), (SELECT TOP 1 QTY
                                                                                                                          FROM   ARDETAILS AD
                                                                                                                          WHERE  AD.ARID = AR.ARID
                                                                                                                                 AND LOADID = SL.ID), (SELECT TOP 1 QTY
                                                                                                                                                       FROM   APDETAILS AD
                                                                                                                                                       WHERE  AD.APID = AH.APID
                                                                                                                                                              AND LOADID = L.ID
                                                                                                                                                              AND QTY > 0))
                         ELSE NULL
                       END                                                                                                                 AS 'REALIZED QTY',
                       CASE
                         WHEN AR.ARID IS NULL THEN NULL
                         WHEN ARO.ARBATCHID IS NOT NULL THEN ABH.POSTDATE
                         ELSE NULL
                       END                                                                                                                 AS 'INVOICE POST DATE',
                       CASE
                         WHEN AR.ARID IS NULL THEN 'N/A'
                         WHEN ARO.ARBATCHID IS NOT NULL THEN 'POSTED'
                         ELSE 'UNPOSTED'
                       END                                                                                                                 AS 'INVOICE STATUS',
                       CASE
                         WHEN APO.APBATCHID IS NOT NULL THEN 'POSTED'
                         ELSE 'UNPOSTED'
                       END                                                                                                                 AS 'VOUCHER STATUS',
                       CASE
                         WHEN ARO.ARBATCHID IS NOT NULL
                              AND APO.APBATCHID IS NOT NULL THEN 'REALIZED'
                         ELSE 'STOCK'
                       END                                                                                                                 AS 'REPORT STATUS',
                       'N/A'                                                                                                               AS 'LINKAGE VOUCHER/INVOICE',
                       'N/A'                                                                                                               AS 'LINKAGE STATUS',
                       Cast(PC.PCID AS NVARCHAR(5))                                                                                        AS purchase_pcid,
                       Cast(SPC.PCID AS NVARCHAR(5))                                                                                       AS sales_pcid,
                       GLC.GLBOOKNAME                                                                                                      AS purchase_company,
                       AH.EXCHRATE                                                                                                         AS 'PURCHASE FX RATE TO COMPANY CURR',
                       AR.EXCHRATE                                                                                                         AS 'SALES FX RATE TO COMPANY CURR'
       FROM   CTR C
              LEFT JOIN JCPROFITCENTER PC
                     ON PC.PCID = C.PCID
              LEFT JOIN CTRBOOK B
                     ON ( C.CTRBOOKID = B.CTRBOOKID )
              LEFT JOIN GLCOMPANY GLC
                     ON ( B.MBRCOMPANY = GLC.COMPANYID )
              JOIN CONTRACT CT
                ON CT.REFERENCE = C.CTRREF
              LEFT JOIN APHEADER AH
                     ON C.CTRID = AH.CTRID
                        AND AH.DOCTYPEID = 1
              LEFT JOIN JCMBR PCP
                     ON PCP.MBRID = AH.PAYTOID
              LEFT JOIN JCCOUNTERPARTYCATEGORY PCC
                     ON PCC.CPCATEID = PCP.CPCATEID
              LEFT JOIN JCCOUNTRY PCPC
                     ON PCP.MBRCOUNTRYID = PCPC.COUNTRYID
              LEFT JOIN XSAPDOCTYPE DT
                     ON AH.DOCTYPEID = DT.DOCTYPEID
              LEFT JOIN XSAPDOCCAUSE AC
                     ON AC.DOCCAUSEID = AH.DOCCAUSEID
              LEFT JOIN (SELECT BLID,
                                APID
                         FROM   CTROPSBLAPLINK
                         UNION
                         SELECT BLID,
                                APID
                         FROM   CTROPSBLINITIALAPLINK
                         UNION
                         SELECT BLID,
                                APID
                         FROM   CTROPSBLFINALAPLINK) BL
                     ON BL.APID = AH.APID
              LEFT JOIN LOAD L
                     ON BL.BLID = L.ID
              LEFT JOIN LOAD_LOCAL PLL
                     ON PLL.LOAD_ID = L.ID
              LEFT JOIN MOVEMENT_OPERATION PMO
                     ON PMO.ID = PLL.MOVEMENT_OPERATION_ID
              LEFT JOIN ALLOCATION AL
                     ON L.ALLOCATION_ID = AL.ID
              LEFT JOIN INVOICELOADMATCHTOPURCHASE IMP
                     ON IMP.APID = AH.APID
                        AND IMP.PURCHASELOADID = L.ID
              LEFT JOIN ARHEADER AR
                     ON AR.ARID = IMP.ARID
                        AND AR.DOCTYPEID = 1
                        AND AR.APPLYDATE <= $P{dateto}
              LEFT JOIN JCMBR SCP
                     ON SCP.MBRID = AR.BILLTOID
              LEFT JOIN JCCOUNTERPARTYCATEGORY SCC
                     ON SCC.CPCATEID = SCP.CPCATEID
              LEFT JOIN JCCOUNTRY SCPC
                     ON SCP.MBRCOUNTRYID = SCPC.COUNTRYID
              LEFT JOIN (SELECT Sum(COALESCE(NETWEIGHT, 0)) AS netweight,
                                ARID,
                                APID,
								salesloadid
                         FROM   INVOICELOADMATCHTOPURCHASE A
                         GROUP  BY ARID,
                                   APID,salesloadid) ILM
                     ON ILM.ARID = AR.ARID
                        AND ILM.APID = AH.APID
              LEFT JOIN LOAD SL
                     ON SL.ID = ILM.SALESLOADID
              LEFT JOIN LOAD_LOCAL SLL
                     ON SLL.LOAD_ID = SL.ID
              LEFT JOIN MOVEMENT_OPERATION SMO
                     ON SMO.ID = SLL.MOVEMENT_OPERATION_ID
              LEFT JOIN XSARDOCTYPE ARDT
                     ON AR.DOCTYPEID = ARDT.DOCTYPEID
              LEFT JOIN XSARDOCCAUSE DCS
                     ON DCS.DOCCAUSEID = AR.DOCCAUSEID
              LEFT JOIN CTR ARC
                     ON AR.CTRID = ARC.CTRID
              LEFT JOIN JCMBR SMBR
                     ON SMBR.MBRID = ARC.BYRID
              LEFT JOIN JCPROFITCENTER SPC
                     ON SPC.PCID = ARC.PCID
              LEFT JOIN JCSPECS JSP
                     ON JSP.SPECID = ARC.SPECID
              LEFT JOIN JC_USER TRAD
                     ON TRAD.ID = ARC.TRADERID
              LEFT JOIN CTRBOOK ARB
                     ON ( ARB.CTRBOOKID = ARC.CTRBOOKID )
              LEFT JOIN GLCOMPANY ARGL
                     ON ( ARB.MBRCOMPANY = ARGL.COMPANYID )
              JOIN CONTRACT_POSITION TCP
                ON TCP.ID = AL.CONTRACT_POSITION_ID_TARGET
              JOIN CONTRACT TC
                ON TC.ID = TCP.CONTRACT_ID
              LEFT JOIN ARPOSTED ARO
                     ON AR.ARBATCHID = ARO.ARBATCHID
              LEFT JOIN ARBATCH ABH
                     ON ABH.ARBATCHID = AR.ARBATCHID
              LEFT JOIN APPOSTED APO
                     ON AH.APBATCHID = APO.APBATCHID
              LEFT JOIN APBATCH APB
                     ON APB.APBATCHID = AH.APBATCHID
       WHERE  CT.CONTRACT_ROLE = 'PURCHASE'
              AND AL.DISCRIMINATOR_TYPE <> 'OPEN'
              AND AL.DISCRIMINATOR_TYPE <> 'STRING'
              AND AL.DISCRIMINATOR_TYPE NOT LIKE 'B2B%'
              AND COALESCE(AR.APPLYDATE, AH.APPLYDATE) >= $P{datefrom}
              AND COALESCE(AR.APPLYDATE, AH.APPLYDATE) <= $P{dateto}
       $P!{QSTR_Filter}
       UNION ALL
       /*B2B*/
       SELECT          C.CTRREF                                                                                                            AS 'PURCHASE CTR. REF#',
                       PC.PCNAME                                                                                                           AS 'PURCHASE PROFIT CENTER',
                       B.CTRBOOKNAME                                                                                                       AS 'PURCHASE CONTRACT BOOK',
                       CONVERT(NVARCHAR(100), L.REFERENCE_BLNO)                                                                            AS 'PURCHASE BL NO',
                       AH.APREF                                                                                                            AS 'PURCHASE VOUCHER',
                       CASE
                         WHEN APO.APBATCHID IS NOT NULL THEN APB.POSTDATE
                         ELSE NULL
                       END                                                                                                                 AS 'VOUCHER POST DATE',
                       AH.DOCDATE                                                                                                          AS 'VOUCHER DOC DATE',
                       AH.DUEDATE                                                                                                          AS 'VOUCHER DUE DATE',
                       AH.APPLYDATE                                                                                                        AS 'VOUCHER APPLY DATE',
                       C.COMMODITYID                                                                                                       AS 'PURCHASE COMMODITY',
                       PCP.MBRNAME                                                                                                         AS 'PURCHASE COUNTERPARTY',
                       PCC.NAME                                                                                                            AS 'PURCHASE COUNTERPARTY CATEGORY',
                       PCPC.COUNTRYNAME                                                                                                    AS 'SUPPLIER COUNTRY',
                       AL.DISCRIMINATOR_TYPE                                                                                               AS 'ALOCATION TYPE',
                       AL.REFERENCE                                                                                                        AS 'ALLOCATION REF#',
                       DT.LONGNAME                                                                                                         AS 'PUR. DOC. TYPE',
                       AC.DOCCAUSE                                                                                                         AS 'PUR. DOC. CAUSE',
                       Sum(COALESCE(GL.NET_WEIGHT, 0))                                                                                     AS 'QUANTITY',
                       (SELECT UPRICE * QTY * PERONINVVAL / 100
                        FROM   APDETAILS AD
                        WHERE  AD.APID = AH.APID
                               AND LINETYPEID < 6
                               AND UPRICE IS NOT NULL
                               AND LOADID = L.ID
                               AND QTY > 0)                                                                                                AS 'ORIGINAL PURCHASE VALUE',
                       (SELECT UPRICE * QTY * PERONINVVAL / 100
                        FROM   APDETAILS AD
                        WHERE  AD.APID = AH.APID
                               AND LINETYPEID < 6
                               AND UPRICE IS NOT NULL
                               AND LOADID = L.ID
                               AND QTY > 0) * AH.EXCHRATE                                                                                  AS 'ORIGINAL PURCHASE VALUE IN COMPANY CURR',
                       0                                                                                                                   AS 'STOCK ADJUSTED QTY',
                       0                                                                                                                   AS 'STOCK ADJUSTMENT VALUE',
                       0                                                                                                                   AS 'STOCK ADJUSTMENT VALUE IN COMPANY CURR',
                       (SELECT UPRICE * QTY * PERONINVVAL / 100
                        FROM   APDETAILS AD
                        WHERE  AD.APID = AH.APID
                               AND LINETYPEID < 6
                               AND UPRICE IS NOT NULL
                               AND LOADID = L.ID
                               AND QTY > 0) * AH.EXCHRATE                                                                                  AS 'PURCHASE VALUE IN COMPANY CURR',
                       GLC.CURRENCYID                                                                                                      AS 'PURCHASE COMPANY CURRENCY',
                       (SELECT UPRICE * QTY * PERONINVVAL / 100
                        FROM   APDETAILS AD
                        WHERE  AD.APID = AH.APID
                               AND LINETYPEID < 6
                               AND UPRICE IS NOT NULL
                               AND LOADID = L.ID
                               AND QTY > 0)                                                                                                AS 'PURCHASE VALUE',
                       AH.CURRENCYID                                                                                                       AS 'VOUCHER CURRENCY',
                       (SELECT UPRICE
                        FROM   APDETAILS AD
                        WHERE  AD.APID = AH.APID
                               AND LINETYPEID < 6
                               AND UPRICE IS NOT NULL
                               AND LOADID = L.ID
                               AND QTY > 0)                                                                                                AS 'PURCHASE UNIT PRICE',
                       (SELECT UPRICE
                        FROM   APDETAILS AD
                        WHERE  AD.APID = AH.APID
                               AND LINETYPEID < 6
                               AND UPRICE IS NOT NULL
                               AND LOADID = L.ID
                               AND QTY > 0)                                                                                                AS 'PURCHASE ORIGINAL UNIT PRICE',
                       (SELECT EXCHRATE
                        FROM   APDETAILS AD
                        WHERE  AD.APID = AH.APID
                               AND LINETYPEID < 6
                               AND UPRICE IS NOT NULL
                               AND LOADID = L.ID
                               AND QTY > 0)                                                                                                AS 'PURCHASE FX RATE',
                       (SELECT COALESCE(Sum(NET_WEIGHT), 0)
                        FROM   DISCHARGE
                        WHERE  LOAD_ID = L.ID
                               AND STATUS = 'UNLOADED')                                                                                    AS 'PURCHASE DISCHARGE QUANTITY',
                       CASE
                         WHEN C.PRICEBASISID > 0 THEN COALESCE((SELECT Sum(PRICEDQTY)
                                                                FROM   CTRVCHPRICINGCENTERMATCH
                                                                WHERE  APID = AH.APID
                                                                       AND LOADID = L.ID
                                                                       AND ISPROVPRICESETTLED = 1), 0)
                         ELSE 0
                       END                                                                                                                 AS 'PURCHASE PROVISIONAL QTY',
                       CASE
                         WHEN C.PRICEBASISID > 0 THEN COALESCE((SELECT Sum(PRICEDQTY)
                                                                FROM   CTRVCHPRICINGCENTERMATCH
                                                                WHERE  APID = AH.APID
                                                                       AND LOADID = L.ID
                                                                       AND ISPRICEFIX = 1), 0)
                         ELSE COALESCE(CASE
                                         WHEN C.ISGROSSWEIGHT = 1 THEN L.GROSS_WEIGHT
                                         ELSE L.NET_WEIGHT
                                       END, 0)
                       END                                                                                                                 AS 'PURCHASE FIXED QTY',
                       CASE
                         WHEN C.PRICEBASISID > 0 THEN COALESCE(CASE
                                                                 WHEN C.ISGROSSWEIGHT = 1 THEN GL.GROSS_WEIGHT
                                                                 ELSE GL.NET_WEIGHT
                                                               END, 0) - COALESCE((SELECT Sum(PRICEDQTY)
                                                                                   FROM   CTRVCHPRICINGCENTERMATCH
                                                                                   WHERE  LOADID = L.ID
                                                                                          AND ISPRICEFIX = 1
                                                                                          AND APID <= AH.APID), 0)
                         ELSE 0
                       END                                                                                                                 AS 'PURCHASE BALANCE TO FIX',
                       CASE
                         WHEN C.PRICEBASISID > 0 THEN COALESCE((SELECT Sum(PRICEDQTY * TOTALPRICE) / Sum(PRICEDQTY)
                                                                FROM   CTRVCHPRICINGCENTERMATCH
                                                                WHERE  APID = AH.APID
                                                                       AND LOADID = L.ID
                                                                       AND ISPRICEFIX = 1), 0) * (SELECT EXCHRATE
                                                                                                  FROM   APDETAILS AD
                                                                                                  WHERE  AD.APID = AH.APID
                                                                                                         AND LINETYPEID < 6
                                                                                                         AND UPRICE IS NOT NULL
                                                                                                         AND LOADID = L.ID
                                                                                                         AND QTY > 0)
                         ELSE (SELECT UPRICE
                               FROM   APDETAILS AD
                               WHERE  AD.APID = AH.APID
                                      AND LINETYPEID < 6
                                      AND UPRICE IS NOT NULL
                                      AND LOADID = L.ID
                                      AND QTY > 0)
                       END                                                                                                                 AS 'PURCHASE FIXED PRICE',
                       Replace(Replace(Replace(Ltrim(Rtrim(L.TRANSPORT + ' / ' + PMO.TRIPNO)), Char(10), ''), Char(13), ''), Char(09), '') AS 'PURCHASE TRANSPORT / TRIP NO',
                       ARC.CTRREF                                                                                                          AS 'SALES CTR. REF#',
                       ARGL.GLBOOKNAME                                                                                                     AS 'SALES COMPANY',
                       SPC.PCNAME                                                                                                          AS 'SALES PROFIT CENTER',
                       SCB.CTRBOOKNAME                                                                                                     AS 'SALES CONTRACT BOOK',
                       ARC.CTRBASISID                                                                                                      AS 'SALES INCOTERM',
                       (SELECT COSTCENTER
                        FROM   ARDETAILS AD
                        WHERE  AD.ARID = AR.ARID
                               AND LINETYPEID < 6
                               AND UPRICE IS NOT NULL
                               AND LOADID = GL.ID
                               AND QTY > 0)                                                                                                AS 'SALES COST CENTER',
                       JSP.SPECNAME                                                                                                        AS 'SALES GRADE',
                       JSP.SPECDESC                                                                                                        AS 'SALES GRADE DESC',
                       TRAD.FIRST_NAME + ' ' + TRAD.LAST_NAME                                                                              AS 'SALES TRADER NAME',
                       CASE
                         WHEN AR.ARID IS NOT NULL THEN CONVERT(NVARCHAR(100), GL.REFERENCE_BLNO)
                         ELSE NULL
                       END                                                                                                                 AS 'SALES BL NO',
                       CASE
                         WHEN AR.ARID IS NOT NULL THEN GL.LOAD_DATE
                         ELSE NULL
                       END                                                                                                                 AS 'SALES LOAD DATE',
                       AR.ARREF                                                                                                            AS 'SALES INVOICE',
                       AR.SRCDOCREF                                                                                                        AS 'SALES EXTERNAL REFERENCE',
                       AR.DOCDATE                                                                                                          AS 'INVOICE DOC DATE',
                       AR.DUEDATE                                                                                                          AS 'INVOICE DUE DATE',
                       AR.APPLYDATE                                                                                                        AS 'INVOICE APPLY DATE',
                       ARC.COMMODITYID                                                                                                     AS 'SALES COMMODITY',
                       SMBR.MBRNAME                                                                                                        AS 'SALES CONTRACTUAL COUNTERPARTY',
                       SCP.MBRNAME                                                                                                         AS 'SALES COUNTERPARTY',
                       CASE
                         WHEN SCP.ISINTERCO = 1 THEN 'INTERNAL'
                         ELSE 'EXTERNAL'
                       END                                                                                                                 AS 'INTERNAL/EXTERNAL COUNTERPARTY',
                       SCC.NAME                                                                                                            AS 'SALES COUNTERPARTY CATEGORY',
                       SCPC.COUNTRYNAME                                                                                                    AS 'CUSTOMER COUNTRY',
                       ARDT.LONGNAME                                                                                                       AS 'SALES DOC. TYPE',
                       DCS.DOCCAUSE                                                                                                        AS 'SALES DOC. CAUSE',
                       (SELECT UPRICE * QTY * PERONINVVAL / 100
                        FROM   ARDETAILS AD
                        WHERE  AD.ARID = AR.ARID
                               AND LINETYPEID < 6
                               AND UPRICE IS NOT NULL
                               AND LOADID = GL.ID
                               AND QTY > 0) * AR.EXCHRATE                                                                                  AS 'SALES VALUE IN COMPANY CURRENCY',
                       ARGL.CURRENCYID                                                                                                     AS 'SALES COMPANY CURRENCY',
                       (SELECT UPRICE * QTY * PERONINVVAL / 100
                        FROM   ARDETAILS AD
                        WHERE  AD.ARID = AR.ARID
                               AND LINETYPEID < 6
                               AND UPRICE IS NOT NULL
                               AND LOADID = GL.ID
                               AND QTY > 0)                                                                                                AS 'SALES VALUE',
                       AR.CURRENCYID                                                                                                       AS 'INVOICE CURRENCY',
                       (SELECT UPRICE
                        FROM   ARDETAILS AD
                        WHERE  AD.ARID = AR.ARID
                               AND LINETYPEID < 6
                               AND UPRICE IS NOT NULL
                               AND LOADID = GL.ID
                               AND QTY > 0)                                                                                                AS 'SALES UNIT PRICE',
                       (SELECT SHORTNAME
                        FROM   ARDETAILS AD
                               JOIN JCIVUOM JU
                                 ON JU.UOMID = AD.UOMID
                        WHERE  AD.ARID = AR.ARID
                               AND LINETYPEID < 6
                               AND UPRICE IS NOT NULL
                               AND LOADID = GL.ID
                               AND QTY > 0)                                                                                                AS 'SALES UOM',
                       (SELECT EXCHRATE
                        FROM   ARDETAILS AD
                        WHERE  AD.ARID = AR.ARID
                               AND LINETYPEID < 6
                               AND UPRICE IS NOT NULL
                               AND LOADID = GL.ID
                               AND QTY > 0)                                                                                                AS 'SALES FX RATE',
                       CASE
                         WHEN AR.ARID IS NOT NULL THEN (SELECT Sum(NET_WEIGHT)
                                                        FROM   DISCHARGE
                                                        WHERE  LOAD_ID = GL.ID)
                         ELSE NULL
                       END                                                                                                                 AS 'SALES DISCHARGE QUANTITY',
                       CASE
                         WHEN AR.ARID IS NULL THEN 0
                         WHEN ARC.PRICEBASISID > 0 THEN COALESCE((SELECT Sum(PRICEDQTY)
                                                                  FROM   CTRINVPRICINGCENTERMATCH
                                                                  WHERE  ARID = AR.ARID
                                                                         AND LOADID = GL.ID
                                                                         AND ISPROVPRICESETTLED = 1), 0)
                         ELSE 0
                       END                                                                                                                 AS 'SALES PROVISIONAL QTY',
                       CASE
                         WHEN AR.ARID IS NULL THEN 0
                         WHEN ARC.PRICEBASISID > 0 THEN COALESCE((SELECT Sum(PRICEDQTY)
                                                                  FROM   CTRINVPRICINGCENTERMATCH
                                                                  WHERE  ARID = AR.ARID
                                                                         AND LOADID = GL.ID
                                                                         AND ISPRICEFIX = 1), 0)
                         ELSE COALESCE(CASE
                                         WHEN ARC.ISGROSSWEIGHT = 1 THEN GL.GROSS_WEIGHT
                                         ELSE GL.NET_WEIGHT
                                       END, 0)
                       END                                                                                                                 AS 'SALES FIXED QTY',
                       CASE
                         WHEN AR.ARID IS NULL THEN 0
                         WHEN ARC.PRICEBASISID > 0 THEN COALESCE(CASE
                                                                   WHEN ARC.ISGROSSWEIGHT = 1 THEN GL.GROSS_WEIGHT
                                                                   ELSE GL.NET_WEIGHT
                                                                 END, 0) - COALESCE((SELECT Sum(PRICEDQTY)
                                                                                     FROM   CTRINVPRICINGCENTERMATCH
                                                                                     WHERE  LOADID = GL.ID
                                                                                            AND ISPRICEFIX = 1
                                                                                            AND ARID <= AR.ARID), 0)
                         ELSE 0
                       END                                                                                                                 AS 'SALES BALANCE TO FIX',
                       CASE
                         WHEN AR.ARID IS NULL THEN 0
                         WHEN ARC.PRICEBASISID > 0 THEN COALESCE((SELECT Sum(PRICEDQTY * TOTALPRICE) / Sum(PRICEDQTY)
                                                                  FROM   CTRINVPRICINGCENTERMATCH
                                                                  WHERE  ARID = AR.ARID
                                                                         AND LOADID = GL.ID
                                                                         AND ISPRICEFIX = 1), 0) * (SELECT EXCHRATE
                                                                                                    FROM   ARDETAILS AD
                                                                                                    WHERE  AD.ARID = AR.ARID
                                                                                                           AND LINETYPEID < 6
                                                                                                           AND UPRICE IS NOT NULL
                                                                                                           AND LOADID = GL.ID
                                                                                                           AND QTY > 0)
                         ELSE (SELECT UPRICE
                               FROM   ARDETAILS AD
                               WHERE  AD.ARID = AR.ARID
                                      AND LINETYPEID < 6
                                      AND UPRICE IS NOT NULL
                                      AND LOADID = GL.ID
                                      AND QTY > 0)
                       END                                                                                                                 AS 'SALES FIXED PRICE',
                       CASE
                         WHEN AR.ARID IS NOT NULL THEN Replace(Replace(Replace(Ltrim(Rtrim(GL.TRANSPORT + ' / ' + PMO.TRIPNO)), Char(10), ''), Char(13), ''), Char(09), '')
                         ELSE NULL
                       END                                                                                                                 AS 'SALES TRANSPORT / TRIP NO',
                       CASE
                         WHEN ARO.ARBATCHID IS NOT NULL
                              AND APO.APBATCHID IS NOT NULL THEN Iif((SELECT QTY
                                                                      FROM   APDETAILS AD
                                                                      WHERE  AD.APID = AH.APID
                                                                             AND LINETYPEID < 6
                                                                             AND UPRICE IS NOT NULL
                                                                             AND LOADID = L.ID
                                                                             AND QTY > 0) > (SELECT QTY
                                                                                             FROM   ARDETAILS AD
                                                                                             WHERE  AD.ARID = AR.ARID
                                                                                                    AND LINETYPEID < 6
                                                                                                    AND UPRICE IS NOT NULL
                                                                                                    AND LOADID = GL.ID
                                                                                                    AND QTY > 0), (SELECT QTY
                                                                                                                   FROM   ARDETAILS AD
                                                                                                                   WHERE  AD.ARID = AR.ARID
                                                                                                                          AND LINETYPEID < 6
                                                                                                                          AND UPRICE IS NOT NULL
                                                                                                                          AND LOADID = GL.ID
                                                                                                                          AND QTY > 0), (SELECT QTY
                                                                                                                                         FROM   APDETAILS AD
                                                                                                                                         WHERE  AD.APID = AH.APID
                                                                                                                                                AND LINETYPEID < 6
                                                                                                                                                AND UPRICE IS NOT NULL
                                                                                                                                                AND LOADID = L.ID
                                                                                                                                                AND QTY > 0))
                         ELSE NULL
                       END                                                                                                                 AS 'REALIZED QTY',
                       CASE
                         WHEN AR.ARID IS NULL THEN NULL
                         WHEN ARO.ARBATCHID IS NOT NULL THEN ABH.POSTDATE
                         ELSE NULL
                       END                                                                                                                 AS 'INVOICE POST DATE',
                       CASE
                         WHEN AR.ARID IS NULL THEN 'N/A'
                         WHEN ARO.ARBATCHID IS NOT NULL THEN 'POSTED'
                         ELSE 'UNPOSTED'
                       END                                                                                                                 AS 'INVOICE STATUS',
                       CASE
                         WHEN APO.APBATCHID IS NOT NULL THEN 'POSTED'
                         ELSE 'UNPOSTED'
                       END                                                                                                                 AS 'VOUCHER STATUS',
                       CASE
                         WHEN ARO.ARBATCHID IS NOT NULL
                              AND APO.APBATCHID IS NOT NULL THEN 'REALIZED'
                         ELSE 'STOCK'
                       END                                                                                                                 AS 'REPORT STATUS',
                       'N/A'                                                                                                               AS 'LINKAGE VOUCHER/INVOICE',
                       'N/A'                                                                                                               AS 'LINKAGE STATUS',
                       Cast(PC.PCID AS NVARCHAR(5))                                                                                        AS purchase_pcid,
                       Cast(SPC.PCID AS NVARCHAR(5))                                                                                       AS sales_pcid,
                       GLC.GLBOOKNAME                                                                                                      AS purchase_company,
                       AH.EXCHRATE                                                                                                         AS 'PURCHASE FX RATE TO COMPANY CURR',
                       AR.EXCHRATE                                                                                                         AS 'SALES FX RATE TO COMPANY CURR'
       FROM   CTR C
              LEFT JOIN JCPROFITCENTER PC
                     ON PC.PCID = C.PCID
              JOIN CONTRACT CT
                ON CT.REFERENCE = C.CTRREF
              LEFT JOIN CTRBOOK B
                     ON ( C.CTRBOOKID = B.CTRBOOKID )
              LEFT JOIN GLCOMPANY GLC
                     ON ( B.MBRCOMPANY = GLC.COMPANYID )
              LEFT JOIN APHEADER AH
                     ON C.CTRID = AH.CTRID
                        AND AH.DOCTYPEID = 1
              LEFT JOIN APBATCH APB
                     ON APB.APBATCHID = AH.APBATCHID
              LEFT JOIN JCMBR PCP
                     ON PCP.MBRID = AH.PAYTOID
              LEFT JOIN JCCOUNTERPARTYCATEGORY PCC
                     ON PCC.CPCATEID = PCP.CPCATEID
              LEFT JOIN JCCOUNTRY PCPC
                     ON PCP.MBRCOUNTRYID = PCPC.COUNTRYID
              LEFT JOIN XSAPDOCTYPE DT
                     ON AH.DOCTYPEID = DT.DOCTYPEID
              LEFT JOIN XSAPDOCCAUSE AC
                     ON AC.DOCCAUSEID = AH.DOCCAUSEID
              LEFT JOIN (SELECT BLID,
                                APID
                         FROM   CTROPSBLAPLINK
                         UNION
                         SELECT BLID,
                                APID
                         FROM   CTROPSBLINITIALAPLINK
                         UNION
                         SELECT BLID,
                                APID
                         FROM   CTROPSBLFINALAPLINK) BL
                     ON BL.APID = AH.APID
              LEFT JOIN LOAD L
                     ON BL.BLID = L.ID
              LEFT JOIN ALLOCATION AL
                     ON L.ALLOCATION_ID = AL.ID
              LEFT JOIN LOAD_LOCAL LL
                     ON LL.LOAD_ID = L.ID
              LEFT JOIN MOVEMENT_OPERATION PMO
                     ON PMO.ID = LL.MOVEMENT_OPERATION_ID
              LEFT JOIN LOAD_GLOBAL LG
                     ON LG.LOCAL_LOAD_ID = LL.LOAD_ID
              LEFT JOIN LOAD GL
                     ON LG.LOAD_ID = GL.ID
              LEFT JOIN LOAD_LOCAL SLL
                     ON SLL.LOAD_ID = GL.ID
              LEFT JOIN MOVEMENT_OPERATION SMO
                     ON SMO.ID = SLL.MOVEMENT_OPERATION_ID
              LEFT JOIN (SELECT AR.*,
                                A.BLID
                         FROM   ARHEADER AR
                                LEFT JOIN (SELECT BLID,
                                                  ARID
                                           FROM   CTROPSBLARLINK
                                           UNION
                                           SELECT BLID,
                                                  ARID
                                           FROM   CTROPSBLINITIALARLINK
                                           UNION
                                           SELECT BLID,
                                                  ARID
                                           FROM   CTROPSBLFINALARLINK) A
                                       ON A.ARID = AR.ARID) AR
                     ON AR.BLID = LG.LOAD_ID
                        AND AR.DOCTYPEID = 1
                        AND AR.APPLYDATE <= $P{dateto}
              LEFT JOIN CTR ARC
                     ON ARC.CTRID = AR.CTRID
              LEFT JOIN JCMBR SMBR
                     ON SMBR.MBRID = ARC.BYRID
              LEFT JOIN CTRBOOK SCB
                     ON SCB.CTRBOOKID = ARC.CTRBOOKID
              LEFT JOIN JCPROFITCENTER SPC
                     ON SPC.PCID = ARC.PCID
              LEFT JOIN JCSPECS JSP
                     ON JSP.SPECID = ARC.SPECID
              LEFT JOIN JC_USER TRAD
                     ON TRAD.ID = ARC.TRADERID
              LEFT JOIN CTRBOOK ARB
                     ON ( ARB.CTRBOOKID = ARC.CTRBOOKID )
              LEFT JOIN GLCOMPANY ARGL
                     ON ( ARB.MBRCOMPANY = ARGL.COMPANYID )
              LEFT JOIN (SELECT Sum(COALESCE(NET_WEIGHT, 0)) AS netweight,
                                ARID,
                                APID
                         FROM   LOAD L
                                LEFT JOIN ARDETAILS AR
                                       ON AR.LOADID = L.ID
                                LEFT JOIN APDETAILS AP
                                       ON AP.LOADID = L.ID
                         GROUP  BY ARID,
                                   APID) ILM
                     ON ILM.ARID = AR.ARID
                        AND ILM.APID = AH.APID
              LEFT JOIN XSARDOCTYPE ARDT
                     ON ARDT.DOCTYPEID = AR.DOCTYPEID
              LEFT JOIN XSARDOCCAUSE DCS
                     ON DCS.DOCCAUSEID = AR.DOCCAUSEID
              LEFT JOIN ARPOSTED ARO
                     ON AR.ARBATCHID = ARO.ARBATCHID
              LEFT JOIN ARBATCH ABH
                     ON ABH.ARBATCHID = AR.ARBATCHID
              LEFT JOIN APPOSTED APO
                     ON AH.APBATCHID = APO.APBATCHID
              LEFT JOIN JCMBR SCP
                     ON SCP.MBRID = AR.BILLTOID
              LEFT JOIN JCCOUNTERPARTYCATEGORY SCC
                     ON SCC.CPCATEID = SCP.CPCATEID
              LEFT JOIN JCCOUNTRY SCPC
                     ON SCP.MBRCOUNTRYID = SCPC.COUNTRYID
       WHERE  CT.CONTRACT_ROLE = 'PURCHASE'
              AND AL.DISCRIMINATOR_TYPE LIKE 'B2B%'
              AND AL.DISCRIMINATOR_TYPE <> 'STRING'
              AND LL.LOAD_MATCHING_ID IS NULL
              AND COALESCE(AR.APPLYDATE, AH.APPLYDATE) >= $P{datefrom}
              AND COALESCE(AR.APPLYDATE, AH.APPLYDATE) <= $P{dateto}
       $P!{QSTR_Filter}
       GROUP  BY AH.APID,
                 AH.APPLYDATE,
                 AH.APREF,
                 AH.CURRENCYID,
                 AH.EXCHRATE,
                 AL.DISCRIMINATOR_TYPE,
                 AL.REFERENCE,
                 APO.APBATCHID,
                 AR.APPLYDATE,
                 AR.ARID,
                 AR.ARREF,
                 AR.CURRENCYID,
                 AR.EXCHRATE,
                 ARC.COMMODITYID,
                 ARC.CTRREF,
                 ARC.ISGROSSWEIGHT,
                 ARC.PRICEBASISID,
                 ARDT.LONGNAME,
                 ARGL.CURRENCYID,
                 ARO.ARBATCHID,
                 B.CTRBOOKNAME,
                 C.COMMODITYID,
                 C.CTRREF,
                 C.ISGROSSWEIGHT,
                 C.PRICEBASISID,
                 DT.LONGNAME,
                 GL.GROSS_WEIGHT,
                 GL.ID,
                 GL.NET_WEIGHT,
                 GLC.CURRENCYID,
                 L.GROSS_WEIGHT,
                 L.ID,
                 L.NET_WEIGHT,
                 PC.PCNAME,
                 PCP.MBRNAME,
                 PCC.NAME,
                 SCB.CTRBOOKNAME,
                 SCP.MBRNAME,
                 SPC.PCNAME,
                 AC.DOCCAUSE,
                 DCS.DOCCAUSE,
                 L.REFERENCE_BLNO,
                 GL.REFERENCE_BLNO,
                 PCPC.COUNTRYNAME,
                 SCPC.COUNTRYNAME,
                 ARGL.GLBOOKNAME,
                 JSP.SPECNAME,
                 JSP.SPECDESC,
                 ABH.POSTDATE,
                 TRAD.FIRST_NAME,
                 TRAD.LAST_NAME,
                 ARC.CTRBASISID,
                 AR.SRCDOCREF,
                 GL.LOAD_DATE,
                 AR.DOCDATE,
                 AR.DUEDATE,
                 AH.DOCDATE,
                 AH.DUEDATE,
                 L.TRANSPORT,
                 PMO.TRIPNO,
                 GL.TRANSPORT,
                 PMO.TRIPNO,
                 SMBR.MBRNAME,
                 SCP.ISINTERCO,
                 SCC.NAME,
                 APB.POSTDATE,
                 Cast(PC.PCID AS NVARCHAR(5)),
                 Cast(SPC.PCID AS NVARCHAR(5)),
                 GLC.GLBOOKNAME
       UNION ALL
       /*HALF ALLOCATION*/
       SELECT          C.CTRREF                                                                                                                                                      AS 'PURCHASE CTR. REF#',
                       PC.PCNAME                                                                                                                                                     AS 'PURCHASE PROFIT CENTER',
                       B.CTRBOOKNAME                                                                                                                                                 AS 'PURCHASE CONTRACT BOOK',
                       CONVERT(NVARCHAR(100), L.REFERENCE_BLNO)                                                                                                                      AS 'PURCHASE BL NO',
                       AH.APREF                                                                                                                                                      AS 'PURCHASE VOUCHER',
                       CASE
                         WHEN APO.APBATCHID IS NOT NULL THEN APB.POSTDATE
                         ELSE NULL
                       END                                                                                                                                                           AS 'VOUCHER POST DATE',
                       AH.DOCDATE                                                                                                                                                    AS 'VOUCHER DOC DATE',
                       AH.DUEDATE                                                                                                                                                    AS 'VOUCHER DUE DATE',
                       AH.APPLYDATE                                                                                                                                                  AS 'VOUCHER APPLY DATE',
                       C.COMMODITYID                                                                                                                                                 AS 'PURCHASE COMMODITY',
                       PCP.MBRNAME                                                                                                                                                   AS 'PURCHASE COUNTERPARTY',
                       PCC.NAME                                                                                                                                                      AS 'PURCHASE COUNTERPARTY CATEGORY',
                       PCPC.COUNTRYNAME                                                                                                                                              AS 'SUPPLIER COUNTRY',
                       COALESCE(ACL.DISCRIMINATOR_TYPE, AL.DISCRIMINATOR_TYPE)                                                                                                       AS 'ALOCATION TYPE',
                       COALESCE(ACL.REFERENCE, AL.REFERENCE)                                                                                                                         AS 'ALLOCATION REF#',
                       DT.LONGNAME                                                                                                                                                   AS 'PUR. DOC. TYPE',
                       AC.DOCCAUSE                                                                                                                                                   AS 'PUR. DOC. CAUSE',
                       Sum(COALESCE(MATCH_NET_WEIGHT, GL.NET_WEIGHT, L.NET_WEIGHT))                                                                                                  AS 'QUANTITY',
                       Sum(COALESCE(MATCH_NET_WEIGHT, GL.NET_WEIGHT, L.NET_WEIGHT)) * (SELECT TOP 1 PERONINVVAL
                                                                                       FROM   APDETAILS AD
                                                                                       WHERE  AD.APID = AH.APID
                                                                                              AND PERONINVVAL IS NOT NULL) / 100 * (SELECT TOP 1 UPRICE
                                                                                                                                    FROM   APDETAILS AD
                                                                                                                                    WHERE  AD.APID = AH.APID
                                                                                                                                           AND UPRICE IS NOT NULL)                   AS 'ORIGINAL PURCHASE VALUE',
                       Sum(COALESCE(MATCH_NET_WEIGHT, GL.NET_WEIGHT, L.NET_WEIGHT)) * (SELECT TOP 1 PERONINVVAL
                                                                                       FROM   APDETAILS AD
                                                                                       WHERE  AD.APID = AH.APID
                                                                                              AND PERONINVVAL IS NOT NULL) / 100 * (SELECT TOP 1 UPRICE
                                                                                                                                    FROM   APDETAILS AD
                                                                                                                                    WHERE  AD.APID = AH.APID
                                                                                                                                           AND UPRICE IS NOT NULL) * AH.EXCHRATE     AS 'ORIGINAL PURCHASE VALUE IN COMPANY CURR',
                       CASE
                         WHEN COALESCE(ACL.DISCRIMINATOR_TYPE, AL.DISCRIMINATOR_TYPE) = 'STOCK' THEN
                           CASE
                             WHEN MATCH_NET_WEIGHT IS NULL THEN L.NET_WEIGHT - (SELECT COALESCE(Sum(NET_WEIGHT), 0)
                                                                                FROM   DISCHARGE
                                                                                WHERE  LOAD_ID = CCL.ID
                                                                                       AND STATUS = 'UNLOADED')
                             ELSE MATCH_NET_WEIGHT - ( MATCH_NET_WEIGHT * (SELECT COALESCE(Sum(NET_WEIGHT), 0)
                                                                           FROM   DISCHARGE
                                                                           WHERE  LOAD_ID = CCL.ID
                                                                                  AND STATUS = 'UNLOADED') / L.NET_WEIGHT )
                           END
                         ELSE 0
                       END                                                                                                                                                           AS 'STOCK ADJUSTED QTY',
                       CASE
                         WHEN COALESCE(ACL.DISCRIMINATOR_TYPE, AL.DISCRIMINATOR_TYPE) = 'STOCK' THEN CASE
                                                                                                       WHEN MATCH_NET_WEIGHT IS NULL THEN L.NET_WEIGHT - (SELECT COALESCE(Sum(NET_WEIGHT), 0)
                                                                                                                                                          FROM   DISCHARGE
                                                                                                                                                          WHERE  LOAD_ID = CCL.ID
                                                                                                                                                                 AND STATUS = 'UNLOADED')
                                                                                                       ELSE MATCH_NET_WEIGHT - ( MATCH_NET_WEIGHT * (SELECT COALESCE(Sum(NET_WEIGHT), 0)
                                                                                                                                                     FROM   DISCHARGE
                                                                                                                                                     WHERE  LOAD_ID = CCL.ID
                                                                                                                                                            AND STATUS = 'UNLOADED') / L.NET_WEIGHT )
                                                                                                     END * (SELECT TOP 1 UPRICE
                                                                                                            FROM   APDETAILS AD
                                                                                                            WHERE  AD.APID = AH.APID
                                                                                                                   AND UPRICE IS NOT NULL)
                         ELSE 0
                       END                                                                                                                                                           AS 'STOCK ADJUSTMENT VALUE',
                       CASE
                         WHEN COALESCE(ACL.DISCRIMINATOR_TYPE, AL.DISCRIMINATOR_TYPE) = 'STOCK' THEN CASE
                                                                                                       WHEN MATCH_NET_WEIGHT IS NULL THEN L.NET_WEIGHT - (SELECT COALESCE(Sum(NET_WEIGHT), 0)
                                                                                                                                                          FROM   DISCHARGE
                                                                                                                                                          WHERE  LOAD_ID = CCL.ID
                                                                                                                                                                 AND STATUS = 'UNLOADED')
                                                                                                       ELSE MATCH_NET_WEIGHT - ( MATCH_NET_WEIGHT * (SELECT COALESCE(Sum(NET_WEIGHT), 0)
                                                                                                                                                     FROM   DISCHARGE
                                                                                                                                                     WHERE  LOAD_ID = CCL.ID
                                                                                                                                                            AND STATUS = 'UNLOADED') / L.NET_WEIGHT )
                                                                                                     END * (SELECT TOP 1 UPRICE
                                                                                                            FROM   APDETAILS AD
                                                                                                            WHERE  AD.APID = AH.APID
                                                                                                                   AND UPRICE IS NOT NULL)
                         ELSE 0
                       END * AH.EXCHRATE                                                                                                                                             AS 'STOCK ADJUSTMENT VALUE IN COMPANY CURR',
                       ( Sum(COALESCE(MATCH_NET_WEIGHT, GL.NET_WEIGHT, L.NET_WEIGHT)) * (SELECT TOP 1 PERONINVVAL
                                                                                         FROM   APDETAILS AD
                                                                                         WHERE  AD.APID = AH.APID
                                                                                                AND PERONINVVAL IS NOT NULL) / 100 * (SELECT TOP 1 UPRICE * CASE
                                                                                                                                                              WHEN Sum(COALESCE(MATCH_NET_WEIGHT, 0)) > 0
                                                                                                                                                                   AND COALESCE(ACL.DISCRIMINATOR_TYPE, AL.DISCRIMINATOR_TYPE) = 'STOCK' THEN L.NET_WEIGHT / (SELECT COALESCE(Sum(NET_WEIGHT), 0)
                                                                                                                                                                                                                                                              FROM   DISCHARGE
                                                                                                                                                                                                                                                              WHERE  LOAD_ID = CCL.ID
                                                                                                                                                                                                                                                                     AND STATUS = 'UNLOADED')
                                                                                                                                                              ELSE 1
                                                                                                                                                            END
                                                                                                                                      FROM   APDETAILS AD
                                                                                                                                      WHERE  AD.APID = AH.APID
                                                                                                                                             AND UPRICE IS NOT NULL) * AH.EXCHRATE ) AS 'PURCHASE VALUE IN COMPANY CURR',
                       GLC.CURRENCYID                                                                                                                                                AS 'PURCHASE COMPANY CURRENCY',
                       Sum(COALESCE(MATCH_NET_WEIGHT, GL.NET_WEIGHT, L.NET_WEIGHT)) * (SELECT TOP 1 PERONINVVAL
                                                                                       FROM   APDETAILS AD
                                                                                       WHERE  AD.APID = AH.APID
                                                                                              AND PERONINVVAL IS NOT NULL) / 100 * (SELECT TOP 1 UPRICE * CASE
                                                                                                                                                            WHEN Sum(COALESCE(MATCH_NET_WEIGHT, 0)) > 0
                                                                                                                                                                 AND COALESCE(ACL.DISCRIMINATOR_TYPE, AL.DISCRIMINATOR_TYPE) = 'STOCK' THEN L.NET_WEIGHT / (SELECT COALESCE(Sum(NET_WEIGHT), 0)
                                                                                                                                                                                                                                                            FROM   DISCHARGE
                                                                                                                                                                                                                                                            WHERE  LOAD_ID = CCL.ID
                                                                                                                                                                                                                                                                   AND STATUS = 'UNLOADED')
                                                                                                                                                            ELSE 1
                                                                                                                                                          END
                                                                                                                                    FROM   APDETAILS AD
                                                                                                                                    WHERE  AD.APID = AH.APID
                                                                                                                                           AND UPRICE IS NOT NULL)                   AS 'PURCHASE VALUE',
                       AH.CURRENCYID                                                                                                                                                 AS 'VOUCHER CURRENCY',
                       (SELECT TOP 1 UPRICE * CASE
                                                WHEN Sum(COALESCE(MATCH_NET_WEIGHT, 0)) > 0
                                                     AND COALESCE(ACL.DISCRIMINATOR_TYPE, AL.DISCRIMINATOR_TYPE) = 'STOCK' THEN L.NET_WEIGHT / (SELECT COALESCE(Sum(NET_WEIGHT), 0)
                                                                                                                                                FROM   DISCHARGE
                                                                                                                                                WHERE  LOAD_ID = CCL.ID
                                                                                                                                                       AND STATUS = 'UNLOADED')
                                                ELSE 1
                                              END
                        FROM   APDETAILS AD
                        WHERE  AD.APID = AH.APID
                               AND UPRICE IS NOT NULL)                                                                                                                               AS 'PURCHASE UNIT PRICE',
                       (SELECT TOP 1 UPRICE
                        FROM   APDETAILS AD
                        WHERE  AD.APID = AH.APID
                               AND UPRICE IS NOT NULL)                                                                                                                               AS 'PURCHASE ORIGINAL UNIT PRICE',
                       (SELECT TOP 1 EXCHRATE
                        FROM   APDETAILS AD
                        WHERE  AD.APID = AH.APID
                               AND UPRICE IS NOT NULL)                                                                                                                               AS 'PURCHASE FX RATE',
                       (SELECT COALESCE(Sum(NET_WEIGHT), 0)
                        FROM   DISCHARGE
                        WHERE  LOAD_ID = CCL.ID
                               AND STATUS = 'UNLOADED')                                                                                                                              AS 'PURCHASE DISCHARGE QUANTITY',
                       CASE
                         WHEN C.PRICEBASISID > 0 THEN COALESCE((SELECT Sum(PRICEDQTY)
                                                                FROM   CTRVCHPRICINGCENTERMATCH
                                                                WHERE  APID = AH.APID
                                                                       AND LOADID = GL.ID
                                                                       AND ISPROVPRICESETTLED = 1), (SELECT Sum(PRICEDQTY)
                                                                                                     FROM   CTRVCHPRICINGCENTERMATCH
                                                                                                     WHERE  APID = AH.APID
                                                                                                            AND LOADID = L.ID
                                                                                                            AND ISPROVPRICESETTLED = 1), 0)
                         ELSE 0
                       END                                                                                                                                                           AS 'PURCHASE PROVISIONAL QTY',
                       CASE
                         WHEN C.PRICEBASISID > 0 THEN COALESCE((SELECT Sum(PRICEDQTY)
                                                                FROM   CTRVCHPRICINGCENTERMATCH
                                                                WHERE  APID = AH.APID
                                                                       AND LOADID = GL.ID
                                                                       AND ISPRICEFIX = 1), (SELECT Min(A)
                                                                                             FROM   (VALUES (COALESCE((SELECT Sum(PRICEDQTY)
                                                                                                              FROM   CTRVCHPRICINGCENTERMATCH
                                                                                                              WHERE  APID = AH.APID
                                                                                                                     AND LOADID = L.ID
                                                                                                                     AND ISPRICEFIX = 1), 0)),
                                                                                                            (( CASE
                                                                                                        WHEN C.ISGROSSWEIGHT = 1 THEN COALESCE(GL.GROSS_WEIGHT, L.GROSS_WEIGHT)
                                                                                                        ELSE COALESCE(GL.NET_WEIGHT, L.NET_WEIGHT)
                                                                                                      END ))) AS VALUE(A)), 0)
                         ELSE COALESCE(CASE
                                         WHEN C.ISGROSSWEIGHT = 1 THEN COALESCE(GL.GROSS_WEIGHT, L.GROSS_WEIGHT)
                                         ELSE COALESCE(GL.NET_WEIGHT, L.NET_WEIGHT)
                                       END, 0)
                       END                                                                                                                                                           AS 'PURCHASE FIXED QTY',
                       CASE
                         WHEN C.PRICEBASISID > 0 THEN COALESCE(CASE
                                                                 WHEN C.ISGROSSWEIGHT = 1 THEN COALESCE(GL.GROSS_WEIGHT, L.GROSS_WEIGHT)
                                                                 ELSE COALESCE(GL.NET_WEIGHT, L.NET_WEIGHT)
                                                               END, 0) - COALESCE((SELECT Sum(PRICEDQTY)
                                                                                   FROM   CTRVCHPRICINGCENTERMATCH
                                                                                   WHERE  APID = AH.APID
                                                                                          AND LOADID = GL.ID
                                                                                          AND ISPRICEFIX = 1
                                                                                          AND APID <= AH.APID), (SELECT Min(A)
                                                                                                                 FROM   (VALUES (COALESCE((SELECT Sum(PRICEDQTY)
                                                                                                                                  FROM   CTRVCHPRICINGCENTERMATCH
                                                                                                                                  WHERE  APID = AH.APID
                                                                                                                                         AND LOADID = L.ID
                                                                                                                                         AND ISPRICEFIX = 1
                                                                                                                                         AND APID <= AH.APID), 0)),
                                                                                                                                (( CASE
                                                                                                                            WHEN C.ISGROSSWEIGHT = 1 THEN COALESCE(GL.GROSS_WEIGHT, L.GROSS_WEIGHT)
                                                                                                                            ELSE COALESCE(GL.NET_WEIGHT, L.NET_WEIGHT)
                                                                                                                          END ))) AS VALUE(A)), 0)
                         ELSE 0
                       END                                                                                                                                                           AS 'PURCHASE BALANCE TO FIX',
                       CASE
                         WHEN C.PRICEBASISID > 0 THEN COALESCE((SELECT Sum(PRICEDQTY * TOTALPRICE) / Sum(PRICEDQTY)
                                                                FROM   CTRVCHPRICINGCENTERMATCH
                                                                WHERE  APID = AH.APID
                                                                       AND LOADID = GL.ID
                                                                       AND ISPRICEFIX = 1), (SELECT Sum(PRICEDQTY * TOTALPRICE) / Sum(PRICEDQTY)
                                                                                             FROM   CTRVCHPRICINGCENTERMATCH
                                                                                             WHERE  APID = AH.APID
                                                                                                    AND LOADID = L.ID
                                                                                                    AND ISPRICEFIX = 1), 0) * (SELECT TOP 1 EXCHRATE
                                                                                                                               FROM   APDETAILS AD
                                                                                                                               WHERE  AD.APID = AH.APID
                                                                                                                                      AND UPRICE IS NOT NULL)
                         ELSE (SELECT TOP 1 UPRICE
                               FROM   APDETAILS AD
                               WHERE  AD.APID = AH.APID
                                      AND UPRICE IS NOT NULL)
                       END                                                                                                                                                           AS 'PURCHASE FIXED PRICE',
                       Replace(Replace(Replace(Ltrim(Rtrim(L.TRANSPORT + ' / ' + PMO.TRIPNO)), Char(10), ''), Char(13), ''), Char(09), '')                                           AS 'PURCHASE TRANSPORT / TRIP NO',
                       ARC.CTRREF                                                                                                                                                    AS 'SALES CTR. REF#',
                       ARGL.GLBOOKNAME                                                                                                                                               AS 'SALES COMPANY',
                       SPC.PCNAME                                                                                                                                                    AS 'SALES PROFIT CENTER',
                       SCB.CTRBOOKNAME                                                                                                                                               AS 'SALES CONTRACT BOOK',
                       ARC.CTRBASISID                                                                                                                                                AS 'SALES INCOTERM',
                       (SELECT TOP 1 COSTCENTER
                        FROM   ARDETAILS AD
                        WHERE  AD.ARID = AR.ARID
                               AND UPRICE IS NOT NULL)                                                                                                                               AS 'SALES COST CENTER',
                       JSP.SPECNAME                                                                                                                                                  AS 'SALES GRADE',
                       JSP.SPECDESC                                                                                                                                                  AS 'SALES GRADE DESC',
                       TRAD.FIRST_NAME + ' ' + TRAD.LAST_NAME                                                                                                                        AS 'SALES TRADER NAME',
                       CASE
                         WHEN AR.ARID IS NOT NULL THEN CONVERT(NVARCHAR(100), CCL.REFERENCE_BLNO)
                         ELSE NULL
                       END                                                                                                                                                           AS 'SALES BL NO',
                       CASE
                         WHEN AR.ARID IS NOT NULL THEN CCL.LOAD_DATE
                         ELSE NULL
                       END                                                                                                                                                           AS 'SALES LOAD DATE',
                       AR.ARREF                                                                                                                                                      AS 'SALES INVOICE',
                       AR.SRCDOCREF                                                                                                                                                  AS 'SALES EXTERNAL REFERENCE',
                       AR.DOCDATE                                                                                                                                                    AS 'INVOICE DOC DATE',
                       AR.DUEDATE                                                                                                                                                    AS 'INVOICE DUE DATE',
                       AR.APPLYDATE                                                                                                                                                  AS 'INVOICE APPLY DATE',
                       ARC.COMMODITYID                                                                                                                                               AS 'SALES COMMODITY',
                       SMBR.MBRNAME                                                                                                                                                  AS 'SALES CONTRACTUAL COUNTERPARTY',
                       SCP.MBRNAME                                                                                                                                                   AS 'SALES COUNTERPARTY',
                       CASE
                         WHEN SCP.ISINTERCO = 1 THEN 'INTERNAL'
                         ELSE 'EXTERNAL'
                       END                                                                                                                                                           AS 'INTERNAL/EXTERNAL COUNTERPARTY',
                       SCC.NAME                                                                                                                                                      AS 'SALES COUNTERPARTY CATEGORY',
                       SCPC.COUNTRYNAME                                                                                                                                              AS 'CUSTOMER COUNTRY',
                       ARDT.LONGNAME                                                                                                                                                 AS 'SALES DOC. TYPE',
                       DCS.DOCCAUSE                                                                                                                                                  AS 'SALES DOC. CAUSE',
                       Sum(COALESCE(MATCH_NET_WEIGHT, SBL.NET_WEIGHT, 0)) * (SELECT TOP 1 PERONINVVAL
                                                                             FROM   ARDETAILS AD
                                                                             WHERE  AD.ARID = AR.ARID
                                                                                    AND PERONINVVAL IS NOT NULL) / 100 * (SELECT TOP 1 UPRICE
                                                                                                                          FROM   ARDETAILS AD
                                                                                                                          WHERE  AD.ARID = AR.ARID
                                                                                                                                 AND UPRICE IS NOT NULL) * AR.EXCHRATE               AS 'SALES VALUE IN COMPANY CURRENCY',
                       ARGL.CURRENCYID                                                                                                                                               AS 'SALES COMPANY CURRENCY',
                       Sum(COALESCE(MATCH_NET_WEIGHT, SBL.NET_WEIGHT, 0)) * (SELECT TOP 1 PERONINVVAL
                                                                             FROM   ARDETAILS AD
                                                                             WHERE  AD.ARID = AR.ARID
                                                                                    AND PERONINVVAL IS NOT NULL) / 100 * (SELECT TOP 1 UPRICE
                                                                                                                          FROM   ARDETAILS AD
                                                                                                                          WHERE  AD.ARID = AR.ARID
                                                                                                                                 AND UPRICE IS NOT NULL)                             AS 'SALES VALUE',
                       AR.CURRENCYID                                                                                                                                                 AS 'INVOICE CURRENCY',
                       (SELECT TOP 1 UPRICE
                        FROM   ARDETAILS AD
                        WHERE  AD.ARID = AR.ARID
                               AND UPRICE IS NOT NULL)                                                                                                                               AS 'SALES UNIT PRICE',
                       (SELECT TOP 1 SHORTNAME
                        FROM   ARDETAILS AD
                               JOIN JCIVUOM JU
                                 ON JU.UOMID = AD.UOMID
                        WHERE  AD.ARID = AR.ARID
                               AND UPRICE IS NOT NULL)                                                                                                                               AS 'SALES UOM',
                       (SELECT TOP 1 EXCHRATE
                        FROM   ARDETAILS AD
                        WHERE  AD.ARID = AR.ARID
                               AND UPRICE IS NOT NULL)                                                                                                                               AS 'SALES FX RATE',
                       CASE
                         WHEN AR.ARID IS NOT NULL THEN (SELECT Sum(NET_WEIGHT)
                                                        FROM   DISCHARGE
                                                        WHERE  LOAD_ID = CCL.ID)
                         ELSE NULL
                       END                                                                                                                                                           AS 'SALES DISCHARGE QUANTITY',
                       CASE
                         WHEN AR.ARID IS NULL THEN 0
                         WHEN ARC.PRICEBASISID > 0 THEN COALESCE((SELECT Sum(PRICEDQTY)
                                                                  FROM   CTRINVPRICINGCENTERMATCH
                                                                  WHERE  ARID = AR.ARID
                                                                         AND LOADID = SBL.ID
                                                                         AND ISPROVPRICESETTLED = 1), 0)
                         ELSE 0
                       END                                                                                                                                                           AS 'SALES PROVISIONAL QTY',
                       CASE
                         WHEN AR.ARID IS NULL THEN 0
                         WHEN ARC.PRICEBASISID > 0 THEN COALESCE((SELECT Sum(PRICEDQTY)
                                                                  FROM   CTRINVPRICINGCENTERMATCH
                                                                  WHERE  ARID = AR.ARID
                                                                         AND LOADID = SBL.ID
                                                                         AND ISPRICEFIX = 1), 0)
                         ELSE COALESCE(CASE
                                         WHEN ARC.ISGROSSWEIGHT = 1 THEN SBL.GROSS_WEIGHT
                                         ELSE SBL.NET_WEIGHT
                                       END, 0)
                       END                                                                                                                                                           AS 'SALES FIXED QTY',
                       CASE
                         WHEN AR.ARID IS NULL THEN 0
                         WHEN ARC.PRICEBASISID > 0 THEN COALESCE(CASE
                                                                   WHEN ARC.ISGROSSWEIGHT = 1 THEN SBL.GROSS_WEIGHT
                                                                   ELSE GL.NET_WEIGHT
                                                                 END, 0) - COALESCE((SELECT Sum(PRICEDQTY)
                                                                                     FROM   CTRINVPRICINGCENTERMATCH
                                                                                     WHERE  LOADID = SBL.ID
                                                                                            AND ISPRICEFIX = 1
                                                                                            AND ARID <= AR.ARID), 0)
                         ELSE 0
                       END                                                                                                                                                           AS 'SALES BALANCE TO FIX',
                       CASE
                         WHEN ARC.PRICEBASISID > 0 THEN COALESCE((SELECT Sum(PRICEDQTY * TOTALPRICE) / Sum(PRICEDQTY)
                                                                  FROM   CTRINVPRICINGCENTERMATCH
                                                                  WHERE  ARID = AR.ARID
                                                                         AND LOADID = SBL.ID
                                                                         AND ISPRICEFIX = 1), 0) * (SELECT TOP 1 EXCHRATE
                                                                                                    FROM   ARDETAILS AD
                                                                                                    WHERE  AD.ARID = AR.ARID
                                                                                                           AND UPRICE IS NOT NULL)
                         ELSE (SELECT TOP 1 UPRICE
                               FROM   ARDETAILS AD
                               WHERE  AD.ARID = AR.ARID
                                      AND UPRICE IS NOT NULL)
                       END                                                                                                                                                           AS 'SALES FIXED PRICE',
                       CASE
                         WHEN AR.ARID IS NOT NULL THEN Replace(Replace(Replace(Ltrim(Rtrim(CCL.TRANSPORT + ' / ' + SMO.TRIPNO)), Char(10), ''), Char(13), ''), Char(09), '')
                         ELSE NULL
                       END                                                                                                                                                           AS 'SALES TRANSPORT / TRIP NO',
                       CASE
                         WHEN ARO.ARBATCHID IS NOT NULL
                              AND APO.APBATCHID IS NOT NULL THEN Sum(GL.NET_WEIGHT)
                         ELSE NULL
                       END                                                                                                                                                           AS 'REALIZED QTY',
                       CASE
                         WHEN AR.ARID IS NULL THEN NULL
                         WHEN ARO.ARBATCHID IS NOT NULL THEN ABH.POSTDATE
                         ELSE NULL
                       END                                                                                                                                                           AS 'INVOICE POST DATE',
                       CASE
                         WHEN AR.ARID IS NULL THEN 'N/A'
                         WHEN ARO.ARBATCHID IS NOT NULL THEN 'POSTED'
                         ELSE 'UNPOSTED'
                       END                                                                                                                                                           AS 'INVOICE STATUS',
                       CASE
                         WHEN APO.APBATCHID IS NOT NULL THEN 'POSTED'
                         ELSE 'UNPOSTED'
                       END                                                                                                                                                           AS 'VOUCHER STATUS',
                       CASE
                         WHEN ARO.ARBATCHID IS NOT NULL
                              AND APO.APBATCHID IS NOT NULL THEN 'REALIZED'
                         ELSE 'STOCK'
                       END                                                                                                                                                           AS 'REPORT STATUS',
                       'N/A'                                                                                                                                                         AS 'LINKAGE VOUCHER/INVOICE',
                       'N/A'                                                                                                                                                         AS 'LINKAGE STATUS',
                       Cast(PC.PCID AS NVARCHAR(5))                                                                                                                                  AS purchase_pcid,
                       Cast(SPC.PCID AS NVARCHAR(5))                                                                                                                                 AS sales_pcid,
                       GLC.GLBOOKNAME                                                                                                                                                AS purchase_company,
                       AH.EXCHRATE                                                                                                                                                   AS 'PURCHASE FX RATE TO COMPANY CURR',
                       AR.EXCHRATE                                                                                                                                                   AS 'SALES FX RATE TO COMPANY CURR'
       FROM   CTR C
              LEFT JOIN JCPROFITCENTER PC
                     ON PC.PCID = C.PCID
              LEFT JOIN CTRBOOK B
                     ON ( C.CTRBOOKID = B.CTRBOOKID )
              LEFT JOIN GLCOMPANY GLC
                     ON ( B.MBRCOMPANY = GLC.COMPANYID )
              LEFT JOIN APHEADER AH
                     ON C.CTRID = AH.CTRID
                        AND AH.DOCTYPEID = 1
              LEFT JOIN APBATCH APB
                     ON APB.APBATCHID = AH.APBATCHID
              LEFT JOIN JCMBR PCP
                     ON PCP.MBRID = AH.PAYTOID
              LEFT JOIN JCCOUNTERPARTYCATEGORY PCC
                     ON PCC.CPCATEID = PCP.CPCATEID
              LEFT JOIN JCCOUNTRY PCPC
                     ON PCP.MBRCOUNTRYID = PCPC.COUNTRYID
              LEFT JOIN XSAPDOCTYPE DT
                     ON AH.DOCTYPEID = DT.DOCTYPEID
              LEFT JOIN XSAPDOCCAUSE AC
                     ON AC.DOCCAUSEID = AH.DOCCAUSEID
              LEFT JOIN (SELECT BLID,
                                APID
                         FROM   CTROPSBLAPLINK
                         UNION
                         SELECT BLID,
                                APID
                         FROM   CTROPSBLINITIALAPLINK
                         UNION
                         SELECT BLID,
                                APID
                         FROM   CTROPSBLFINALAPLINK) BL
                     ON BL.APID = AH.APID
              JOIN LOAD L
                ON L.ID = BL.BLID
              LEFT JOIN LOAD_LOCAL PLL
                     ON PLL.LOAD_ID = L.ID
              LEFT JOIN MOVEMENT_OPERATION PMO
                     ON PMO.ID = PLL.MOVEMENT_OPERATION_ID
              LEFT JOIN LOAD CL
                     ON CL.TOP_PARENT_LOAD_ID = L.ID
              LEFT JOIN LOAD_LOCAL LL
                     ON LL.LOAD_MATCHING_ID = CL.ID
                         OR LL.LOAD_MATCHING_ID = L.ID
              LEFT JOIN LOAD CCL
                     ON CCL.ID = LL.LOAD_ID
              LEFT JOIN MOVEMENT_OPERATION SMO
                     ON SMO.ID = LL.MOVEMENT_OPERATION_ID
              LEFT JOIN ALLOCATION ACL
                     ON ACL.ID = CCL.ALLOCATION_ID
              LEFT JOIN LOAD LB
                     ON LB.ID = LL.LOAD_ID
              LEFT JOIN ALLOCATION AL
                     ON L.ALLOCATION_ID = AL.ID
              LEFT JOIN LOAD_GLOBAL LG
                     ON LG.LOCAL_LOAD_ID = LL.LOAD_ID
              LEFT JOIN LOAD GL
                     ON LG.LOAD_ID = GL.ID
              LEFT JOIN (SELECT AR.*,
                                A.BLID,
                                A.PURCHASEBLID,
                                match_net_weight
                         FROM   ARHEADER AR
                                LEFT JOIN (SELECT BLID,
                                                  ARID,
                                                  NULL AS purchaseblid,
                                                  NULL AS match_net_weight
                                           FROM   CTROPSBLARLINK
                                           UNION
                                           SELECT BLID,
                                                  ARID,
                                                  NULL AS purchaseblid,
                                                  NULL AS match_net_weight
                                           FROM   CTROPSBLINITIALARLINK
                                           UNION
                                           SELECT BLID,
                                                  ARID,
                                                  NULL AS purchaseblid,
                                                  NULL AS match_net_weight
                                           FROM   CTROPSBLFINALARLINK
                                           UNION
                                           SELECT SALESLOADID      AS blid,
                                                  ARID,
                                                  PURCHASELOADID   AS purchaseblid,
                                                  (SELECT Sum(netweight)
                                                   FROM   INVOICELOADMATCHTOPURCHASE
                                                   WHERE  arid = imp.arid and salesloadid = imp.salesloadid and apid = imp.apid
                                                   GROUP  BY arid, salesloadid, apid) AS match_net_weight
                                           FROM   INVOICELOADMATCHTOPURCHASE IMP) A
                                       ON A.ARID = AR.ARID) AR
                     ON ( AR.BLID = LG.LOAD_ID
                           OR AR.PURCHASEBLID = CCL.ID )
                        AND AR.DOCTYPEID = 1
                        AND AR.APPLYDATE <= $P{dateto}
              LEFT JOIN LOAD SBL
                     ON SBL.ID = AR.BLID
              LEFT JOIN CTR ARC
                     ON ARC.CTRID = AR.CTRID
              LEFT JOIN JCMBR SMBR
                     ON SMBR.MBRID = ARC.BYRID
              LEFT JOIN CTRBOOK SCB
                     ON SCB.CTRBOOKID = ARC.CTRBOOKID
              LEFT JOIN JCPROFITCENTER SPC
                     ON SPC.PCID = ARC.PCID
              LEFT JOIN JCSPECS JSP
                     ON JSP.SPECID = ARC.SPECID
              LEFT JOIN JC_USER TRAD
                     ON TRAD.ID = ARC.TRADERID
              LEFT JOIN GLCOMPANY ARGL
                     ON ( ARGL.COMPANYID = SCB.MBRCOMPANY )
              LEFT JOIN XSARDOCTYPE ARDT
                     ON ARDT.DOCTYPEID = AR.DOCTYPEID
              LEFT JOIN XSARDOCCAUSE DCS
                     ON DCS.DOCCAUSEID = AR.DOCCAUSEID
              LEFT JOIN ARPOSTED ARO
                     ON AR.ARBATCHID = ARO.ARBATCHID
              LEFT JOIN ARBATCH ABH
                     ON ABH.ARBATCHID = AR.ARBATCHID
              LEFT JOIN APPOSTED APO
                     ON AH.APBATCHID = APO.APBATCHID
              LEFT JOIN JCMBR SCP
                     ON SCP.MBRID = AR.BILLTOID
              LEFT JOIN JCCOUNTERPARTYCATEGORY SCC
                     ON SCC.CPCATEID = SCP.CPCATEID
              LEFT JOIN JCCOUNTRY SCPC
                     ON SCP.MBRCOUNTRYID = SCPC.COUNTRYID
       WHERE  AL.DISCRIMINATOR_TYPE = 'HALF_ALLOCATION'
              AND COALESCE(AR.APPLYDATE, AH.APPLYDATE) >= $P{datefrom}
              AND COALESCE(AR.APPLYDATE, AH.APPLYDATE) <= $P{dateto}
       $P!{QSTR_Filter}
       GROUP  BY ACL.DISCRIMINATOR_TYPE,
                 ACL.REFERENCE,
                 AH.APID,
                 AH.APPLYDATE,
                 AH.APREF,
                 AH.CURRENCYID,
                 AH.EXCHRATE,
                 AL.DISCRIMINATOR_TYPE,
                 AL.REFERENCE,
                 APO.APBATCHID,
                 AR.APPLYDATE,
                 AR.ARID,
                 AR.ARREF,
                 AR.CURRENCYID,
                 AR.EXCHRATE,
                 ARC.COMMODITYID,
                 ARC.CTRREF,
                 ARC.ISGROSSWEIGHT,
                 ARC.PRICEBASISID,
                 ARDT.LONGNAME,
                 ARGL.CURRENCYID,
                 ARO.ARBATCHID,
                 B.CTRBOOKNAME,
                 C.COMMODITYID,
                 C.CTRREF,
                 C.ISGROSSWEIGHT,
                 C.PRICEBASISID,
                 DT.LONGNAME,
                 GL.GROSS_WEIGHT,
                 GL.ID,
                 GL.NET_WEIGHT,
                 GLC.CURRENCYID,
                 L.GROSS_WEIGHT,
                 L.ID,
                 L.NET_WEIGHT,
                 PC.PCNAME,
                 PCP.MBRNAME,
                 PCC.NAME,
                 SCB.CTRBOOKNAME,
                 SCP.MBRNAME,
                 SPC.PCNAME,
                 AC.DOCCAUSE,
                 DCS.DOCCAUSE,
                 CCL.REFERENCE_BLNO,
                 L.REFERENCE_BLNO,
                 PCPC.COUNTRYNAME,
                 SCPC.COUNTRYNAME,
                 ARGL.GLBOOKNAME,
                 JSP.SPECNAME,
                 JSP.SPECDESC,
                 ABH.POSTDATE,
                 TRAD.FIRST_NAME,
                 TRAD.LAST_NAME,
                 ARC.CTRBASISID,
                 AR.SRCDOCREF,
                 CCL.LOAD_DATE,
                 AR.DOCDATE,
                 AR.DUEDATE,
                 AH.DOCDATE,
                 AH.DUEDATE,
                 L.TRANSPORT,
                 PMO.TRIPNO,
                 CCL.TRANSPORT,
                 SMO.TRIPNO,
                 SMBR.MBRNAME,
                 SCP.ISINTERCO,
                 SCC.NAME,
                 CCL.ID,
                 APB.POSTDATE,
                 SBL.ID,
                 SBL.NET_WEIGHT,
                 SBL.GROSS_WEIGHT,
                 match_net_weight,
                 Cast(PC.PCID AS NVARCHAR(5)),
                 Cast(SPC.PCID AS NVARCHAR(5)),
                 GLC.GLBOOKNAME,
                 CCL.STATUS
       UNION ALL
       /*PURCHASE CN/DN*/
       SELECT DISTINCT C.CTRREF                                                                                                            AS 'PURCHASE CTR. REF#',
                       PC.PCNAME                                                                                                           AS 'PURCHASE PROFIT CENTER',
                       CB.CTRBOOKNAME                                                                                                      AS 'PURCHASE CONTRACT BOOK',
                       CONVERT(NVARCHAR(100), L.REFERENCE_BLNO)                                                                            AS 'PURCHASE BL NO',
                       AP.APREF                                                                                                            AS 'PURCHASE VOUCHER',
                       CASE
                         WHEN APD.APBATCHID IS NOT NULL THEN APB.POSTDATE
                         ELSE NULL
                       END                                                                                                                 AS 'VOUCHER POST DATE',
                       AP.DOCDATE                                                                                                          AS 'VOUCHER DOC DATE',
                       AP.DUEDATE                                                                                                          AS 'VOUCHER DUE DATE',
                       AP.APPLYDATE                                                                                                        AS 'VOUCHER APPLY DATE',
                       C.COMMODITYID                                                                                                       AS 'PURCHASE COMMODITY',
                       PCP.MBRNAME                                                                                                         AS 'PURCHASE COUNTERPARTY',
                       PCC.NAME                                                                                                            AS 'PURCHASE COUNTERPARTY CATEGORY',
                       PCPC.COUNTRYNAME                                                                                                    AS 'SUPPLIER COUNTRY',
                       COALESCE(AL.DISCRIMINATOR_TYPE, SA.DISCRIMINATOR_TYPE)                                                              AS 'ALOCATION TYPE',
                       COALESCE(AL.REFERENCE, SA.REFERENCE)                                                                                AS 'ALLOCATION REF#',
                       DT.LONGNAME                                                                                                         AS 'PUR. DOC. TYPE',
                       AC.DOCCAUSE                                                                                                         AS 'PUR. DOC. CAUSE',
                       CASE
                         WHEN AP.DOCCAUSEID = 3
                               OR AP.DOCCAUSEID = 5
                               OR AP.DOCCAUSEID = 6
                               OR AP.DOCCAUSEID = 8 THEN 0
                         ELSE AD.QTY
                       END                                                                                                                 AS 'QUANTITY',
                       CASE
                         WHEN AP.DOCCAUSEID = 8 THEN
                           CASE
                             WHEN APD.APBATCHID IS NOT NULL
                                  AND ( PSAR.ARBATCHID IS NOT NULL
                                         OR AHH.ARBATCHID IS NOT NULL ) THEN Abs(COALESCE(COALESCE(( CASE
                                                                                                       WHEN C.ISGROSSWEIGHT = 1 THEN GL.GROSS_WEIGHT
                                                                                                       ELSE GL.NET_WEIGHT
                                                                                                     END ), IMP.NETWEIGHT) * (SELECT TOP 1 UPRICE
                                                                                                                              FROM   APDETAILS
                                                                                                                              WHERE  ITEMAMT IS NOT NULL
                                                                                                                                     AND APID = AP.APID
                                                                                                                                     AND QTY IS NOT NULL), AD.AMOUNT)) * DT.POLARITY
                             ELSE Abs(AD.AMOUNT) * DT.POLARITY
                           END
                         ELSE ( CASE
                                  WHEN AP.DOCCAUSEID = 3 THEN (SELECT DET.ITEMAMT
                                                               FROM   APHEADER AH
                                                                      JOIN (SELECT DISTINCT LOADID,
                                                                                            APID,
                                                                                            ITEMAMT
                                                                            FROM   APDETAILS) DET
                                                                        ON AH.APID = DET.APID
                                                               WHERE  AH.DOCTYPEID = 1
                                                                      AND DOCCAUSEID IN ( 2, 8 )
                                                                      AND DET.LOADID = AD.LOADID) * -1
                                  ELSE 0
                                END
                                + AD.AMOUNT )
                       END                                                                                                                 AS 'ORIGINAL PURCHASE VALUE',
                       CASE
                         WHEN AP.DOCCAUSEID = 8 THEN
                           CASE
                             WHEN APD.APBATCHID IS NOT NULL
                                  AND ( PSAR.ARBATCHID IS NOT NULL
                                         OR AHH.ARBATCHID IS NOT NULL ) THEN Abs(COALESCE(COALESCE(( CASE
                                                                                                       WHEN C.ISGROSSWEIGHT = 1 THEN GL.GROSS_WEIGHT
                                                                                                       ELSE GL.NET_WEIGHT
                                                                                                     END ), IMP.NETWEIGHT) * (SELECT TOP 1 UPRICE
                                                                                                                              FROM   APDETAILS
                                                                                                                              WHERE  ITEMAMT IS NOT NULL
                                                                                                                                     AND APID = AP.APID
                                                                                                                                     AND QTY IS NOT NULL), AD.AMOUNT)) * DT.POLARITY
                             ELSE Abs(AD.AMOUNT) * DT.POLARITY
                           END
                         ELSE ( CASE
                                  WHEN AP.DOCCAUSEID = 3 THEN (SELECT DET.ITEMAMT
                                                               FROM   APHEADER AH
                                                                      JOIN (SELECT DISTINCT LOADID,
                                                                                            APID,
                                                                                            ITEMAMT
                                                                            FROM   APDETAILS) DET
                                                                        ON AH.APID = DET.APID
                                                               WHERE  AH.DOCTYPEID = 1
                                                                      AND DOCCAUSEID IN ( 2, 8 )
                                                                      AND DET.LOADID = AD.LOADID) * -1
                                  ELSE 0
                                END
                                + AD.AMOUNT )
                       END * AP.EXCHRATE                                                                                                   AS 'ORIGINAL PURCHASE VALUE IN COMPANY CURR',
                       CASE
                         WHEN AP.DOCCAUSEID = 8 THEN
                           CASE
                             WHEN IMP.NETWEIGHT IS NULL THEN PRIM_L.NET_WEIGHT - (SELECT COALESCE(Sum(NET_WEIGHT), 0)
                                                                                  FROM   DISCHARGE
                                                                                  WHERE  LOAD_ID = PRIM_L.ID
                                                                                         AND STATUS = 'UNLOADED')
                             ELSE IMP.NETWEIGHT - ( IMP.NETWEIGHT * (SELECT COALESCE(Sum(NET_WEIGHT), 0)
                                                                     FROM   DISCHARGE
                                                                     WHERE  LOAD_ID = PRIM_L.ID
                                                                            AND STATUS = 'UNLOADED') / PRIM_L.NET_WEIGHT )
                           END
                         ELSE 0
                       END                                                                                                                 AS 'STOCK ADJUSTED QTY',
                       CASE
                         WHEN AP.DOCCAUSEID = 8 THEN CASE
                                                       WHEN IMP.NETWEIGHT IS NULL THEN PRIM_L.NET_WEIGHT - (SELECT COALESCE(Sum(NET_WEIGHT), 0)
                                                                                                            FROM   DISCHARGE
                                                                                                            WHERE  LOAD_ID = PRIM_L.ID
                                                                                                                   AND STATUS = 'UNLOADED')
                                                       ELSE IMP.NETWEIGHT - ( IMP.NETWEIGHT * (SELECT COALESCE(Sum(NET_WEIGHT), 0)
                                                                                               FROM   DISCHARGE
                                                                                               WHERE  LOAD_ID = PRIM_L.ID
                                                                                                      AND STATUS = 'UNLOADED') / PRIM_L.NET_WEIGHT )
                                                     END * (SELECT TOP 1 UPRICE
                                                            FROM   APDETAILS
                                                            WHERE  ITEMAMT IS NOT NULL
                                                                   AND APID = AP.APID
                                                                   AND QTY IS NOT NULL)
                         ELSE 0
                       END                                                                                                                 AS 'STOCK ADJUSTMENT VALUE',
                       CASE
                         WHEN AP.DOCCAUSEID = 8 THEN CASE
                                                       WHEN IMP.NETWEIGHT IS NULL THEN PRIM_L.NET_WEIGHT - (SELECT COALESCE(Sum(NET_WEIGHT), 0)
                                                                                                            FROM   DISCHARGE
                                                                                                            WHERE  LOAD_ID = PRIM_L.ID
                                                                                                                   AND STATUS = 'UNLOADED')
                                                       ELSE IMP.NETWEIGHT - ( IMP.NETWEIGHT * (SELECT COALESCE(Sum(NET_WEIGHT), 0)
                                                                                               FROM   DISCHARGE
                                                                                               WHERE  LOAD_ID = PRIM_L.ID
                                                                                                      AND STATUS = 'UNLOADED') / PRIM_L.NET_WEIGHT )
                                                     END * (SELECT TOP 1 UPRICE
                                                            FROM   APDETAILS
                                                            WHERE  ITEMAMT IS NOT NULL
                                                                   AND APID = AP.APID
                                                                   AND QTY IS NOT NULL) * AP.EXCHRATE
                         ELSE 0
                       END                                                                                                                 AS 'STOCK ADJUSTMENT VALUE IN COMPANY CURR',
                       CASE
                         WHEN AP.DOCCAUSEID = 8 THEN
                           CASE
                             WHEN APD.APBATCHID IS NOT NULL
                                  AND ( PSAR.ARBATCHID IS NOT NULL
                                         OR AHH.ARBATCHID IS NOT NULL ) THEN Abs(COALESCE(COALESCE(( CASE
                                                                                                       WHEN C.ISGROSSWEIGHT = 1 THEN GL.GROSS_WEIGHT
                                                                                                       ELSE GL.NET_WEIGHT
                                                                                                     END ), PRIM_L.NET_WEIGHT / (SELECT COALESCE(Sum(NET_WEIGHT), 0)
                                                                                                                                 FROM   DISCHARGE
                                                                                                                                 WHERE  LOAD_ID = PRIM_L.ID
                                                                                                                                        AND STATUS = 'UNLOADED') * IMP.NETWEIGHT) * (SELECT TOP 1 UPRICE
                                                                                                                              FROM   APDETAILS
                                                                                                                              WHERE  ITEMAMT IS NOT NULL
                                                                                                                                     AND APID = AP.APID
                                                                                                                                     AND QTY IS NOT NULL), AD.AMOUNT)) * DT.POLARITY
                             ELSE Abs(AD.AMOUNT) * DT.POLARITY
                           END
                         ELSE ( CASE
                                  WHEN AP.DOCCAUSEID = 3 THEN (SELECT DET.ITEMAMT
                                                               FROM   APHEADER AH
                                                                      JOIN (SELECT DISTINCT LOADID,
                                                                                            APID,
                                                                                            ITEMAMT
                                                                            FROM   APDETAILS) DET
                                                                        ON AH.APID = DET.APID
                                                               WHERE  AH.DOCTYPEID = 1
                                                                      AND DOCCAUSEID IN ( 2, 8 )
                                                                      AND DET.LOADID = AD.LOADID) * -1
                                  ELSE 0
                                END
                                + AD.AMOUNT )
                       END * AP.EXCHRATE                                                                                                   AS 'PURCHASE VALUE IN COMPANY CURR',
                       GLC.CURRENCYID                                                                                                      AS 'PURCHASE COMPANY CURRENCY',
                       CASE
                         WHEN AP.DOCCAUSEID = 8 THEN
                           CASE
                             WHEN APD.APBATCHID IS NOT NULL
                                  AND ( PSAR.ARBATCHID IS NOT NULL
                                         OR AHH.ARBATCHID IS NOT NULL ) THEN Abs(COALESCE(COALESCE(( CASE
                                                                                                       WHEN C.ISGROSSWEIGHT = 1 THEN GL.GROSS_WEIGHT
                                                                                                       ELSE GL.NET_WEIGHT
                                                                                                     END ), PRIM_L.NET_WEIGHT / (SELECT COALESCE(Sum(NET_WEIGHT), 0)
                                                                                                                                 FROM   DISCHARGE
                                                                                                                                 WHERE  LOAD_ID = PRIM_L.ID
                                                                                                                                        AND STATUS = 'UNLOADED') * IMP.NETWEIGHT) * (SELECT TOP 1 UPRICE
                                                                                                                              FROM   APDETAILS
                                                                                                                              WHERE  ITEMAMT IS NOT NULL
                                                                                                                                     AND APID = AP.APID
                                                                                                                                     AND QTY IS NOT NULL), AD.AMOUNT)) * DT.POLARITY
                             ELSE Abs(AD.AMOUNT) * DT.POLARITY
                           END
                         ELSE ( CASE
                                  WHEN AP.DOCCAUSEID = 3 THEN (SELECT DET.ITEMAMT
                                                               FROM   APHEADER AH
                                                                      JOIN (SELECT DISTINCT LOADID,
                                                                                            APID,
                                                                                            ITEMAMT
                                                                            FROM   APDETAILS) DET
                                                                        ON AH.APID = DET.APID
                                                               WHERE  AH.DOCTYPEID = 1
                                                                      AND DOCCAUSEID IN ( 2, 8 )
                                                                      AND DET.LOADID = AD.LOADID) * -1
                                  ELSE 0
                                END ) + AD.AMOUNT
                       END                                                                                                                 AS 'PURCHASE VALUE',
                       AP.CURRENCYID                                                                                                       AS 'VOUCHER CURRENCY',
                       CASE
                         WHEN ap.doccauseid = 13 THEN (SELECT Sum(CASE
                                                                    WHEN QTY < 0 THEN -1 * UPRICE
                                                                    ELSE UPRICE
                                                                  END)
                                                       FROM   APDETAILS
                                                       WHERE  APID = AP.APID
                                                              AND UPRICE IS NOT NULL
                                                              AND LOADID = L.ID)
                         WHEN ap.doccauseid = 8 THEN (SELECT TOP 1 UPRICE
                                                      FROM   APDETAILS
                                                      WHERE  APID = AP.APID
                                                             AND UPRICE IS NOT NULL
                                                             AND QTY IS NOT NULL)
                         ELSE (SELECT TOP 1 UPRICE
                               FROM   APDETAILS
                               WHERE  APID = AP.APID
                                      AND UPRICE IS NOT NULL
                                      AND loadid = l.id)
                       END                                                                                                                 AS 'PURCHASE UNIT PRICE',
                       CASE
                         WHEN ap.doccauseid = 13 THEN (SELECT Sum(CASE
                                                                    WHEN QTY < 0 THEN -1 * UPRICE
                                                                    ELSE UPRICE
                                                                  END)
                                                       FROM   APDETAILS
                                                       WHERE  APID = AP.APID
                                                              AND UPRICE IS NOT NULL
                                                              AND LOADID = L.ID)
                         WHEN ap.doccauseid = 8 THEN (SELECT TOP 1 UPRICE
                                                      FROM   APDETAILS
                                                      WHERE  APID = AP.APID
                                                             AND UPRICE IS NOT NULL
                                                             AND QTY IS NOT NULL)
                         ELSE (SELECT TOP 1 UPRICE
                               FROM   APDETAILS
                               WHERE  APID = AP.APID
                                      AND UPRICE IS NOT NULL
                                      AND loadid = l.id)
                       END                                                                                                                 AS 'PURCHASE ORIGINAL UNIT PRICE',
                       (SELECT TOP 1 EXCHRATE
                        FROM   APDETAILS
                        WHERE  ITEMAMT IS NOT NULL
                               AND APID = AP.APID
                               AND QTY IS NOT NULL)                                                                                        AS 'PURCHASE FX RATE',
                       (SELECT COALESCE(Sum(NET_WEIGHT), 0)
                        FROM   DISCHARGE
                        WHERE  LOAD_ID = L.ID
                               AND STATUS = 'UNLOADED')                                                                                    AS 'PURCHASE DISCHARGE QUANTITY',
                       CASE
                         WHEN AP.DOCCAUSEID = 13 THEN AD.QTY * -1
                         ELSE 0
                       END                                                                                                                 AS 'PURCHASE PROVISIONAL QTY',
                       CASE
                         WHEN AP.DOCCAUSEID = 5
                               OR AP.DOCCAUSEID = 6
                               OR AP.DOCCAUSEID = 8
                               OR AP.DOCCAUSEID = 3 THEN 0
                         ELSE AD.QTY
                       END                                                                                                                 AS 'PURCHASE FIXED QTY',
                       CASE
                         WHEN AP.DOCCAUSEID = 13 THEN COALESCE(CASE
                                                                 WHEN C.ISGROSSWEIGHT = 1 THEN L.GROSS_WEIGHT
                                                                 ELSE L.NET_WEIGHT
                                                               END, 0) - COALESCE((SELECT Sum(PRICEDQTY)
                                                                                   FROM   CTRVCHPRICINGCENTERMATCH
                                                                                   WHERE  LOADID = L.ID
                                                                                          AND ISPRICEFIX = 1
                                                                                          AND APID <= AP.APID), 0)
                         ELSE 0
                       END                                                                                                                 AS 'PURCHASE BALANCE TO FIX',
                       CASE
                         WHEN AP.DOCCAUSEID = 3
                              AND C.PRICEBASISID > 0 THEN COALESCE((SELECT Sum(PRICEDQTY * TOTALPRICE) / Sum(PRICEDQTY)
                                                                    FROM   CTRVCHPRICINGCENTERMATCH
                                                                    WHERE  APID = AP.APID
                                                                           AND LOADID = L.ID
                                                                           AND ISPRICEFIX = 1), 0) * (SELECT TOP 1 EXCHRATE
                                                                                                      FROM   APDETAILS
                                                                                                      WHERE  ITEMAMT IS NOT NULL
                                                                                                             AND APID = AP.APID
                                                                                                             AND LOADID = L.ID)
                         WHEN AP.DOCCAUSEID = 3 THEN (SELECT TOP 1 UPRICE
                                                      FROM   APDETAILS
                                                      WHERE  ITEMAMT IS NOT NULL
                                                             AND APID = AP.APID
                                                             AND LOADID = L.ID)
                         ELSE 0
                       END                                                                                                                 AS 'PURCHASE FIXED PRICE',
                       Replace(Replace(Replace(Ltrim(Rtrim(L.TRANSPORT + ' / ' + PMO.TRIPNO)), Char(10), ''), Char(13), ''), Char(09), '') AS 'PURCHASE TRANSPORT / TRIP NO',
                       CASE
                         WHEN APD.APBATCHID IS NOT NULL
                              AND ( PSAR.ARBATCHID IS NOT NULL
                                     OR AHH.ARBATCHID IS NOT NULL ) THEN COALESCE(CAH.CTRREF, CSAR.CTRREF)
                         ELSE 'N/A'
                       END                                                                                                                 AS 'SALES CTR. REF#',
                       CASE
                         WHEN APD.APBATCHID IS NOT NULL
                              AND ( PSAR.ARBATCHID IS NOT NULL
                                     OR AHH.ARBATCHID IS NOT NULL ) THEN COALESCE(GLAH.GLBOOKNAME, GLSAR.GLBOOKNAME)
                         ELSE 'N/A'
                       END                                                                                                                 AS 'SALES COMPANY',
                       CASE
                         WHEN APD.APBATCHID IS NOT NULL
                              AND ( PSAR.ARBATCHID IS NOT NULL
                                     OR AHH.ARBATCHID IS NOT NULL ) THEN COALESCE(PCAH.PCNAME, PCSAR.PCNAME)
                         ELSE 'N/A'
                       END                                                                                                                 AS 'SALES PROFIT CENTER',
                       CASE
                         WHEN APD.APBATCHID IS NOT NULL
                              AND ( PSAR.ARBATCHID IS NOT NULL
                                     OR AHH.ARBATCHID IS NOT NULL ) THEN COALESCE(CBAH.CTRBOOKNAME, CBSAR.CTRBOOKNAME)
                         ELSE 'N/A'
                       END                                                                                                                 AS 'SALES CONTRACT BOOK',
                       CASE
                         WHEN APD.APBATCHID IS NOT NULL
                              AND ( PSAR.ARBATCHID IS NOT NULL
                                     OR AHH.ARBATCHID IS NOT NULL ) THEN COALESCE(CAH.CTRBASISID, CSAR.CTRBASISID)
                         ELSE 'N/A'
                       END                                                                                                                 AS 'SALES INCOTERM',
                       CASE
                         WHEN APD.APBATCHID IS NOT NULL
                              AND ( PSAR.ARBATCHID IS NOT NULL
                                     OR AHH.ARBATCHID IS NOT NULL ) THEN
                           CASE
                             WHEN AH.ARREF IS NOT NULL THEN (SELECT TOP 1 COSTCENTER
                                                             FROM   ARDETAILS
                                                             WHERE  ARID = AH.ARID
                                                                    AND LOADID = GL.ID)
                             ELSE (SELECT TOP 1 COSTCENTER
                                   FROM   ARDETAILS
                                   WHERE  ARID = AH.ARID
                                          AND LOADID = SAR.ARID)
                           END
                         ELSE 'N/A'
                       END                                                                                                                 AS 'SALES COST CENTER',
                       CASE
                         WHEN APD.APBATCHID IS NOT NULL
                              AND ( PSAR.ARBATCHID IS NOT NULL
                                     OR AHH.ARBATCHID IS NOT NULL ) THEN COALESCE(JSPCAH.SPECNAME, JSPCSAR.SPECNAME)
                         ELSE 'N/A'
                       END                                                                                                                 AS 'SALES GRADE',
                       CASE
                         WHEN APD.APBATCHID IS NOT NULL
                              AND ( PSAR.ARBATCHID IS NOT NULL
                                     OR AHH.ARBATCHID IS NOT NULL ) THEN COALESCE(JSPCAH.SPECDESC, JSPCSAR.SPECDESC)
                         ELSE 'N/A'
                       END                                                                                                                 AS 'SALES GRADE DESC',
                       CASE
                         WHEN APD.APBATCHID IS NOT NULL
                              AND ( PSAR.ARBATCHID IS NOT NULL
                                     OR AHH.ARBATCHID IS NOT NULL ) THEN COALESCE(TRAH.FIRST_NAME + ' ' + TRAH.LAST_NAME, TRSAR.FIRST_NAME + ' ' + TRSAR.LAST_NAME)
                         ELSE 'N/A'
                       END                                                                                                                 AS 'SALES TRADER NAME',
                       CASE
                         WHEN APD.APBATCHID IS NOT NULL
                              AND ( PSAR.ARBATCHID IS NOT NULL
                                     OR AHH.ARBATCHID IS NOT NULL ) THEN CONVERT(NVARCHAR(100), GL.REFERENCE_BLNO)
                         ELSE 'N/A'
                       END                                                                                                                 AS 'SALES BL NO',
                       CASE
                         WHEN APD.APBATCHID IS NOT NULL
                              AND ( PSAR.ARBATCHID IS NOT NULL
                                     OR AHH.ARBATCHID IS NOT NULL ) THEN GL.LOAD_DATE
                         ELSE NULL
                       END                                                                                                                 AS 'SALES LOAD DATE',
                       CASE
                         WHEN APD.APBATCHID IS NOT NULL
                              AND ( PSAR.ARBATCHID IS NOT NULL
                                     OR AHH.ARBATCHID IS NOT NULL ) THEN COALESCE(AH.ARREF, SAR.ARREF)
                         ELSE 'N/A'
                       END                                                                                                                 AS 'SALES INVOICE',
                       CASE
                         WHEN APD.APBATCHID IS NOT NULL
                              AND ( PSAR.ARBATCHID IS NOT NULL
                                     OR AHH.ARBATCHID IS NOT NULL ) THEN COALESCE(AH.SRCDOCREF, SAR.SRCDOCREF)
                         ELSE 'N/A'
                       END                                                                                                                 AS 'SALES EXTERNAL REFERENCE',
                       NULL                                                                                                                AS 'INVOICE DOC DATE',
                       NULL                                                                                                                AS 'INVOICE DUE DATE',
                       NULL                                                                                                                AS 'INVOICE APPLY DATE',
                       CASE
                         WHEN APD.APBATCHID IS NOT NULL
                              AND ( PSAR.ARBATCHID IS NOT NULL
                                     OR AHH.ARBATCHID IS NOT NULL ) THEN COALESCE(CAH.COMMODITYID, CSAR.COMMODITYID)
                         ELSE 'N/A'
                       END                                                                                                                 AS 'SALES COMMODITY',
                       CASE
                         WHEN APD.APBATCHID IS NOT NULL
                              AND ( PSAR.ARBATCHID IS NOT NULL
                                     OR AHH.ARBATCHID IS NOT NULL ) THEN COALESCE(SMBRAH.MBRNAME, SMBRSAR.MBRNAME)
                         ELSE 'N/A'
                       END                                                                                                                 AS 'SALES CONTRACTUAL COUNTERPARTY',
                       CASE
                         WHEN APD.APBATCHID IS NOT NULL
                              AND ( PSAR.ARBATCHID IS NOT NULL
                                     OR AHH.ARBATCHID IS NOT NULL ) THEN COALESCE(CPAH.MBRNAME, CPSAR.MBRNAME)
                         ELSE 'N/A'
                       END                                                                                                                 AS 'SALES COUNTERPARTY',
                       CASE
                         WHEN APD.APBATCHID IS NOT NULL
                              AND ( PSAR.ARBATCHID IS NOT NULL
                                     OR AHH.ARBATCHID IS NOT NULL ) THEN
                           CASE
                             WHEN COALESCE(CPAH.ISINTERCO, CPSAR.ISINTERCO) = 1 THEN 'INTERNAL'
                             ELSE 'EXTERNAL'
                           END
                         ELSE 'N/A'
                       END                                                                                                                 AS 'INTERNAL/EXTERNAL COUNTERPARTY',
                       CASE
                         WHEN APD.APBATCHID IS NOT NULL
                              AND ( PSAR.ARBATCHID IS NOT NULL
                                     OR AHH.ARBATCHID IS NOT NULL ) THEN COALESCE(SCCAH.NAME, SCCSAR.NAME)
                         ELSE 'N/A'
                       END                                                                                                                 AS 'SALES COUNTERPARTY CATEGORY',
                       CASE
                         WHEN APD.APBATCHID IS NOT NULL
                              AND ( PSAR.ARBATCHID IS NOT NULL
                                     OR AHH.ARBATCHID IS NOT NULL ) THEN COALESCE(CPAHC.COUNTRYNAME, CPSARC.COUNTRYNAME)
                         ELSE 'N/A'
                       END                                                                                                                 AS 'CUSTOMER COUNTRY',
                       CASE
                         WHEN APD.APBATCHID IS NOT NULL
                              AND ( PSAR.ARBATCHID IS NOT NULL
                                     OR AHH.ARBATCHID IS NOT NULL ) THEN COALESCE(DTAH.LONGNAME, DTSAR.LONGNAME)
                         ELSE 'N/A'
                       END                                                                                                                 AS 'SALES DOC. TYPE',
                       CASE
                         WHEN APD.APBATCHID IS NOT NULL
                              AND ( PSAR.ARBATCHID IS NOT NULL
                                     OR AHH.ARBATCHID IS NOT NULL ) THEN COALESCE(DCAH.DOCCAUSE, DCSAR.DOCCAUSE)
                         ELSE 'N/A'
                       END                                                                                                                 AS 'SALES DOC. CAUSE',
                       NULL                                                                                                                AS 'SALES VALUE IN COMPANY CURRENCY',
                       CASE
                         WHEN APD.APBATCHID IS NOT NULL
                              AND ( PSAR.ARBATCHID IS NOT NULL
                                     OR AHH.ARBATCHID IS NOT NULL ) THEN COALESCE(GLAH.CURRENCYID, GLSAR.CURRENCYID)
                         ELSE 'N/A'
                       END                                                                                                                 AS 'SALES COMPANY CURRENCY',
                       NULL                                                                                                                AS 'SALES VALUE',
                       CASE
                         WHEN APD.APBATCHID IS NOT NULL
                              AND ( PSAR.ARBATCHID IS NOT NULL
                                     OR AHH.ARBATCHID IS NOT NULL ) THEN COALESCE(AH.CURRENCYID, SAR.CURRENCYID)
                         ELSE 'N/A'
                       END                                                                                                                 AS 'INVOICE CURRENCY',
                       NULL                                                                                                                AS 'SALES UNIT PRICE',
                       NULL                                                                                                                AS 'SALES UOM',
                       NULL                                                                                                                AS 'SALES FX RATE',
                       NULL                                                                                                                AS 'SALES DISCHARGE QUANTITY',
                       NULL                                                                                                                AS 'SALES PROVISION QTY',
                       NULL                                                                                                                AS 'SALES FIXED QTY',
                       NULL                                                                                                                AS 'SALES BALANCE TO FIX',
                       NULL                                                                                                                AS 'SALES FIXED PRICE',
                       NULL                                                                                                                AS 'SALES TRANSPORT / TRIP NO',
                       NULL                                                                                                                AS 'REALIZED QTY',
                       CASE
                         WHEN APD.APBATCHID IS NOT NULL THEN
                           CASE
                             WHEN ( PSAR.ARBATCHID IS NOT NULL
                                     OR AHH.ARBATCHID IS NOT NULL ) THEN COALESCE(PBH.POSTDATE, ABH.POSTDATE)
                             ELSE NULL
                           END
                         ELSE NULL
                       END                                                                                                                 AS 'INVOICE POST DATE',
                       CASE
                         WHEN APD.APBATCHID IS NOT NULL THEN
                           CASE
                             WHEN ( PSAR.ARBATCHID IS NOT NULL
                                     OR AHH.ARBATCHID IS NOT NULL ) THEN 'POSTED'
                             ELSE 'UNPOSTED'
                           END
                         ELSE 'N/A'
                       END                                                                                                                 AS 'INVOICE STATUS',
                       CASE
                         WHEN APD.APBATCHID IS NOT NULL THEN 'POSTED'
                         ELSE 'UNPOSTED'
                       END                                                                                                                 AS 'VOUCHER STATUS',
                       CASE
                         WHEN APD.APBATCHID IS NULL THEN 'STOCK'
                         WHEN PSAR.ARBATCHID IS NULL
                              AND AHH.ARBATCHID IS NULL THEN 'STOCK'
                         ELSE 'REALIZED'
                       END                                                                                                                 AS 'REPORT STATUS',
                       PA.APREF                                                                                                            AS 'LINKAGE VOUCHER/INVOICE',
                       CASE
                         WHEN PA.APREF IS NOT NULL THEN 'PRIMARY'
                         ELSE 'NO LINKAGE'
                       END                                                                                                                 AS 'LINKAGE STATUS',
                       Cast(PC.PCID AS NVARCHAR(5))                                                                                        AS purchase_pcid,
                       CASE
                         WHEN APD.APBATCHID IS NOT NULL
                              AND ( PSAR.ARBATCHID IS NOT NULL
                                     OR AHH.ARBATCHID IS NOT NULL ) THEN Cast(COALESCE(PCAH.PCID, PCSAR.PCID) AS NVARCHAR(5))
                         ELSE 'N/A'
                       END                                                                                                                 AS sales_pcid,
                       GLC.GLBOOKNAME                                                                                                      AS purchase_company,
                       AH.EXCHRATE                                                                                                         AS 'PURCHASE FX RATE TO COMPANY CURR',
                       NULL                                                                                                                AS 'SALES FX RATE TO COMPANY CURR'
       FROM   CTR C
              LEFT JOIN CTRBOOK CB
                     ON CB.CTRBOOKID = C.CTRBOOKID
              LEFT JOIN JCPROFITCENTER PC
                     ON PC.PCID = C.PCID
              LEFT JOIN CONTRACT CT
                     ON C.CTRREF = CT.REFERENCE
              LEFT JOIN APHEADER AP
                     ON AP.CTRID = C.CTRID
              LEFT JOIN APBATCH APB
                     ON APB.APBATCHID = AP.APBATCHID
              LEFT JOIN JCMBR PCP
                     ON PCP.MBRID = AP.PAYTOID
              LEFT JOIN JCCOUNTERPARTYCATEGORY PCC
                     ON PCC.CPCATEID = PCP.CPCATEID
              LEFT JOIN JCCOUNTRY PCPC
                     ON PCP.MBRCOUNTRYID = PCPC.COUNTRYID
              LEFT JOIN (SELECT Sum(ITEMAMT) AS amount,
                                Sum(CASE
                                      WHEN QTY > 0 THEN QTY
                                      ELSE 0
                                    END)     AS qty,
                                LOADID,
                                APID
                         FROM   APDETAILS
                         WHERE  ITEMAMT IS NOT NULL
                         GROUP  BY LOADID,
                                   APID) AD
                     ON AD.APID = AP.APID
              LEFT JOIN LOAD L
                     ON L.ID = AD.LOADID
              LEFT JOIN LOAD_LOCAL PLL
                     ON PLL.LOAD_ID = L.ID
              LEFT JOIN MOVEMENT_OPERATION PMO
                     ON PMO.ID = PLL.MOVEMENT_OPERATION_ID
              LEFT JOIN (SELECT Sum(COALESCE(NET_WEIGHT, 0))   AS net_weight,
                                Sum(COALESCE(GROSS_WEIGHT, 0)) AS gross_weight,
                                LOAD_ID
                         FROM   DISCHARGE
                         GROUP  BY LOAD_ID) D
                     ON D.LOAD_ID = L.ID
              LEFT JOIN ALLOCATION AL
                     ON AL.ID = L.ALLOCATION_ID
              LEFT JOIN XSAPDOCTYPE DT
                     ON DT.DOCTYPEID = AP.DOCTYPEID
              LEFT JOIN XSAPDOCCAUSE AC
                     ON AC.DOCCAUSEID = AP.DOCCAUSEID
              LEFT JOIN APPOSTED APD
                     ON APD.APBATCHID = AP.APBATCHID
              JOIN CTRBOOK B
                ON ( C.CTRBOOKID = B.CTRBOOKID )
              JOIN GLCOMPANY GLC
                ON ( B.MBRCOMPANY = GLC.COMPANYID )
              LEFT JOIN STRINGAPLINK SL
                     ON SL.APID = AP.APID
              LEFT JOIN STR_MAIN SM
                     ON SM.ID = SL.STRMAINID
              LEFT JOIN ALLOCATION SA
                     ON SA.ID = SM.MAIN_ALLOCATION
              LEFT JOIN (SELECT DISTINCT ADS.LOADID,
                                         BL.APID AS primary_apid,
                                         ADS.APID,
                                         A.ID    AS allocation_id
                         FROM   (SELECT BLID,
                                        AL.APID
                                 FROM   CTROPSBLAPLINK AL
                                        JOIN APHEADER AH
                                          ON AH.APID = AL.APID
                                 WHERE  AH.DOCTYPEID = 1
                                 UNION
                                 SELECT BLID,
                                        AL.APID
                                 FROM   CTROPSBLINITIALAPLINK AL
                                        JOIN APHEADER AH
                                          ON AH.APID = AL.APID
                                 WHERE  AH.DOCTYPEID = 1
                                 UNION
                                 SELECT BLID,
                                        AL.APID
                                 FROM   CTROPSBLFINALAPLINK AL
                                        JOIN APHEADER AH
                                          ON AH.APID = AL.APID
                                 WHERE  AH.DOCTYPEID = 1) BL
                                LEFT JOIN APDETAILS ADS
                                       ON ADS.LOADID = BL.BLID
                                          AND ADS.LOADID IS NOT NULL
                                JOIN LOAD L
                                  ON L.ID = BL.BLID
                                JOIN ALLOCATION A
                                  ON A.ID = L.ALLOCATION_ID
                         GROUP  BY ADS.LOADID,
                                   ADS.APID,
                                   BL.APID,
                                   A.ID) ADS
                     ON ( ADS.APID = AP.APID
                          AND L.ID = ADS.LOADID )
                         OR ( ADS.ALLOCATION_ID = SA.ID )
                         OR ( ADS.APID <> AP.APID
                              AND ADS.ALLOCATION_ID = SA.ID )
              LEFT JOIN APHEADER PA
                     ON PA.APID = ADS.PRIMARY_APID
              LEFT JOIN APPOSTED PAA
                     ON PAA.APBATCHID = PA.APBATCHID
			  LEFT JOIN LOAD PRIM_L
                     ON PRIM_L.ID = ADS.LOADID
              LEFT JOIN LOAD PL
                     ON PL.TOP_PARENT_LOAD_ID = ADS.LOADID
              LEFT JOIN LOAD_LOCAL LL
                     ON LL.LOAD_ID = ADS.LOADID
                        AND L.ACTIVE = 1
                         OR ( LL.LOAD_MATCHING_ID = PL.ID
                               OR LL.LOAD_MATCHING_ID = ADS.LOADID )
              LEFT JOIN LOAD CCL
                     ON CCL.ID = LL.LOAD_ID
              LEFT JOIN LOAD_GLOBAL LG
                     ON LG.LOCAL_LOAD_ID = LL.LOAD_ID
              LEFT JOIN LOAD GL
                     ON LG.LOAD_ID = GL.ID
              LEFT JOIN (SELECT AR.*,
                                A.BLID,
                                A.PURCHASEBLID
                         FROM   ARHEADER AR
                                LEFT JOIN (SELECT BLID,
                                                  ARID,
                                                  NULL AS purchaseblid
                                           FROM   CTROPSBLARLINK
                                           UNION
                                           SELECT BLID,
                                                  ARID,
                                                  NULL AS purchaseblid
                                           FROM   CTROPSBLINITIALARLINK
                                           UNION
                                           SELECT BLID,
                                                  ARID,
                                                  NULL AS purchaseblid
                                           FROM   CTROPSBLFINALARLINK
                                           UNION
                                           SELECT SALESLOADID    AS blid,
                                                  ARID,
                                                  PURCHASELOADID AS purchaseblid
                                           FROM   INVOICELOADMATCHTOPURCHASE IMP) A
                                       ON A.ARID = AR.ARID) AR
                     ON ( AR.BLID = LG.LOAD_ID
                           OR AR.PURCHASEBLID = CCL.ID )
                        AND AR.DOCTYPEID = 1
                        AND AR.APPLYDATE <= $P{dateto}
              LEFT JOIN ARHEADER AH
                     ON AH.ARID = AR.ARID
                        AND AH.APPLYDATE <= $P{dateto}
              LEFT JOIN CTR CAH
                     ON AH.CTRID = CAH.CTRID
              LEFT JOIN JCMBR SMBRAH
                     ON SMBRAH.MBRID = CAH.BYRID
              LEFT JOIN JCPROFITCENTER PCAH
                     ON PCAH.PCID = CAH.PCID
              LEFT JOIN JCSPECS JSPCAH
                     ON JSPCAH.SPECID = CAH.SPECID
              LEFT JOIN CTRBOOK CBAH
                     ON CBAH.CTRBOOKID = CAH.CTRBOOKID
              LEFT JOIN GLCOMPANY GLAH
                     ON ( CBAH.MBRCOMPANY = GLAH.COMPANYID )
              LEFT JOIN JC_USER TRAH
                     ON TRAH.ID = CAH.TRADERID
              LEFT JOIN JCMBR CPAH
                     ON CPAH.MBRID = AH.BILLTOID
              LEFT JOIN JCCOUNTERPARTYCATEGORY SCCAH
                     ON SCCAH.CPCATEID = CPAH.CPCATEID
              LEFT JOIN JCCOUNTRY CPAHC
                     ON CPAH.MBRCOUNTRYID = CPAHC.COUNTRYID
              LEFT JOIN XSARDOCTYPE DTAH
                     ON DTAH.DOCTYPEID = AH.DOCTYPEID
              LEFT JOIN XSARDOCCAUSE DCAH
                     ON DCAH.DOCCAUSEID = AH.DOCCAUSEID
              LEFT JOIN ARPOSTED AHH
                     ON AHH.ARBATCHID = AH.ARBATCHID
              LEFT JOIN ARBATCH ABH
                     ON ABH.ARBATCHID = AH.ARBATCHID
              LEFT JOIN INVOICELOADMATCHTOPURCHASE IMP
                     ON IMP.APID = ADS.PRIMARY_APID
                        AND IMP.PURCHASELOADID = ADS.LOADID
              LEFT JOIN ARHEADER SAR
                     ON SAR.ARID = IMP.ARID
                        AND SAR.DOCTYPEID = 1
                        AND SAR.APPLYDATE <= $P{dateto}
              LEFT JOIN CTR CSAR
                     ON SAR.CTRID = CSAR.CTRID
              LEFT JOIN JCMBR SMBRSAR
                     ON SMBRSAR.MBRID = CSAR.BYRID
              LEFT JOIN JCCOUNTERPARTYCATEGORY SCCSAR
                     ON SCCSAR.CPCATEID = SMBRSAR.CPCATEID
              LEFT JOIN JCPROFITCENTER PCSAR
                     ON PCSAR.PCID = CSAR.PCID
              LEFT JOIN JCSPECS JSPCSAR
                     ON JSPCSAR.SPECID = CSAR.SPECID
              LEFT JOIN CTRBOOK CBSAR
                     ON CBSAR.CTRBOOKID = CSAR.CTRBOOKID
              LEFT JOIN GLCOMPANY GLSAR
                     ON ( CBSAR.MBRCOMPANY = GLSAR.COMPANYID )
              LEFT JOIN JC_USER TRSAR
                     ON TRSAR.ID = CSAR.TRADERID
              LEFT JOIN JCMBR CPSAR
                     ON CPSAR.MBRID = SAR.BILLTOID
              LEFT JOIN JCCOUNTRY CPSARC
                     ON CPSAR.MBRCOUNTRYID = CPSARC.COUNTRYID
              LEFT JOIN XSARDOCTYPE DTSAR
                     ON DTSAR.DOCTYPEID = SAR.DOCTYPEID
              LEFT JOIN XSARDOCCAUSE DCSAR
                     ON DCSAR.DOCCAUSEID = SAR.DOCCAUSEID
              LEFT JOIN ARPOSTED PSAR
                     ON PSAR.ARBATCHID = SAR.ARBATCHID
              LEFT JOIN ARBATCH PBH
                     ON PBH.ARBATCHID = SAR.ARBATCHID
       WHERE  CT.CONTRACT_ROLE = 'PURCHASE'
              AND AP.DOCTYPEID <> 1
              AND ( AL.DISCRIMINATOR_TYPE <> 'STRING'
                     OR ( AL.DISCRIMINATOR_TYPE = 'STRING'
                          AND AP.DOCCAUSEID IN ( 5, 6 ) )
                     OR ( AL.DISCRIMINATOR_TYPE IS NULL
                          AND AP.DOCCAUSEID IN ( 3, 5, 6, 13 ) )
                     OR ( AL.DISCRIMINATOR_TYPE IS NULL
                          AND SA.DISCRIMINATOR_TYPE <> 'STRING'
                          AND AP.DOCCAUSEID IN ( 8 ) ) )
              AND APD.APBATCHID IS NOT NULL
              AND 1 = ( CASE
                          WHEN AP.DOCCAUSEID = 3
                               AND AD.AMOUNT < 0 THEN 0
                          ELSE 1
                        END )
              AND AP.DOCCAUSEID <> 42
              AND AP.APPLYDATE >= $P{datefrom}
              AND AP.APPLYDATE <= $P{dateto}
       $P!{QSTR_Filter}
       UNION ALL
       /*SALES CN/DN*/
       SELECT          'N/A'                                                                                                               AS 'PURCHASE CTR. REF#',
                       'N/A'                                                                                                               AS 'PURCHASE PROFIT CENTER',
                       'N/A'                                                                                                               AS 'PURCHASE CONTRACT BOOK',
                       'N/A'                                                                                                               AS 'PURCHASE BL NO',
                       'N/A'                                                                                                               AS 'PURCHASE VOUCHER',
                       NULL                                                                                                                AS 'VOUCHER POST DATE',
                       NULL                                                                                                                AS 'VOUCHER DOC DATE',
                       NULL                                                                                                                AS 'VOUCHER DUE DATE',
                       NULL                                                                                                                AS 'VOUCHER APPLY DATE',
                       'N/A'                                                                                                               AS 'PURCHASE COMMODITY',
                       'N/A'                                                                                                               AS 'PURCHASE COUNTERPARTY',
                       'N/A'                                                                                                               AS 'PURCHASE COUNTERPARTY CATEGORY',
                       'N/A'                                                                                                               AS 'SUPPLIER COUNTRY',
                       COALESCE(AL.DISCRIMINATOR_TYPE, SA.DISCRIMINATOR_TYPE)                                                              AS 'ALOCATION TYPE',
                       COALESCE(AL.REFERENCE, SA.REFERENCE)                                                                                AS 'ALLOCATION REF#',
                       'N/A'                                                                                                               AS 'PUR. DOC. TYPE',
                       'N/A'                                                                                                               AS 'PUR. DOC. CAUSE',
                       CASE
                         WHEN AR.DOCCAUSEID = 4 THEN 0
                         WHEN AR.DOCCAUSEID = 9
                               OR AR.DOCCAUSEID = 10
                               OR AR.DOCCAUSEID = 6 THEN 0
                         ELSE AD.QTY
                       END                                                                                                                 AS 'QUANTITY',
                       NULL                                                                                                                AS 'ORIGINAL PURCHASE VALUE',
                       NULL                                                                                                                AS 'ORIGINAL PURCHASE VALUE IN COMPANY CURR',
                       0                                                                                                                   AS 'STOCK ADJUSTED QTY',
                       0                                                                                                                   AS 'STOCK ADJUSTMENT VALUE',
                       0                                                                                                                   AS 'STOCK ADJUSTMENT VALUE IN COMPANY CURR',
                       NULL                                                                                                                AS 'PURCHASE VALUE IN COMPANY CURR',
                       'N/A'                                                                                                               AS 'PURCHASE COMPANY CURRENCY',
                       NULL                                                                                                                AS 'PURCHASE VALUE',
                       'N/A'                                                                                                               AS 'VOUCHER CURRENCY',
                       NULL                                                                                                                AS 'PURCHASE UNIT PRICE',
                       NULL                                                                                                                AS 'PURCHASE ORIGINAL UNIT PRICE',
                       NULL                                                                                                                AS 'PURCHASE FX RATE',
                       NULL                                                                                                                AS 'PURCHASE DISCHARGE QUANTITY',
                       NULL                                                                                                                AS 'PURCHASE PROVISIONAL QTY',
                       NULL                                                                                                                AS 'PURCHASE FIXED QTY',
                       NULL                                                                                                                AS 'PURCHASE BALANCE TO FIX',
                       NULL                                                                                                                AS 'PURCHASE FIXED PRICE',
                       'N/A'                                                                                                               AS 'PURCHASE TRANSPORT / TRIP NO',
                       C.CTRREF                                                                                                            AS 'SALES CTR. REF#',
                       GLC.GLBOOKNAME                                                                                                      AS 'SALES COMPANY',
                       PC.PCNAME                                                                                                           AS 'SALES PROFIT CENTER',
                       B.CTRBOOKNAME                                                                                                       AS 'SALES CONTRACT BOOK',
                       C.CTRBASISID                                                                                                        AS 'SALES INCOTERM',
                       AD.COSTCENTER                                                                                                       AS 'SALES COST CENTER',
                       JSP.SPECNAME                                                                                                        AS 'SALES GRADE',
                       JSP.SPECDESC                                                                                                        AS 'SALES GRADE DESC',
                       TRAD.FIRST_NAME + ' ' + TRAD.LAST_NAME                                                                              AS 'SALES TRADER NAME',
                       CONVERT(NVARCHAR(100), L.REFERENCE_BLNO)                                                                            AS 'SALES BL NO',
                       L.LOAD_DATE                                                                                                         AS 'SALES LOAD DATE',
                       AR.ARREF                                                                                                            AS 'SALES INVOICE',
                       AR.SRCDOCREF                                                                                                        AS 'SALES EXTERNAL REFERENCE',
                       AR.DOCDATE                                                                                                          AS 'INVOICE DOC DATE',
                       AR.DUEDATE                                                                                                          AS 'INVOICE DUE DATE',
                       AR.APPLYDATE                                                                                                        AS 'INVOICE APPLY DATE',
                       C.COMMODITYID                                                                                                       AS 'SALES COMMODITY',
                       SMBR.MBRNAME                                                                                                        AS 'SALES CONTRACTUAL COUNTERPARTY',
                       SCP.MBRNAME                                                                                                         AS 'SALES COUNTERPARTY',
                       CASE
                         WHEN SCP.ISINTERCO = 1 THEN 'INTERNAL'
                         ELSE 'EXTERNAL'
                       END                                                                                                                 AS 'INTERNAL/EXTERNAL COUNTERPARTY',
                       SCC.NAME                                                                                                            AS 'SALES COUNTERPARTY CATEGORY',
                       SCPC.COUNTRYNAME                                                                                                    AS 'CUSTOMER COUNTRY',
                       DT.LONGNAME                                                                                                         AS 'SALES DOC. TYPE',
                       AC.DOCCAUSE                                                                                                         AS 'SALES DOC. CAUSE',
                       ( CASE
                           WHEN AR.DOCCAUSEID = 4 THEN COALESCE((SELECT DET.ITEMAMT
                                                                 FROM   ARHEADER AH
                                                                        JOIN (SELECT DISTINCT LOADID,
                                                                                              ARID,
                                                                                              ITEMAMT
                                                                              FROM   ARDETAILS) DET
                                                                          ON AH.ARID = DET.ARID
                                                                 WHERE  AH.DOCTYPEID = 1
                                                                        AND DOCCAUSEID IN ( 3, 6 )
                                                                        AND DET.LOADID = AD.LOADID) * -1, 0)
                           ELSE 0
                         END
                         + AD.AMOUNT ) * AR.EXCHRATE                                                                                       AS 'SALES VALUE IN COMPANY CURRENCY',
                       GLC.CURRENCYID                                                                                                      AS 'SALES COMPANY CURRENCY',
                       ( CASE
                           WHEN AR.DOCCAUSEID = 4 THEN COALESCE((SELECT DET.ITEMAMT
                                                                 FROM   ARHEADER AH
                                                                        JOIN (SELECT DISTINCT LOADID,
                                                                                              ARID,
                                                                                              ITEMAMT
                                                                              FROM   ARDETAILS) DET
                                                                          ON AH.ARID = DET.ARID
                                                                 WHERE  AH.DOCTYPEID = 1
                                                                        AND DOCCAUSEID IN ( 3, 6 )
                                                                        AND DET.LOADID = AD.LOADID) * -1, 0)
                           ELSE 0
                         END
                         + AD.AMOUNT )                                                                                                     AS 'SALES VALUE',
                       AR.CURRENCYID                                                                                                       AS 'INVOICE CURRENCY',
                       CASE
                         WHEN AR.DOCCAUSEID = 13 THEN (SELECT Sum(CASE
                                                                    WHEN QTY < 0 THEN -1 * UPRICE
                                                                    ELSE UPRICE
                                                                  END)
                                                       FROM   ARDETAILS
                                                       WHERE  ARID = AR.ARID
                                                              AND UPRICE IS NOT NULL
                                                              AND LOADID = L.ID)
                         WHEN AR.DOCCAUSEID = 6 THEN (SELECT TOP 1 UPRICE
                                                      FROM   ARDETAILS
                                                      WHERE  ARID = AR.ARID
                                                             AND UPRICE IS NOT NULL
                                                             AND QTY IS NOT NULL)
                         ELSE (SELECT TOP 1 UPRICE
                               FROM   ARDETAILS
                               WHERE  ARID = AR.ARID
                                      AND UPRICE IS NOT NULL
                                      AND loadid = l.id)
                       END                                                                                                                 AS 'SALES UNIT PRICE',
                       (SELECT TOP 1 SHORTNAME
                        FROM   ARDETAILS AD
                               JOIN JCIVUOM JU
                                 ON JU.UOMID = AD. UOMID
                        WHERE  ARID = AR.ARID
                               AND UPRICE IS NOT NULL)                                                                                     AS 'SALES UOM',
                       (SELECT TOP 1 EXCHRATE
                        FROM   ARDETAILS AD
                        WHERE  ARID = AR.ARID
                               AND UPRICE IS NOT NULL)                                                                                     AS 'SALES FX RATE',
                       NULL                                                                                                                AS 'SALES DISCHARGE QUANTITY',
                       CASE
                         WHEN AR.DOCCAUSEID = 13 THEN QTY * -1
                         ELSE 0
                       END                                                                                                                 AS 'SALES PROVISIONAL QTY',
                       CASE
                         WHEN AR.DOCCAUSEID = 13 THEN QTY
                         ELSE 0
                       END                                                                                                                 AS 'SALES FIXED QTY',
                       CASE
                         WHEN AR.DOCCAUSEID = 13 THEN COALESCE(CASE
                                                                 WHEN C.ISGROSSWEIGHT = 1 THEN L.GROSS_WEIGHT
                                                                 ELSE L.NET_WEIGHT
                                                               END, 0) - COALESCE((SELECT Sum(PRICEDQTY)
                                                                                   FROM   CTRINVPRICINGCENTERMATCH
                                                                                   WHERE  LOADID = L.ID
                                                                                          AND ISPRICEFIX = 1
                                                                                          AND ARID <= AR.ARID), 0)
                         ELSE 0
                       END                                                                                                                 AS 'SALES BALANCE TO FIX',
                       CASE
                         WHEN AR.DOCCAUSEID = 4
                              AND C.PRICEBASISID > 0 THEN COALESCE((SELECT Sum(PRICEDQTY * TOTALPRICE) / Sum(PRICEDQTY)
                                                                    FROM   CTRINVPRICINGCENTERMATCH
                                                                    WHERE  ARID = AR.ARID
                                                                           AND LOADID = L.ID
                                                                           AND ISPRICEFIX = 1), 0) * (SELECT TOP 1 EXCHRATE
                                                                                                      FROM   ARDETAILS
                                                                                                      WHERE  ITEMAMT IS NOT NULL
                                                                                                             AND ARID = AR.ARID
                                                                                                             AND LOADID = L.ID)
                         WHEN AR.DOCCAUSEID = 4 THEN (SELECT TOP 1 UPRICE
                                                      FROM   ARDETAILS
                                                      WHERE  ITEMAMT IS NOT NULL
                                                             AND ARID = AR.ARID
                                                             AND LOADID = L.ID)
                         ELSE 0
                       END                                                                                                                 AS 'SALES FIXED PRICE',
                       Replace(Replace(Replace(Ltrim(Rtrim(L.TRANSPORT + ' / ' + SMO.TRIPNO)), Char(10), ''), Char(13), ''), Char(09), '') AS 'SALES TRANSPORT / TRIP NO',
                       NULL                                                                                                                AS 'REALIZED QTY',
                       CASE
                         WHEN ARP.ARBATCHID IS NOT NULL THEN ABH.POSTDATE
                         ELSE NULL
                       END                                                                                                                 AS 'INVOICE POST DATE',
                       CASE
                         WHEN ARP.ARBATCHID IS NOT NULL THEN 'POSTED'
                         ELSE 'UNPOSTED'
                       END                                                                                                                 AS 'INVOICE STATUS',
                       NULL                                                                                                                AS 'VOUCHER STATUS',
                       'REALIZED'                                                                                                          AS 'REPORT STATUS',
                       CASE
                         WHEN SA.ID IS NOT NULL THEN COALESCE(Stuff((SELECT DISTINCT ', ' + AH.ARREF
                                                                     FROM   ARHEADER AH
                                                                            JOIN (SELECT DISTINCT LOADID,
                                                                                                  ARID
                                                                                  FROM   ARDETAILS) DET
                                                                              ON AH.ARID = DET.ARID
                                                                     WHERE  AH.DOCTYPEID = 1
                                                                            AND DOCCAUSEID IN ( 3, 4, 6 )
                                                                            AND DET.LOADID = (SELECT TOP 1 ID
                                                                                              FROM   LOAD
                                                                                              WHERE  ALLOCATION_ID = SA.ID)
                                                                     FOR XML PATH('')), 1, 2, ''), '')
                         ELSE COALESCE(Stuff((SELECT DISTINCT ', ' + AH.ARREF
                                              FROM   ARHEADER AH
                                                     JOIN (SELECT DISTINCT LOADID,
                                                                           ARID
                                                           FROM   ARDETAILS) DET
                                                       ON AH.ARID = DET.ARID
                                              WHERE  AH.DOCTYPEID = 1
                                                     AND DOCCAUSEID IN ( 3, 4, 6 )
                                                     AND DET.LOADID = AD.LOADID
                                              FOR XML PATH('')), 1, 2, ''), '')
                       END                                                                                                                 AS 'LINKAGE VOUCHER/INVOICE',
                       CASE
                         WHEN COALESCE(Stuff((SELECT DISTINCT ', ' + AH.ARREF
                                              FROM   ARHEADER AH
                                                     JOIN (SELECT DISTINCT LOADID,
                                                                           ARID
                                                           FROM   ARDETAILS) DET
                                                       ON AH.ARID = DET.ARID
                                              WHERE  AH.DOCTYPEID = 1
                                                     AND DOCCAUSEID IN ( 3, 4, 6 )
                                                     AND DET.LOADID = AD.LOADID
                                              FOR XML PATH('')), 1, 2, ''), '') <> '' THEN 'PRIMARY'
                         WHEN ( SA.ID IS NOT NULL
                                AND COALESCE(Stuff((SELECT DISTINCT ', ' + AH.ARREF
                                                    FROM   ARHEADER AH
                                                           JOIN (SELECT DISTINCT LOADID,
                                                                                 ARID
                                                                 FROM   ARDETAILS) DET
                                                             ON AH.ARID = DET.ARID
                                                    WHERE  AH.DOCTYPEID = 1
                                                           AND DOCCAUSEID IN ( 3, 4, 6 )
                                                           AND DET.LOADID = (SELECT TOP 1 ID
                                                                             FROM   LOAD
                                                                             WHERE  ALLOCATION_ID = SA.ID)
                                                    FOR XML PATH('')), 1, 2, ''), '') <> '' ) THEN 'PRIMARY'
                         ELSE 'NO LINKAGE'
                       END                                                                                                                 AS 'LINKAGE STATUS',
                       'N/A'                                                                                                               AS purchase_pcid,
                       Cast(PC.PCID AS NVARCHAR(5))                                                                                        AS sales_pcid,
                       'N/A'                                                                                                               AS purchase_company,
                       NULL                                                                                                                AS 'PURCHASE FX RATE TO COMPANY CURR',
                       AR.EXCHRATE                                                                                                         AS 'SALES FX RATE TO COMPANY CURR'
       FROM   CTR C
              JOIN JCMBR SMBR
                ON SMBR.MBRID = C.BYRID
              JOIN CTRBOOK B
                ON ( C.CTRBOOKID = B.CTRBOOKID )
              LEFT JOIN JCPROFITCENTER PC
                     ON PC.PCID = C.PCID
              LEFT JOIN JCSPECS JSP
                     ON JSP.SPECID = C.SPECID
              LEFT JOIN JC_USER TRAD
                     ON TRAD.ID = C.TRADERID
              JOIN GLCOMPANY GLC
                ON ( B.MBRCOMPANY = GLC.COMPANYID )
              LEFT JOIN CONTRACT CT
                     ON C.CTRREF = CT.REFERENCE
              LEFT JOIN ARHEADER AR
                     ON AR.CTRID = C.CTRID
              LEFT JOIN JCMBR SCP
                     ON SCP.MBRID = AR.BILLTOID
              LEFT JOIN JCCOUNTERPARTYCATEGORY SCC
                     ON SCC.CPCATEID = SCP.CPCATEID
              LEFT JOIN JCCOUNTRY SCPC
                     ON SCP.MBRCOUNTRYID = SCPC.COUNTRYID
              LEFT JOIN (SELECT Sum(ITEMAMT) AS amount,
                                Sum(CASE
                                      WHEN QTY > 0 THEN QTY
                                      ELSE 0
                                    END)     AS qty,
                                LOADID,
                                ARID,
                                COSTCENTER
                         FROM   ARDETAILS
                         WHERE  ITEMAMT IS NOT NULL
                         GROUP  BY LOADID,
                                   ARID,
                                   COSTCENTER) AD
                     ON AD.ARID = AR.ARID
              LEFT JOIN LOAD L
                     ON L.ID = AD.LOADID
              LEFT JOIN LOAD_LOCAL SLL
                     ON SLL.GLOBAL_LOAD_ID = L.ID
              LEFT JOIN MOVEMENT_OPERATION SMO
                     ON SMO.ID = SLL.MOVEMENT_OPERATION_ID
              LEFT JOIN (SELECT Sum(COALESCE(NET_WEIGHT, 0))   AS net_weight,
                                Sum(COALESCE(GROSS_WEIGHT, 0)) AS gross_weight,
                                LOAD_ID
                         FROM   DISCHARGE
                         GROUP  BY LOAD_ID) D
                     ON D.LOAD_ID = L.ID
              LEFT JOIN ALLOCATION AL
                     ON AL.ID = L.ALLOCATION_ID
              LEFT JOIN XSARDOCTYPE DT
                     ON DT.DOCTYPEID = AR.DOCTYPEID
              LEFT JOIN XSARDOCCAUSE AC
                     ON AC.DOCCAUSEID = AR.DOCCAUSEID
              LEFT JOIN ARPOSTED ARP
                     ON ARP.ARBATCHID = AR.ARBATCHID
              LEFT JOIN ARBATCH ABH
                     ON ABH.ARBATCHID = AR.ARBATCHID
              LEFT JOIN STRINGARLINK SL
                     ON SL.ARID = AR.ARID
              LEFT JOIN STR_MAIN SM
                     ON SM.ID = SL.STRMAINID
              LEFT JOIN ALLOCATION SA
                     ON SA.ID = SM.MAIN_ALLOCATION
       WHERE  CT.CONTRACT_ROLE = 'SALES'
              AND AR.DOCTYPEID <> 1
              AND ( AL.DISCRIMINATOR_TYPE <> 'STRING'
                     OR ( AL.DISCRIMINATOR_TYPE = 'STRING'
                          AND AR.DOCCAUSEID IN ( 9, 10 ) )
                     OR ( AL.DISCRIMINATOR_TYPE IS NULL
                          AND AR.DOCCAUSEID IN ( 4, 9, 10, 13 ) )
                     OR ( AL.DISCRIMINATOR_TYPE IS NULL
                          AND SA.DISCRIMINATOR_TYPE <> 'STRING'
                          AND AR.DOCCAUSEID IN ( 6 ) ) )
              AND ARP.ARBATCHID IS NOT NULL
              AND 1 = ( CASE
                          WHEN AR.DOCCAUSEID = 4
                               AND AD.AMOUNT < 0 THEN 0
                          ELSE 1
                        END )
              AND ( AR.DOCCAUSEID <> 53
                    AND 1 = CASE
                              WHEN AR.DOCCAUSEID = 52
                                   AND AR.DOCTYPEID = 2 THEN 0
                              ELSE 1
                            END )
              AND AR.APPLYDATE >= $P{datefrom}
              AND AR.APPLYDATE <= $P{dateto}
       $P!{QSTR_Filter}
       GROUP  BY C.CTRREF,
                 AR.ARREF,
                 AR.APPLYDATE,
                 C.COMMODITYID,
                 AL.DISCRIMINATOR_TYPE,
                 AL.REFERENCE,
                 DT.LONGNAME,
                 AR.EXCHRATE,
                 AR.ARID,
                 GLC.CURRENCYID,
                 AR.CURRENCYID,
                 AD.LOADID,
                 B.CTRBOOKNAME,
                 PC.PCNAME,
                 AD.AMOUNT,
                 AR.DOCCAUSEID,
                 L.NET_WEIGHT,
                 AD.QTY,
                 L.ID,
                 C.PRICEBASISID,
                 C.ISGROSSWEIGHT,
                 L.GROSS_WEIGHT,
                 ARP.ARBATCHID,
                 SA.DISCRIMINATOR_TYPE,
                 SA.REFERENCE,
                 SA.ID,
                 SCP.MBRNAME,
                 AC.DOCCAUSE,
                 L.REFERENCE_BLNO,
                 SCPC.COUNTRYNAME,
                 GLC.GLBOOKNAME,
                 AD.COSTCENTER,
                 JSP.SPECNAME,
                 JSP.SPECDESC,
                 ABH.POSTDATE,
                 TRAD.FIRST_NAME,
                 TRAD.LAST_NAME,
                 C.CTRBASISID,
                 AR.SRCDOCREF,
                 L.LOAD_DATE,
                 AR.DOCDATE,
                 AR.DUEDATE,
                 L.TRANSPORT,
                 SMO.TRIPNO,
                 SMBR.MBRNAME,
                 SCP.ISINTERCO,
                 SCC.NAME,
                 Cast(PC.PCID AS NVARCHAR(5))
        UNION ALL
        /*SALES RETURN DN MOVE TO ORIGINAL PURCHASE*/
        SELECT          OP.REFERENCE                                                                                                       AS 'PURCHASE CTR. REF#',
                        OPC.PCNAME                                                                                                         AS 'PURCHASE PROFIT CENTER',
                        OB.CTRBOOKNAME                                                                                                     AS 'PURCHASE CONTRACT BOOK',
                        CONVERT(NVARCHAR(100), L.REFERENCE_BLNO)                                                                           AS 'PURCHASE BL NO',
                        AR.ARREF                                                                                                           AS 'PURCHASE VOUCHER',
                        CASE
                          WHEN ARP.ARBATCHID IS NOT NULL THEN ARB.POSTDATE
                          ELSE NULL
                        END                                                                                                                AS 'VOUCHER POST DATE',
                        AR.DOCDATE                                                                                                         AS 'VOUCHER DOC DATE',
                        AR.DUEDATE                                                                                                         AS 'VOUCHER DUE DATE',
                        AR.APPLYDATE                                                                                                       AS 'VOUCHER APPLY DATE',
                        OC.COMMODITYID                                                                                                     AS 'PURCHASE COMMODITY',
                        SCP.MBRNAME                                                                                                        AS 'PURCHASE COUNTERPARTY',
                        PCC.NAME                                                                                                           AS 'PURCHASE COUNTERPARTY CATEGORY',
                        SCPC.COUNTRYNAME                                                                                                   AS 'SUPPLIER COUNTRY',
                        COALESCE(AL.DISCRIMINATOR_TYPE, SA.DISCRIMINATOR_TYPE)                                                             AS 'ALOCATION TYPE',
                        COALESCE(AL.REFERENCE, SA.REFERENCE)                                                                               AS 'ALLOCATION REF#',
                        DT.LONGNAME                                                                                                        AS 'PUR. DOC. TYPE',
                        AC.DOCCAUSE                                                                                                        AS 'PUR. DOC. CAUSE',
                        AD.QTY                                                                                                             AS 'QUANTITY',
                        AD.AMOUNT * -1                                                                                                     AS 'ORIGINAL PURCHASE VALUE',
                        AD.AMOUNT * AR.EXCHRATE * -1                                                                                       AS 'ORIGINAL PURCHASE VALUE IN COMPANY CURR',
                        0                                                                                                                  AS 'STOCK ADJUSTED QTY',
                        0                                                                                                                  AS 'STOCK ADJUSTMENT VALUE',
                        0                                                                                                                  AS 'STOCK ADJUSTMENT VALUE IN COMPANY CURR',
                        AD.AMOUNT * AR.EXCHRATE * -1                                                                                       AS 'PURCHASE VALUE IN COMPANY CURR',
                        GLC.CURRENCYID                                                                                                     AS 'PURCHASE COMPANY CURRENCY',
                        AD.AMOUNT * -1                                                                                                     AS 'PURCHASE VALUE',
                        AR.CURRENCYID                                                                                                      AS 'VOUCHER CURRENCY',
                        (SELECT TOP 1 UPRICE
                         FROM   ARDETAILS
                         WHERE  ARID = AD.ARID
                                AND LOADID = AD.LOADID)                                                                                    AS 'PURCHASE UNIT PRICE',
                        (SELECT TOP 1 UPRICE
                         FROM   ARDETAILS
                         WHERE  ARID = AD.ARID
                                AND LOADID = AD.LOADID)                                                                                    AS 'PURCHASE ORIGINAL UNIT PRICE',
                        (SELECT TOP 1 EXCHRATE
                         FROM   ARDETAILS
                         WHERE  ARID = AD.ARID
                                AND LOADID = AD.LOADID)                                                                                    AS 'PURCHASE FX RATE',
                        (SELECT COALESCE(Sum(NET_WEIGHT), 0)
                         FROM   DISCHARGE
                         WHERE  LOAD_ID = AD.LOADID
                                AND STATUS = 'UNLOADED')                                                                                   AS 'PURCHASE DISCHARGE QUANTITY',
                        0                                                                                                                  AS 'PURCHASE PROVISIONAL QTY',
                        0                                                                                                                  AS 'PURCHASE FIXED QTY',
                        0                                                                                                                  AS 'PURCHASE BALANCE TO FIX',
                        0                                                                                                                  AS 'PURCHASE FIXED PRICE',
                        Replace(Replace(Replace(Ltrim(Rtrim(L.TRANSPORT + ' / ' + MO.TRIPNO)), Char(10), ''), Char(13), ''), Char(09), '') AS 'PURCHASE TRANSPORT / TRIP NO',
                        'N/A'                                                                                                              AS 'SALES CTR. REF#',
                        'N/A'                                                                                                              AS 'SALES COMPANY',
                        'N/A'                                                                                                              AS 'SALES PROFIT CENTER',
                        'N/A'                                                                                                              AS 'SALES CONTRACT BOOK',
                        'N/A'                                                                                                              AS 'SALES INCOTERM',
                        'N/A'                                                                                                              AS 'SALES COST CENTER',
                        'N/A'                                                                                                              AS 'SALES GRADE',
                        'N/A'                                                                                                              AS 'SALES GRADE DESC',
                        'N/A'                                                                                                              AS 'SALES TRADER NAME',
                        'N/A'                                                                                                              AS 'SALES BL NO',
                        NULL                                                                                                               AS 'SALES LOAD DATE',
                        'N/A'                                                                                                              AS 'SALES INVOICE',
                        'N/A'                                                                                                              AS 'SALES EXTERNAL REFERENCE',
                        NULL                                                                                                               AS 'INVOICE DOC DATE',
                        NULL                                                                                                               AS 'INVOICE DUE DATE',
                        NULL                                                                                                               AS 'INVOICE APPLY DATE',
                        'N/A'                                                                                                              AS 'SALES COMMODITY',
                        'N/A'                                                                                                              AS 'SALES CONTRACTUAL COUNTERPARTY',
                        'N/A'                                                                                                              AS 'SALES COUNTERPARTY',
                        'N/A'                                                                                                              AS 'INTERNAL/EXTERNAL COUNTERPARTY',
                        'N/A'                                                                                                              AS 'SALES COUNTERPARTY CATEGORY',
                        'N/A'                                                                                                              AS 'CUSTOMER COUNTRY',
                        'N/A'                                                                                                              AS 'SALES DOC. TYPE',
                        'N/A'                                                                                                              AS 'SALES DOC. CAUSE',
                        NULL                                                                                                               AS 'SALES VALUE IN COMPANY CURRENCY',
                        'N/A'                                                                                                              AS 'SALES COMPANY CURRENCY',
                        NULL                                                                                                               AS 'SALES VALUE',
                        'N/A'                                                                                                              AS 'INVOICE CURRENCY',
                        NULL                                                                                                               AS 'SALES UNIT PRICE',
                        'N/A'                                                                                                              AS 'SALES UOM',
                        NULL                                                                                                               AS 'SALES FX RATE',
                        NULL                                                                                                               AS 'SALES DISCHARGE QUANTITY',
                        NULL                                                                                                               AS 'SALES PROVISIONAL QTY',
                        NULL                                                                                                               AS 'SALES FIXED QTY',
                        NULL                                                                                                               AS 'SALES BALANCE TO FIX',
                        NULL                                                                                                               AS 'SALES FIXED PRICE',
                        'N/A'                                                                                                              AS 'SALES TRANSPORT / TRIP NO',
                        AD.QTY                                                                                                             AS 'REALIZED QTY',
                        NULL                                                                                                               AS 'INVOICE POST DATE',
                        NULL                                                                                                               AS 'INVOICE STATUS',
                        CASE
                          WHEN ARP.ARBATCHID IS NOT NULL THEN 'POSTED'
                          ELSE 'UNPOSTED'
                        END                                                                                                                AS 'VOUCHER STATUS',
                        'REALIZED'                                                                                                         AS 'REPORT STATUS',
                        NULL                                                                                                               AS 'LINKAGE VOUCHER/INVOICE',
                        'NO LINKAGE'                                                                                                       AS 'LINKAGE STATUS',
                        Cast(OPC.PCID AS NVARCHAR(5))                                                                                      AS purchase_pcid,
                        'N/A'                                                                                                              AS sales_pcid,
                        GLC.GLBOOKNAME                                                                                                     AS purchase_company,
                        AR.EXCHRATE                                                                                                        AS 'PURCHASE FX RATE TO COMPANY CURR',
                        NULL                                                                                                               AS 'SALES FX RATE TO COMPANY CURR'
        FROM   CTR C
               JOIN CTRBOOK B
                 ON ( C.CTRBOOKID = B.CTRBOOKID )
               LEFT JOIN JCPROFITCENTER PC
                      ON PC.PCID = C.PCID
               JOIN GLCOMPANY GLC
                 ON ( B.MBRCOMPANY = GLC.COMPANYID )
               LEFT JOIN CONTRACT CT
                      ON C.CTRREF = CT.REFERENCE
               LEFT JOIN ARHEADER AR
                      ON AR.CTRID = C.CTRID
               LEFT JOIN JCMBR SCP
                      ON SCP.MBRID = AR.BILLTOID
               LEFT JOIN JCCOUNTERPARTYCATEGORY PCC
                      ON PCC.CPCATEID = SCP.CPCATEID
               LEFT JOIN JCCOUNTRY SCPC
                      ON SCP.MBRCOUNTRYID = SCPC.COUNTRYID
               LEFT JOIN (SELECT Sum(ITEMAMT) AS amount,
                                 Sum(CASE
                                       WHEN QTY > 0 THEN QTY
                                       ELSE 0
                                     END)     AS qty,
                                 LOADID,
                                 ARID
                          FROM   ARDETAILS
                          WHERE  ITEMAMT IS NOT NULL
                          GROUP  BY LOADID,
                                    ARID) AD
                      ON AD.ARID = AR.ARID
               LEFT JOIN LOAD L
                      ON L.ID = AD.LOADID
               LEFT JOIN LOAD_LOCAL LL
                      ON LL.GLOBAL_LOAD_ID = L.ID
               LEFT JOIN MOVEMENT_OPERATION MO
                      ON MO.ID = LL.MOVEMENT_OPERATION_ID
               LEFT JOIN (SELECT Sum(COALESCE(NET_WEIGHT, 0))   AS net_weight,
                                 Sum(COALESCE(GROSS_WEIGHT, 0)) AS gross_weight,
                                 LOAD_ID
                          FROM   DISCHARGE
                          GROUP  BY LOAD_ID) D
                      ON D.LOAD_ID = L.ID
               LEFT JOIN ALLOCATION AL
                      ON AL.ID = L.ALLOCATION_ID
               LEFT JOIN XSARDOCTYPE DT
                      ON DT.DOCTYPEID = AR.DOCTYPEID
               LEFT JOIN XSARDOCCAUSE AC
                      ON AC.DOCCAUSEID = AR.DOCCAUSEID
               LEFT JOIN ARPOSTED ARP
                      ON ARP.ARBATCHID = AR.ARBATCHID
               LEFT JOIN ARBATCH ARB
                      ON ARB.ARBATCHID = AR.ARBATCHID
               LEFT JOIN STRINGARLINK SL
                      ON SL.ARID = AR.ARID
               LEFT JOIN STR_MAIN SM
                      ON SM.ID = SL.STRMAINID
               LEFT JOIN ALLOCATION SA
                      ON SA.ID = SM.MAIN_ALLOCATION
               LEFT JOIN CONTRACT_POSITION OCP
                      ON OCP.ID = AL.CONTRACT_POSITION_ID_SOURCE
               LEFT JOIN CONTRACT OP
                      ON OP.ID = OCP.CONTRACT_ID
               LEFT JOIN CTR OC
                      ON OC.CTRREF = OP.REFERENCE
               LEFT JOIN CTRBOOK OB
                      ON ( OC.CTRBOOKID = OB.CTRBOOKID )
               LEFT JOIN JCPROFITCENTER OPC
                      ON OPC.PCID = OC.PCID
        WHERE  CT.CONTRACT_ROLE = 'SALES'
               AND ARP.ARBATCHID IS NOT NULL
               AND AR.DOCCAUSEID = 52
               AND AR.DOCTYPEID = 2
               AND AR.APPLYDATE >= $P{datefrom}
               AND AR.APPLYDATE <= $P{dateto}
       $P!{QSTR_Filter}

) ASDF
WHERE [REPORT STATUS] LIKE $P{p_realized_type}
	AND COALESCE([SALES COMPANY], PURCHASE_COMPANY) LIKE $P{company}
	AND $X{IN,CASE WHEN [PURCHASE CONTRACT BOOK] IS NULL
						OR [PURCHASE CONTRACT BOOK] = 'N/A' THEN [SALES CONTRACT BOOK]
				ELSE [PURCHASE CONTRACT BOOK]
				END,cbk}
	AND $X{IN,PURCHASE_PCID,p_profit_center}
	AND $X{IN,[PURCHASE COMMODITY],p_commodity}
	AND $X{IN,SALES_PCID,s_profit_center}
	AND $X{IN,[SALES COMMODITY],s_commodity}
ORDER BY CASE WHEN ISNULL([SALES PROFIT CENTER],'N/A') = 'N/A' THEN [PURCHASE PROFIT CENTER] ELSE [SALES PROFIT CENTER] END]]>
		</queryString>
		<field name="PROFIT_CENTER" class="java.lang.String"/>
		<field name="PURCHASE CTR. REF#" class="java.lang.String"/>
		<field name="PURCHASE PROFIT CENTER" class="java.lang.String"/>
		<field name="PURCHASE CONTRACT BOOK" class="java.lang.String"/>
		<field name="PURCHASE BL NO" class="java.lang.String"/>
		<field name="PURCHASE VOUCHER" class="java.lang.String"/>
		<field name="VOUCHER POST DATE" class="java.sql.Timestamp"/>
		<field name="VOUCHER DOC DATE" class="java.sql.Date"/>
		<field name="VOUCHER DUE DATE" class="java.sql.Date"/>
		<field name="VOUCHER APPLY DATE" class="java.sql.Date"/>
		<field name="PURCHASE COMMODITY" class="java.lang.String"/>
		<field name="PURCHASE COUNTERPARTY" class="java.lang.String"/>
		<field name="PURCHASE COUNTERPARTY CATEGORY" class="java.lang.String"/>
		<field name="SUPPLIER COUNTRY" class="java.lang.String"/>
		<field name="ALOCATION TYPE" class="java.lang.String"/>
		<field name="ALLOCATION REF#" class="java.lang.String"/>
		<field name="PUR. DOC. TYPE" class="java.lang.String"/>
		<field name="PUR. DOC. CAUSE" class="java.lang.String"/>
		<field name="PURCHASE QUANTITY" class="java.math.BigDecimal"/>
		<field name="PURCHASE VALUE IN COMPANY CURR" class="java.math.BigDecimal"/>
		<field name="PURCHASE COMPANY CURRENCY" class="java.lang.String"/>
		<field name="PURCHASE UNIT PRICE IN USD/MT" class="java.math.BigDecimal"/>
		<field name="PURCHASE VALUE" class="java.math.BigDecimal"/>
		<field name="VOUCHER CURRENCY" class="java.lang.String"/>
		<field name="PURCHASE UNIT PRICE" class="java.math.BigDecimal"/>
		<field name="PURCHASE FX RATE" class="java.math.BigDecimal"/>
		<field name="PURCHASE DISCHARGE QUANTITY" class="java.math.BigDecimal"/>
		<field name="PURCHASE PROVISIONAL QTY" class="java.math.BigDecimal"/>
		<field name="PURCHASE FIXED QTY" class="java.math.BigDecimal"/>
		<field name="PURCHASE BALANCE TO FIX" class="java.math.BigDecimal"/>
		<field name="PURCHASE FIXED PRICE" class="java.math.BigDecimal"/>
		<field name="PURCHASE TRANSPORT / TRIP NO" class="java.lang.String"/>
		<field name="PURCHASE REALIZED QTY" class="java.math.BigDecimal"/>
		<field name="SALES CTR. REF#" class="java.lang.String"/>
		<field name="SALES COMPANY" class="java.lang.String"/>
		<field name="SALES PROFIT CENTER" class="java.lang.String"/>
		<field name="SALES CONTRACT BOOK" class="java.lang.String"/>
		<field name="SALES INCOTERM" class="java.lang.String"/>
		<field name="SALES COST CENTER" class="java.lang.String"/>
		<field name="SALES GRADE" class="java.lang.String"/>
		<field name="SALES GRADE DESC" class="java.lang.String"/>
		<field name="SALES TRADER NAME" class="java.lang.String"/>
		<field name="SALES BL NO" class="java.lang.String"/>
		<field name="SALES LOAD DATE" class="java.sql.Date"/>
		<field name="SALES INVOICE" class="java.lang.String"/>
		<field name="SALES EXTERNAL REFERENCE" class="java.lang.String"/>
		<field name="INVOICE DOC DATE" class="java.sql.Date"/>
		<field name="INVOICE DUE DATE" class="java.sql.Date"/>
		<field name="INVOICE APPLY DATE" class="java.sql.Date"/>
		<field name="SALES COMMODITY" class="java.lang.String"/>
		<field name="SALES CONTRACTUAL COUNTERPARTY" class="java.lang.String"/>
		<field name="SALES COUNTERPARTY" class="java.lang.String"/>
		<field name="INTERNAL/EXTERNAL COUNTERPARTY" class="java.lang.String"/>
		<field name="SALES COUNTERPARTY CATEGORY" class="java.lang.String"/>
		<field name="CUSTOMER COUNTRY" class="java.lang.String"/>
		<field name="SALES DOC. TYPE" class="java.lang.String"/>
		<field name="SALES DOC. CAUSE" class="java.lang.String"/>
		<field name="SALES QUANTITY" class="java.math.BigDecimal"/>
		<field name="SALES VALUE IN COMPANY CURRENCY" class="java.math.BigDecimal"/>
		<field name="SALES COMPANY CURRENCY" class="java.lang.String"/>
		<field name="SALES UNIT PRICE IN USD/MT" class="java.math.BigDecimal"/>
		<field name="SALES VALUE" class="java.math.BigDecimal"/>
		<field name="INVOICE CURRENCY" class="java.lang.String"/>
		<field name="SALES UNIT PRICE" class="java.math.BigDecimal"/>
		<field name="SALES UOM" class="java.lang.String"/>
		<field name="SALES FX RATE" class="java.math.BigDecimal"/>
		<field name="SALES DISCHARGE QUANTITY" class="java.math.BigDecimal"/>
		<field name="SALES PROVISIONAL QTY" class="java.math.BigDecimal"/>
		<field name="SALES FIXED QTY" class="java.math.BigDecimal"/>
		<field name="SALES BALANCE TO FIX" class="java.math.BigDecimal"/>
		<field name="SALES FIXED PRICE" class="java.math.BigDecimal"/>
		<field name="SALES TRANSPORT / TRIP NO" class="java.lang.String"/>
		<field name="SALES REALIZED QTY" class="java.math.BigDecimal"/>
		<field name="INVOICE POST DATE" class="java.sql.Timestamp"/>
		<field name="INVOICE STATUS" class="java.lang.String"/>
		<field name="VOUCHER STATUS" class="java.lang.String"/>
		<field name="REPORT STATUS" class="java.lang.String"/>
		<field name="LINKAGE VOUCHER/INVOICE" class="java.lang.String"/>
		<field name="LINKAGE STATUS" class="java.lang.String"/>
		<field name="QUANTITY" class="java.math.BigDecimal"/>
		<field name="STOCK ADJUSTED QTY" class="java.math.BigDecimal"/>
		<field name="STOCK ADJUSTMENT VALUE" class="java.math.BigDecimal"/>
		<field name="PURCHASE ORIGINAL UNIT PRICE" class="java.math.BigDecimal"/>
		<field name="ORIGINAL PURCHASE VALUE IN COMPANY CURR" class="java.math.BigDecimal"/>
		<field name="ORIGINAL PURCHASE VALUE" class="java.math.BigDecimal"/>
		<field name="STOCK ADJUSTMENT VALUE IN COMPANY CURR" class="java.math.BigDecimal"/>
		<variable name="ST_SALES_VALUE_COMP_CURR" class="java.math.BigDecimal" resetType="Group" resetGroup="PROFIT_CENTER" calculation="Sum">
			<variableExpression><![CDATA[$F{SALES VALUE IN COMPANY CURRENCY}]]></variableExpression>
		</variable>
		<variable name="GT_SALES_VALUE_COMP_CURR" class="java.math.BigDecimal" calculation="Sum">
			<variableExpression><![CDATA[$F{SALES VALUE IN COMPANY CURRENCY}]]></variableExpression>
		</variable>
		<variable name="ST_SALES_DISCHARGE_QTY" class="java.math.BigDecimal" resetType="Group" resetGroup="PROFIT_CENTER" calculation="Sum">
			<variableExpression><![CDATA[$F{SALES DISCHARGE QUANTITY}]]></variableExpression>
		</variable>
		<variable name="GT_SALES_DISCHARGE_QTY" class="java.math.BigDecimal" calculation="Sum">
			<variableExpression><![CDATA[$F{SALES DISCHARGE QUANTITY}]]></variableExpression>
		</variable>
		<variable name="ST_SALES_REALIZED_QTY" class="java.math.BigDecimal" resetType="Group" resetGroup="PROFIT_CENTER" calculation="Sum">
			<variableExpression><![CDATA[$F{SALES REALIZED QTY}]]></variableExpression>
		</variable>
		<variable name="GT_SALES_REALIZED_QTY" class="java.math.BigDecimal" calculation="Sum">
			<variableExpression><![CDATA[$F{SALES REALIZED QTY}]]></variableExpression>
		</variable>
		<variable name="ST_PURCHASE_QUANTITY" class="java.math.BigDecimal" resetType="Group" resetGroup="PROFIT_CENTER" calculation="Sum">
			<variableExpression><![CDATA[$F{QUANTITY}]]></variableExpression>
		</variable>
		<variable name="GT_PURCHASE_QUANTITY" class="java.math.BigDecimal" calculation="Sum">
			<variableExpression><![CDATA[$F{QUANTITY}]]></variableExpression>
		</variable>
		<variable name="ST_PURCHASE_VALUE_COMP_CURR" class="java.math.BigDecimal" resetType="Group" resetGroup="PROFIT_CENTER" calculation="Sum">
			<variableExpression><![CDATA[$F{PURCHASE VALUE IN COMPANY CURR}]]></variableExpression>
		</variable>
		<variable name="GT_PURCHASE_VALUE_COMP_CURR" class="java.math.BigDecimal" calculation="Sum">
			<variableExpression><![CDATA[$F{PURCHASE VALUE IN COMPANY CURR}]]></variableExpression>
		</variable>
		<variable name="ST_PURCHASE_DISCHARGE_QTY" class="java.math.BigDecimal" resetType="Group" resetGroup="PROFIT_CENTER" calculation="Sum">
			<variableExpression><![CDATA[$F{PURCHASE DISCHARGE QUANTITY}]]></variableExpression>
		</variable>
		<variable name="GT_PURCHASE_DISCHARGE_QTY" class="java.math.BigDecimal" calculation="Sum">
			<variableExpression><![CDATA[$F{PURCHASE DISCHARGE QUANTITY}]]></variableExpression>
		</variable>
		<variable name="ST_PURCHASE_REALIZED_QTY" class="java.math.BigDecimal" resetType="Group" resetGroup="PROFIT_CENTER" calculation="Sum">
			<variableExpression><![CDATA[$F{PURCHASE REALIZED QTY}]]></variableExpression>
		</variable>
		<variable name="GT_PURCHASE_REALIZED_QTY" class="java.math.BigDecimal" calculation="Sum">
			<variableExpression><![CDATA[$F{PURCHASE REALIZED QTY}]]></variableExpression>
		</variable>
		<group name="PROFIT_CENTER">
			<groupExpression><![CDATA[$F{PROFIT_CENTER}]]></groupExpression>
		</group>
	</subDataset>
	<parameter name="company" class="java.lang.String"/>
	<parameter name="profit_center" class="java.lang.String"/>
	<parameter name="commodity" class="java.lang.String"/>
	<parameter name="cbk" class="java.util.Collection"/>
	<parameter name="LE_Filter" class="java.lang.String">
		<parameterDescription><![CDATA[]]></parameterDescription>
	</parameter>
	<parameter name="datefrom" class="java.util.Date" isForPrompting="false">
		<defaultValueExpression><![CDATA[(new SimpleDateFormat("yyyy")).format(new Date()).toString() + "-01-01"]]></defaultValueExpression>
	</parameter>
	<parameter name="dateto" class="java.util.Date">
		<defaultValueExpression><![CDATA[new Date()]]></defaultValueExpression>
	</parameter>
	<parameter name="as_of_date" class="java.util.Date"/>
	<parameter name="p_profit_center" class="java.util.Collection"/>
	<parameter name="p_commodity" class="java.util.Collection"/>
	<parameter name="s_profit_center" class="java.util.Collection"/>
	<parameter name="s_commodity" class="java.util.Collection"/>
	<parameter name="p_realized_type" class="java.lang.String">
		<defaultValueExpression><![CDATA["REALIZED"]]></defaultValueExpression>
	</parameter>
	<queryString>
		<![CDATA[SELECT 1 AS ID]]>
	</queryString>
	<field name="ID" class="java.lang.Integer"/>
	<variable name="currentpage" class="java.lang.Integer" resetType="Page" incrementType="Page">
		<initialValueExpression><![CDATA[$V{PAGE_NUMBER}]]></initialValueExpression>
	</variable>
	<background>
		<band splitType="Stretch"/>
	</background>
	<pageHeader>
		<band height="60">
			<staticText>
				<reportElement uuid="7158f2a8-06dc-46c0-a3e8-623f41feb29b" x="0" y="0" width="660" height="30" forecolor="#010101">
					<property name="local_mesure_unitx" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.x" value="px"/>
					<property name="local_mesure_unitwidth" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
				</reportElement>
				<box leftPadding="2" rightPadding="2"/>
				<textElement textAlignment="Left" verticalAlignment="Middle">
					<font size="13" isBold="true"/>
				</textElement>
				<text><![CDATA[Olam International Ltd]]></text>
			</staticText>
			<textField>
				<reportElement uuid="ddcb61df-50c4-4679-b183-541848e11e61" x="7310" y="30" width="360" height="30" isPrintWhenDetailOverflows="true" forecolor="#010101">
					<property name="com.jaspersoft.studio.unit.x" value="pixel"/>
				</reportElement>
				<box leftPadding="2" rightPadding="2"/>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font size="13" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA["Run Date : "+DATEFORMAT(TODAY( ),"dd-MMM-yy h:mm:ss a")]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="c485547f-42e9-45d0-a670-156a6f5382a6" x="0" y="30" width="660" height="30" forecolor="#010101"/>
				<box leftPadding="2" rightPadding="2"/>
				<textElement verticalAlignment="Middle">
					<font size="13" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA["Sales & Purchase Register Report Detail From "+DATEFORMAT($P{datefrom},"dd-MMM-yy")+" To "+DATEFORMAT($P{dateto},"dd-MMM-yy")]]></textFieldExpression>
			</textField>
		</band>
	</pageHeader>
	<detail>
		<band height="241" splitType="Stretch">
			<componentElement>
				<reportElement uuid="b9de0c76-24c6-4fe3-ac60-4bc39ade1aab" key="table 1" style="table 1" x="0" y="0" width="7020" height="97"/>
				<jr:table xmlns:jr="http://jasperreports.sourceforge.net/jasperreports/components" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports/components http://jasperreports.sourceforge.net/xsd/components.xsd">
					<datasetRun subDataset="SPR" uuid="f3c866a8-3baf-484c-89d3-392e8eedc072">
						<datasetParameter name="LE_Filter">
							<datasetParameterExpression><![CDATA[$P{LE_Filter}]]></datasetParameterExpression>
						</datasetParameter>
						<datasetParameter name="datefrom">
							<datasetParameterExpression><![CDATA[$P{datefrom}]]></datasetParameterExpression>
						</datasetParameter>
						<datasetParameter name="dateto">
							<datasetParameterExpression><![CDATA[$P{dateto}]]></datasetParameterExpression>
						</datasetParameter>
						<datasetParameter name="company">
							<datasetParameterExpression><![CDATA[$P{company}]]></datasetParameterExpression>
						</datasetParameter>
						<datasetParameter name="cbk">
							<datasetParameterExpression><![CDATA[$P{cbk}]]></datasetParameterExpression>
						</datasetParameter>
						<datasetParameter name="p_profit_center">
							<datasetParameterExpression><![CDATA[$P{p_profit_center}]]></datasetParameterExpression>
						</datasetParameter>
						<datasetParameter name="s_profit_center">
							<datasetParameterExpression><![CDATA[$P{s_profit_center}]]></datasetParameterExpression>
						</datasetParameter>
						<datasetParameter name="p_commodity">
							<datasetParameterExpression><![CDATA[$P{p_commodity}]]></datasetParameterExpression>
						</datasetParameter>
						<datasetParameter name="s_commodity">
							<datasetParameterExpression><![CDATA[$P{s_commodity}]]></datasetParameterExpression>
						</datasetParameter>
						<datasetParameter name="p_realized_type">
							<datasetParameterExpression><![CDATA[$P{p_realized_type}]]></datasetParameterExpression>
						</datasetParameter>
						<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
					</datasetRun>
					<jr:column width="90" uuid="bca1a7c4-499a-4c4f-82e5-94429fcb10d6">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column1"/>
						<jr:tableFooter height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="0e103fad-4fb2-4786-bc6e-1dc80b00f4b0" x="0" y="0" width="90" height="30" forecolor="#010101">
									<property name="com.jaspersoft.studio.unit.height" value="px"/>
								</reportElement>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Left" verticalAlignment="Middle">
									<font isBold="true" isItalic="false"/>
								</textElement>
								<text><![CDATA[Grand Total]]></text>
							</staticText>
						</jr:tableFooter>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1">
								<textField isStretchWithOverflow="true" isBlankWhenNull="true">
									<reportElement uuid="c64178fb-7e62-4e4a-92f3-36fe74739461" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
									<box leftPadding="4" rightPadding="4"/>
									<textElement verticalAlignment="Middle">
										<font isBold="true" isItalic="true"/>
									</textElement>
									<textFieldExpression><![CDATA[$F{PROFIT_CENTER} + " Total"]]></textFieldExpression>
								</textField>
							</jr:cell>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="6426cab3-86d7-4eaa-ae6c-f464d5768ce2" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Sales Contract Ref#]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" isBlankWhenNull="true">
								<reportElement uuid="d9b0c659-529f-49d1-ad01-d25675de488c" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{SALES CTR. REF#}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="7f668406-cfd8-4365-85cc-d74083888c61">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column2"/>
						<jr:tableFooter height="30" rowSpan="1"/>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1"/>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="eddeac6a-e596-48d5-8346-9c74e5622599" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Sales Company]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" isBlankWhenNull="true">
								<reportElement uuid="c90b11b6-0d4d-49c6-a824-93e3fe13d328" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{SALES COMPANY}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="120" uuid="4021c721-5a35-424e-9c7d-d575da2b6d30">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column3"/>
						<jr:tableFooter height="30" rowSpan="1"/>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1"/>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="b42ba7e5-c734-47dd-b487-5e5601708ab3" x="0" y="0" width="120" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Sales Profit Center]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" isBlankWhenNull="true">
								<reportElement uuid="6b617293-4781-4a4b-b4dc-c854ec20c312" stretchType="RelativeToBandHeight" x="0" y="0" width="120" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{SALES PROFIT CENTER}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="2b528e25-ca96-471d-bbff-f19c04635537">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column4"/>
						<jr:tableFooter height="30" rowSpan="1"/>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1"/>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="a0fb8eaf-b9e2-4062-9eb7-226b3a902440" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Sales Contract Book]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" isBlankWhenNull="true">
								<reportElement uuid="79fa52d7-e3de-4593-9610-146cad35c60a" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{SALES CONTRACT BOOK}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="aa4fcc29-3bc2-4249-b6d3-0a9eccdfe2bd">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column5"/>
						<jr:tableFooter height="30" rowSpan="1"/>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1"/>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="35781188-cfc5-4ca3-ab2c-3f9c42094fc4" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Sales Incoterm]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" isBlankWhenNull="true">
								<reportElement uuid="7bbb0121-34d1-48be-9ad3-4c234fdae6ed" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{SALES INCOTERM}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="e76d357d-f73e-45cd-9695-516e31eb8ad1">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column6"/>
						<jr:tableFooter height="30" rowSpan="1"/>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1"/>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="eaa43a69-0f7f-47fd-875f-da9d21075de0" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Sales Cost Center]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" isBlankWhenNull="true">
								<reportElement uuid="00c6683d-7355-4a76-a0cb-b88a6adf4cae" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{SALES COST CENTER}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="47b267e4-639a-4f8b-86e2-d4bb67a90b73">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column7"/>
						<jr:tableFooter height="30" rowSpan="1"/>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1"/>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="585c6ad0-c9aa-48b8-9aad-9cbfe6120428" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Sales Grade]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" isBlankWhenNull="true">
								<reportElement uuid="ca29af13-83ff-48cb-ae15-15858d3bd15f" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{SALES GRADE}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="4f30d115-33a9-4f95-af03-54f7484a5636">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column8"/>
						<jr:tableFooter height="30" rowSpan="1"/>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1"/>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="8e4c6893-881f-4aa4-9330-803ec8075ab8" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Sales Grade Description]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" isBlankWhenNull="true">
								<reportElement uuid="4760ec33-a4ef-4d09-8ed4-d5d70e3ffb9a" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{SALES GRADE DESC}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="010d2738-80bb-4ebc-832e-c7e22e40a603">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column9"/>
						<jr:tableFooter height="30" rowSpan="1"/>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1"/>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="f238176d-02a5-4231-bf39-9e00e4fe407a" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Sales Trader Name]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" isBlankWhenNull="true">
								<reportElement uuid="e7cdd081-474f-4a7d-8938-34ed631bf6af" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{SALES TRADER NAME}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="53e8dea3-4d9e-4fad-a832-e0362c41819f">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column10"/>
						<jr:tableFooter height="30" rowSpan="1"/>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1"/>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="4c4f7615-5658-4736-89d9-8b96a1ad1c7e" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Sales BL No]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" isBlankWhenNull="true">
								<reportElement uuid="b71aa9f6-9c93-4818-864b-cf824d6d834e" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{SALES BL NO}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="aa0cfa05-2fb0-4495-928c-2b1407a085d3">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column11"/>
						<jr:tableFooter height="30" rowSpan="1"/>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1"/>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="bfdfe0df-3a28-4290-b3df-2edfa9354e9f" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Sales Load Date]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" pattern="dd-MMM-yy" isBlankWhenNull="true">
								<reportElement uuid="3f0e1252-19e7-4345-8f5c-0b269b36dca9" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Right" verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{SALES LOAD DATE}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="100" uuid="179009b7-b474-47a5-b7c1-aea77c939b77">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column12"/>
						<jr:tableFooter height="30" rowSpan="1"/>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1"/>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="e3e3217b-0f4e-41bf-ab09-be0589e5e03d" x="0" y="0" width="100" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Sales Invoice No]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" isBlankWhenNull="true">
								<reportElement uuid="7f59f1c5-7749-42c7-a282-0741c7921ffc" stretchType="RelativeToBandHeight" x="0" y="0" width="100" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{SALES INVOICE}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="f276b12c-b612-47d0-b59c-2dbc31732acf">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column13"/>
						<jr:tableFooter height="30" rowSpan="1"/>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1"/>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="c97dfbe2-e6ba-404b-808b-695696284b1f" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Sales External Reference]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" isBlankWhenNull="true">
								<reportElement uuid="c980c3b6-e1a7-4bf6-b216-ad21429b84b0" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{SALES EXTERNAL REFERENCE}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="fc7c3658-e6f0-4bd4-bbc6-d3d0b8889c8d">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column14"/>
						<jr:tableFooter height="30" rowSpan="1"/>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1"/>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="62bc2694-31dd-42f2-b168-cd84e0b94e1c" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Invoice Doc. Date]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" pattern="dd-MMM-yy" isBlankWhenNull="true">
								<reportElement uuid="99962f74-2a47-48e0-b5c5-34ab075eb45e" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Right" verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{INVOICE DOC DATE}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="9ec842f3-de79-4ece-862c-6d1a27702181">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column15"/>
						<jr:tableFooter height="30" rowSpan="1"/>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1"/>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="8f004699-d49f-4de1-8c27-1804870d5308" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Invoice Due Date]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" pattern="dd-MMM-yy" isBlankWhenNull="true">
								<reportElement uuid="6e793d29-dba0-40b5-ac41-b8e98acfa044" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Right" verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{INVOICE DUE DATE}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="fd5fe6e7-50cb-4898-9630-71c65d6ad022">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column16"/>
						<jr:tableFooter height="30" rowSpan="1"/>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1"/>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="ecef68f1-141c-4133-88fe-b89ddea4a1ff" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Invoice Apply Date]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" pattern="dd-MMM-yy" isBlankWhenNull="true">
								<reportElement uuid="178947be-35ea-47c9-a092-655a0fa3f5a5" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Right" verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{INVOICE APPLY DATE}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="eaf6ff5c-5a1c-4a00-861b-7f0a1e4dc48e">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column17"/>
						<jr:tableFooter height="30" rowSpan="1"/>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1"/>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="5a5be925-f1bf-4bf9-8106-7085e5e4556a" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Sales Commodity]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" isBlankWhenNull="true">
								<reportElement uuid="9ef52445-41d2-45f5-8b0d-71f49892f747" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{SALES COMMODITY}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="61d5249a-1683-4f81-9cf6-3d2974a3967b">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column18"/>
						<jr:tableFooter height="30" rowSpan="1"/>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1"/>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="e31319cb-66d0-4705-8a48-a9805d7fdc58" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Sales Contract Counterparty]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" isBlankWhenNull="true">
								<reportElement uuid="ad703d27-9615-4433-aa53-88f6f5e0ed4e" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{SALES CONTRACTUAL COUNTERPARTY}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="8685445d-0776-4462-90fe-b41082839873">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column19"/>
						<jr:tableFooter height="30" rowSpan="1"/>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1"/>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="2c8f319a-94fd-4f0e-9584-fc469e8f6b1e" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Sales Counterparty]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" isBlankWhenNull="true">
								<reportElement uuid="8238420a-f877-4ab3-8425-b80ccf301730" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{SALES COUNTERPARTY}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="74b1f8f1-5498-4224-841c-22122c7d2fa7">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column20"/>
						<jr:tableFooter height="30" rowSpan="1"/>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1"/>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="b98fecb3-c4db-4d49-bef1-d800eee7db63" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Int / Ext Counterparty]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" isBlankWhenNull="true">
								<reportElement uuid="953f9268-73a5-4371-b2d0-9ec82c7ebc81" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{INTERNAL/EXTERNAL COUNTERPARTY}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="06c0c671-1976-497d-9a75-bd19dfaee4e3">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column21"/>
						<jr:tableFooter height="30" rowSpan="1"/>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1"/>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="ffec2c0f-6d8f-4124-8f72-3d8af723ef2a" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Sales CP Category]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" isBlankWhenNull="true">
								<reportElement uuid="c6271cd8-b973-46ac-a1d8-ee11c081b23f" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{SALES COUNTERPARTY CATEGORY}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="c73ca062-8b1d-43a4-96d3-bdf42f5f27e1">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column22"/>
						<jr:tableFooter height="30" rowSpan="1"/>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1"/>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="6378b1b3-e8b2-4373-9cec-37158b303c31" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Customer Country]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" isBlankWhenNull="true">
								<reportElement uuid="80940659-2011-488e-82ea-c5987317e836" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{CUSTOMER COUNTRY}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="1b68fc02-3298-4ecb-9767-46b10bc0d474">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column23"/>
						<jr:tableFooter height="30" rowSpan="1"/>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1"/>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="3b36f35d-9d39-4ea5-b0be-d7e22091b761" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Sales Doc. Type]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" isBlankWhenNull="true">
								<reportElement uuid="be5d9b48-5226-42f4-97ed-bed5d113a9e4" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{SALES DOC. TYPE}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="a43ba176-8ba5-418c-8219-3f4db9595012">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column24"/>
						<jr:tableFooter height="30" rowSpan="1"/>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1"/>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="a057464e-306d-4960-bb3b-28e60771eabb" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Sales Doc. Cause]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" isBlankWhenNull="true">
								<reportElement uuid="9cd93cd1-ca71-4500-bfea-c302e5ece653" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{SALES DOC. CAUSE}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="b0fe033c-4bf6-4a24-b735-8dfe8b829cec">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column25"/>
						<jr:tableFooter height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" pattern="#,##0.000" isBlankWhenNull="true">
								<reportElement uuid="ff60c54f-f8d0-4386-a34e-359148a1f297" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Right" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<textFieldExpression><![CDATA[$V{GT_SALES_VALUE_COMP_CURR}]]></textFieldExpression>
							</textField>
						</jr:tableFooter>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1">
								<textField isStretchWithOverflow="true" pattern="#,##0.000" isBlankWhenNull="true">
									<reportElement uuid="f634520a-78b0-4fd3-9d11-4603e82bff57" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
									<box leftPadding="4" rightPadding="4"/>
									<textElement textAlignment="Right" verticalAlignment="Middle">
										<font isBold="true" isItalic="true"/>
									</textElement>
									<textFieldExpression><![CDATA[$V{ST_SALES_VALUE_COMP_CURR}]]></textFieldExpression>
								</textField>
							</jr:cell>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="8ab04a03-cd26-40e7-abd0-2a951db4be35" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Sales Value in Company  Curr]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" pattern="#,##0.000" isBlankWhenNull="true">
								<reportElement uuid="0106f98e-51a2-4301-970c-2d39c3eeb096" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Right" verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{SALES VALUE IN COMPANY CURRENCY}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="cc2b08e0-b513-415f-822b-4def36016905">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column26"/>
						<jr:tableFooter height="30" rowSpan="1"/>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1"/>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="ebf55f4b-7da8-4883-a476-489177c9d3c6" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Sales Company Currency]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" isBlankWhenNull="true">
								<reportElement uuid="0d921e46-fe8d-4ace-b458-6ce0800b96f5" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{SALES COMPANY CURRENCY}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="07a5aab8-95f3-432c-8a84-65c7fe482916">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column27"/>
						<jr:tableFooter height="30" rowSpan="1"/>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1"/>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="e58a279d-703a-4ff7-99fb-8cb48a4c1464" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Sales Unit Price (USD/MT)]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" pattern="#,##0.000" isBlankWhenNull="true">
								<reportElement uuid="4f114a90-96a6-4d7c-9d03-6335d04067b8" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Right" verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{SALES UNIT PRICE IN USD/MT}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="c3a0bacf-70e1-4a7b-88db-adbbf058511a">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column28"/>
						<jr:tableFooter height="30" rowSpan="1"/>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1"/>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="4526afe3-e9d4-488d-96c4-50dda24d5fa1" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Sales Value]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" pattern="#,##0.000" isBlankWhenNull="true">
								<reportElement uuid="1185bd90-4ab6-4395-b68b-9b635ca6f545" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Right" verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{SALES VALUE}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="91c4f21a-c52e-4287-8f03-10362112f697">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column29"/>
						<jr:tableFooter height="30" rowSpan="1"/>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1"/>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="d2daa3c6-f103-4bb7-86ba-9989e20a4aac" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Invoice Currency]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" isBlankWhenNull="true">
								<reportElement uuid="d53ed56e-1037-478e-b9f0-2f28a561a008" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{INVOICE CURRENCY}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="644455cd-ef53-47cc-ae12-c2c785983733">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column30"/>
						<jr:tableFooter height="30" rowSpan="1"/>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1"/>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="6c1ff2f1-b549-4e72-9f1f-191229ae91e1" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Sales Unit Price]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" pattern="#,##0.000" isBlankWhenNull="true">
								<reportElement uuid="20b835ff-3149-48ca-b0ec-8baa999ec627" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Right" verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{SALES UNIT PRICE}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="84e25010-2bca-49d2-b1c5-a1e9f9cbf680">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column31"/>
						<jr:tableFooter height="30" rowSpan="1"/>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1"/>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="8015af33-3c09-4de0-be01-cbdb493f6ef8" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Sales UOM]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" isBlankWhenNull="true">
								<reportElement uuid="1c933106-b76e-41b2-ab67-33cc4315ac38" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{SALES UOM}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="d3910711-6b2b-4f85-aba1-fb246f8f8159">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column32"/>
						<jr:tableFooter height="30" rowSpan="1"/>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1"/>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="b4c88c65-1cc3-4e8f-9c69-cc5bd0858c67" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Sales FX Rate]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" pattern="#,##0.000" isBlankWhenNull="true">
								<reportElement uuid="a70452dc-f3c9-42a6-a627-07678162f256" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Right" verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{SALES FX RATE}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="996e4b16-0cf2-4ee2-a3f8-c3fa58665f5f">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column33"/>
						<jr:tableFooter height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" pattern="#,##0.000" isBlankWhenNull="true">
								<reportElement uuid="c95b4b1f-449d-4478-a716-aa0e8bc068dd" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Right" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<textFieldExpression><![CDATA[$V{GT_SALES_DISCHARGE_QTY}]]></textFieldExpression>
							</textField>
						</jr:tableFooter>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1">
								<textField isStretchWithOverflow="true" pattern="#,##0.000" isBlankWhenNull="true">
									<reportElement uuid="8357854b-4d12-461a-8d47-7e6b487db1ff" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
									<box leftPadding="4" rightPadding="4"/>
									<textElement textAlignment="Right" verticalAlignment="Middle">
										<font isBold="true" isItalic="true"/>
									</textElement>
									<textFieldExpression><![CDATA[$V{ST_SALES_DISCHARGE_QTY}]]></textFieldExpression>
								</textField>
							</jr:cell>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="0d86af10-ccbf-4b4a-af64-efd8013e0e6f" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Sales Discharge Quantity]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" pattern="#,##0.000" isBlankWhenNull="true">
								<reportElement uuid="7e72578e-259c-4082-b87b-519ecbedf46f" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Right" verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{SALES DISCHARGE QUANTITY}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="3a230e91-ab5e-4e34-9db0-e59e90f95ff2">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column34"/>
						<jr:tableFooter height="30" rowSpan="1"/>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1"/>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="139ef599-9f6a-4438-bfce-6c595baee67e" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Sales Prov.
Quantity]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" pattern="#,##0.000" isBlankWhenNull="true">
								<reportElement uuid="cb422f22-f3c8-47b8-8dd1-47b6b2ba5156" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Right" verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{SALES PROVISIONAL QTY}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="597729f5-80fd-41bf-9c7f-572b77e0e7dd">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column35"/>
						<jr:tableFooter height="30" rowSpan="1"/>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1"/>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="01310aca-2739-4995-bc05-adb6fb30497f" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Sales Fixed Quantity]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" pattern="#,##0.000" isBlankWhenNull="true">
								<reportElement uuid="99b6c368-8eef-448c-80bf-a99ece702193" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Right" verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{SALES FIXED QTY}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="b301e7ba-1456-49fd-8b26-40bcc305f78b">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column36"/>
						<jr:tableFooter height="30" rowSpan="1"/>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1"/>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="96c32ab3-637b-4801-96fa-8e83d0209e21" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Sales Balance To Fix]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" pattern="#,##0.000" isBlankWhenNull="true">
								<reportElement uuid="694066f2-d031-4cae-b806-4b11d803f3e8" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Right" verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{SALES BALANCE TO FIX}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="314a09ef-b1d2-4789-aee7-de3c58b831e4">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column37"/>
						<jr:tableFooter height="30" rowSpan="1"/>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1"/>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="89b111e7-e6a2-4d1b-b2b3-f3897b7afe71" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Sales Fixed Price]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" pattern="#,##0.000" isBlankWhenNull="true">
								<reportElement uuid="5f614e0a-0ba8-4451-85ae-f416ccd5e1f8" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Right" verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{SALES FIXED PRICE}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="60d71c53-ae65-4cd2-be27-8c657d528286">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column38"/>
						<jr:tableFooter height="30" rowSpan="1"/>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1"/>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="087217d9-a4b8-4630-90ee-da844d56a5b2" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Sales Transport / Trip No]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" isBlankWhenNull="true">
								<reportElement uuid="34ac42b2-0828-48e3-a99e-d21ae9ccdac8" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{SALES TRANSPORT / TRIP NO}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="3af453a1-1ed1-40c9-8a65-a4c9eab0e163">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column39"/>
						<jr:tableFooter height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" pattern="#,##0.000" isBlankWhenNull="true">
								<reportElement uuid="12922a07-2282-4110-a8b5-19990dd4bcb7" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Right" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<textFieldExpression><![CDATA[$V{GT_SALES_REALIZED_QTY}]]></textFieldExpression>
							</textField>
						</jr:tableFooter>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1">
								<textField isStretchWithOverflow="true" pattern="#,##0.000" isBlankWhenNull="true">
									<reportElement uuid="18d1f90a-8616-4848-b986-795e28890d60" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
									<box leftPadding="4" rightPadding="4"/>
									<textElement textAlignment="Right" verticalAlignment="Middle">
										<font isBold="true" isItalic="true"/>
									</textElement>
									<textFieldExpression><![CDATA[$V{ST_SALES_REALIZED_QTY}]]></textFieldExpression>
								</textField>
							</jr:cell>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="722cc4c8-ea62-421b-8215-d6f264674f7e" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Sales Realized Quantity]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" pattern="#,##0.000" isBlankWhenNull="true">
								<reportElement uuid="6aeead9c-533a-4dce-9d5c-547cbd65e063" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Right" verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{SALES REALIZED QTY}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="2f09f6ea-7b13-476b-a9c9-5e72060f77af">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column40"/>
						<jr:tableFooter height="30" rowSpan="1"/>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1"/>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="931c61d8-bbb1-4f9d-a914-fe816c70d9bf" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Invoice Post Date]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" pattern="dd-MMM-yy" isBlankWhenNull="true">
								<reportElement uuid="b0b2e05b-d9a0-4213-8c85-92bd2cb14910" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Right" verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{INVOICE POST DATE}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="306c77a8-2b05-43bc-b21f-c22acdf3f778">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column41"/>
						<jr:tableFooter height="30" rowSpan="1"/>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1"/>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="5e2dd0dc-ea1a-42f3-9401-ae90e9b9d9ee" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Invoice Status]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" isBlankWhenNull="true">
								<reportElement uuid="d1eadfc4-dd3a-420d-9338-c6dd7c9392be" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{INVOICE STATUS}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="c8fe5f0d-091d-4a7c-80e8-ff42e68357f4">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column42"/>
						<jr:tableFooter height="30" rowSpan="1"/>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1"/>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="01de435d-c202-4878-9ca4-72a597ba1aa1" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Purchase Ctr. Ref#]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" isBlankWhenNull="true">
								<reportElement uuid="1db1df53-2c99-448f-8eaa-038b3cd6eaaf" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{PURCHASE CTR. REF#}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="120" uuid="d2c717e4-19c4-4dab-948c-ef7265caae52">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column43"/>
						<jr:tableFooter height="30" rowSpan="1"/>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1"/>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="5f9b2689-fb70-4043-8e60-043e02817db3" x="0" y="0" width="120" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Purchase Profit Center]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" isBlankWhenNull="true">
								<reportElement uuid="3652757a-b688-42a4-88ec-a59272db222f" stretchType="RelativeToBandHeight" x="0" y="0" width="120" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{PURCHASE PROFIT CENTER}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="014869df-0852-4086-8506-52ef7d76f5e5">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column44"/>
						<jr:tableFooter height="30" rowSpan="1"/>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1"/>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="b3f06c94-37de-45ca-b440-c64f3de70979" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Purchase Contract Book]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" isBlankWhenNull="true">
								<reportElement uuid="98a60e13-cf6d-43e4-9b6a-61181f0fc2d7" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{PURCHASE CONTRACT BOOK}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="03b5fb9e-34c1-4013-b175-578ad3b0f8cb">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column45"/>
						<jr:tableFooter height="30" rowSpan="1"/>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1"/>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="3f352c32-125d-44e4-b2ed-545fa53dde67" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Purchase BL No]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" isBlankWhenNull="true">
								<reportElement uuid="3964ec33-ecf3-4871-a937-ec6afe69d36e" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{PURCHASE BL NO}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="100" uuid="6d794def-7bb7-4876-b9ee-e6fd782f2123">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column46"/>
						<jr:tableFooter height="30" rowSpan="1"/>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1"/>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="751ed994-4cbd-4eff-8973-3fac28f95453" x="0" y="0" width="100" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Purchase Voucher]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" isBlankWhenNull="true">
								<reportElement uuid="ed19cf64-6a03-4eb8-8007-299228c2a83e" stretchType="RelativeToBandHeight" x="0" y="0" width="100" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{PURCHASE VOUCHER}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="eef20071-9f4b-4efe-879d-81403b31bf63">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column47"/>
						<jr:tableFooter height="30" rowSpan="1"/>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1"/>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="9203e2e6-cc89-4cbd-bf60-3ba7fd6c62b6" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Voucher Post Date]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" pattern="dd-MMM-yy" isBlankWhenNull="true">
								<reportElement uuid="24a09488-ebdc-4a56-a88f-21cbee29d850" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Right" verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{VOUCHER POST DATE}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="5eae7801-af43-4f7b-80f7-0c67d635274a">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column48"/>
						<jr:tableFooter height="30" rowSpan="1"/>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1"/>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="7023ad6d-719f-4234-86f8-b2210c1b2b60" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Voucher Doc Date]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" pattern="dd-MMM-yy" isBlankWhenNull="true">
								<reportElement uuid="a20cb0d0-5c8a-4ba6-88d5-968b600475f5" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Right" verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{VOUCHER DOC DATE}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="b73faef0-cd35-4b49-aa3a-92fdd0281a8f">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column49"/>
						<jr:tableFooter height="30" rowSpan="1"/>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1"/>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="40f980d0-1aba-45e4-b54d-2f782c5c5664" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Voucher Due Date]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" pattern="dd-MMM-yy" isBlankWhenNull="true">
								<reportElement uuid="0f52157b-823c-42be-9e7b-004b63aa9297" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Right" verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{VOUCHER DUE DATE}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="a3136a45-b190-47e6-ad1f-7acea1e1ecae">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column50"/>
						<jr:tableFooter height="30" rowSpan="1"/>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1"/>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="5cc156b5-f55e-447c-8fa1-01fd90b34f77" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Voucher Apply Date]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" pattern="dd-MMM-yy" isBlankWhenNull="true">
								<reportElement uuid="d4ab1973-ecad-4500-8f49-d12c1a681c2e" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Right" verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{VOUCHER APPLY DATE}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="a1770513-b8fe-409a-a9f3-fdfad4126fcd">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column51"/>
						<jr:tableFooter height="30" rowSpan="1"/>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1"/>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="4ed59e71-44ce-40c4-9738-748fb90c4e9f" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Purchase Commodity]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" isBlankWhenNull="true">
								<reportElement uuid="c5ecea80-753c-47ab-9f59-dd91ac6ab1f6" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{PURCHASE COMMODITY}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="fc76ff1a-1cd4-4cea-b517-77bbb366f3e8">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column52"/>
						<jr:tableFooter height="30" rowSpan="1"/>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1"/>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="a078d42d-0d04-4933-9bae-dcaaebdf30cd" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Purchase Counterparty]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" isBlankWhenNull="true">
								<reportElement uuid="afc7e748-6de3-4a38-881b-2bab0e69e314" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{PURCHASE COUNTERPARTY}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="66bb3343-4b3f-490d-a45b-cbaf96ec5deb">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column53"/>
						<jr:tableFooter height="30" rowSpan="1"/>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1"/>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="2a91186e-3a80-4253-ba1b-89d1d254c23b" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Purchase CP
Category]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" isBlankWhenNull="true">
								<reportElement uuid="cf40d62e-0216-436e-bfd0-555f4a183097" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{PURCHASE COUNTERPARTY CATEGORY}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="1d168804-82c0-4554-9b24-5b5b6033b355">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column54"/>
						<jr:tableFooter height="30" rowSpan="1"/>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1"/>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="7a187f3d-70aa-4916-908a-800ac8971e36" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Supplier Country]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" isBlankWhenNull="true">
								<reportElement uuid="5d528ffe-ea02-4a4e-9a81-eec06a4eb602" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{SUPPLIER COUNTRY}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="7e82d3ff-b945-449b-baa7-ce96ec5cffac">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column55"/>
						<jr:tableFooter height="30" rowSpan="1"/>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1"/>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="1e915b5b-2776-477b-a293-407d47ec75c4" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Allocation Type]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" isBlankWhenNull="true">
								<reportElement uuid="b006509d-8b6c-4e70-8847-7b3ccbcd67bd" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{ALOCATION TYPE}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="100" uuid="211835a5-b859-4e35-bed4-389858ba0b9c">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column56"/>
						<jr:tableFooter height="30" rowSpan="1"/>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1"/>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="9d5f61b7-24e8-4e56-bd88-322db5a862d1" x="0" y="0" width="100" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Allocation Ref#]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" isBlankWhenNull="true">
								<reportElement uuid="be72e239-0395-40dd-a035-f0c1e27186db" stretchType="RelativeToBandHeight" x="0" y="0" width="100" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{ALLOCATION REF#}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="bdabe2ef-e2ca-4419-909d-051c20feea70">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column57"/>
						<jr:tableFooter height="30" rowSpan="1"/>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1"/>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="65907c4c-123a-434a-8260-cc6097619587" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Pur. Doc. Type]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" isBlankWhenNull="true">
								<reportElement uuid="2595fe07-a361-4b1c-b5ef-a96b2148b954" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{PUR. DOC. TYPE}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="81089d1d-2618-422c-a747-cca873a3049d">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column58"/>
						<jr:tableFooter height="30" rowSpan="1"/>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1"/>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="45d158e2-8233-4577-9c07-c74f1a8f3426" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Pur. Doc. Cause]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" isBlankWhenNull="true">
								<reportElement uuid="c1575b3c-4ef3-4dfb-89b8-67d9205f14aa" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{PUR. DOC. CAUSE}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="54a0726b-6a78-4a29-a7aa-4991d617dcd8">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column59"/>
						<jr:tableFooter height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" pattern="#,##0.000" isBlankWhenNull="true">
								<reportElement uuid="a2c62852-0ecf-4373-b73f-869bf37a0bf1" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Right" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<textFieldExpression><![CDATA[$V{GT_PURCHASE_QUANTITY}]]></textFieldExpression>
							</textField>
						</jr:tableFooter>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1">
								<textField isStretchWithOverflow="true" pattern="#,##0.000" isBlankWhenNull="true">
									<reportElement uuid="50a5792f-5d22-4b86-9637-d078b904f417" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
									<box leftPadding="4" rightPadding="4"/>
									<textElement textAlignment="Right" verticalAlignment="Middle">
										<font isBold="true" isItalic="true"/>
									</textElement>
									<textFieldExpression><![CDATA[$V{ST_PURCHASE_QUANTITY}]]></textFieldExpression>
								</textField>
							</jr:cell>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="3a89c169-3408-4345-a007-45d018036a1f" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Quantity]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" pattern="#,##0.000" isBlankWhenNull="true">
								<reportElement uuid="de44298f-297f-4aba-bffc-c2a310b3a1dc" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Right" verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{QUANTITY}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="b4693cf0-1dca-45ba-938a-1ce6a04dffd6">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column60"/>
						<jr:tableFooter height="30" rowSpan="1"/>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1"/>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="00dfbbfc-2405-4dff-82bc-819410af4f8d" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Stock Adjusted Quantity]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30">
							<textField isStretchWithOverflow="true" pattern="#,##0.000" isBlankWhenNull="true">
								<reportElement uuid="a9b03f4c-d4db-4dac-8c70-c967bdec0871" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Right" verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{STOCK ADJUSTED QTY}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="100" uuid="ebffb656-6b13-4350-892c-14641b8be66f">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column61"/>
						<jr:tableFooter height="30" rowSpan="1"/>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1"/>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="b918a9c8-e2df-434f-a1c5-67e546835a3e" x="0" y="0" width="100" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Original Pur Value in Comp Curr]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30">
							<textField isStretchWithOverflow="true" pattern="#,##0.000" isBlankWhenNull="true">
								<reportElement uuid="a8eaef40-5f2d-47b3-be54-6b2e22fcb4ec" stretchType="RelativeToBandHeight" x="0" y="0" width="100" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Right" verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{ORIGINAL PURCHASE VALUE IN COMPANY CURR}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="100" uuid="572e6a39-a561-44af-b8aa-97124ce44679">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column62"/>
						<jr:tableFooter height="30" rowSpan="1"/>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1"/>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="2094a392-ef71-4a38-acdc-b7b28b9efe4e" x="0" y="0" width="100" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Stock Adj. Value in Comp Curr]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" pattern="#,##0.000" isBlankWhenNull="true">
								<reportElement uuid="ffb55ca1-d079-472b-83cf-958528f7ae89" stretchType="RelativeToBandHeight" x="0" y="0" width="100" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Right" verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{STOCK ADJUSTMENT VALUE IN COMPANY CURR}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="1c4b063f-5dd8-4cc6-a199-fb67bee550c0">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column63"/>
						<jr:tableFooter height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" pattern="#,##0.000" isBlankWhenNull="true">
								<reportElement uuid="b1db31af-916e-430c-a3dc-e689ada711e2" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Right" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<textFieldExpression><![CDATA[$V{GT_PURCHASE_VALUE_COMP_CURR}]]></textFieldExpression>
							</textField>
						</jr:tableFooter>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1">
								<textField isStretchWithOverflow="true" pattern="#,##0.000" isBlankWhenNull="true">
									<reportElement uuid="7c852d74-94e4-44d5-91bf-84f04b50cf87" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" isRemoveLineWhenBlank="true" forecolor="#010101"/>
									<box leftPadding="4" rightPadding="4"/>
									<textElement textAlignment="Right" verticalAlignment="Middle">
										<font isBold="true" isItalic="true"/>
									</textElement>
									<textFieldExpression><![CDATA[$V{ST_PURCHASE_VALUE_COMP_CURR}]]></textFieldExpression>
								</textField>
							</jr:cell>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="755bc7f4-dbbc-497f-86ca-51c39cf8f590" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Pur. Value in Company Curr]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" pattern="#,##0.000" isBlankWhenNull="true">
								<reportElement uuid="fda6d12f-3465-43e6-8b9f-cafa190d026a" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Right" verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{PURCHASE VALUE IN COMPANY CURR}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="75f11dd2-a768-4df0-9d9d-2fda1cd30b32">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column64"/>
						<jr:tableFooter height="30" rowSpan="1"/>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1"/>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="c2078e1a-0eb9-436b-8593-ea4fbff1d2d0" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Pur. Company Currency]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" isBlankWhenNull="true">
								<reportElement uuid="16e82a79-f927-42b1-8e33-c9eae0ccc7fe" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{PURCHASE COMPANY CURRENCY}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="89c91090-cb30-4b83-91b1-6501207f061c">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column65"/>
						<jr:tableFooter height="30" rowSpan="1"/>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1"/>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="30d9801e-b1e9-493a-a301-30b7975c2024" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Pur. Unit Price (USD/MT)]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" pattern="#,##0.000" isBlankWhenNull="true">
								<reportElement uuid="18f74377-a5d7-4aa7-a59a-54cbc0b467ef" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Right" verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{PURCHASE UNIT PRICE IN USD/MT}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="ce2e1951-4b11-4c40-9258-01d81b4975e6">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column66"/>
						<jr:tableFooter height="30" rowSpan="1"/>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1"/>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="b52ecb4e-d538-4096-bf4c-5cea48bc0143" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Original Purchase Value]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30">
							<textField isStretchWithOverflow="true" pattern="#,##0.000" isBlankWhenNull="true">
								<reportElement uuid="8c28f675-e24f-4a24-84d2-1223a870c352" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Right" verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{ORIGINAL PURCHASE VALUE}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="ae2ef036-130c-49f8-b01b-e43a202bc1bc">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column67"/>
						<jr:tableFooter height="30" rowSpan="1"/>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1"/>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="65e2b985-5cb3-4ae4-8c95-05134df8112c" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Stock Adjusted Value]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30">
							<textField isStretchWithOverflow="true" pattern="#,##0.000" isBlankWhenNull="true">
								<reportElement uuid="56244dd3-22d4-4472-b027-b64826a69a31" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Right" verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{STOCK ADJUSTMENT VALUE}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="2e6c6a42-a4ad-4af5-a59f-75dfc86c7c56">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column68"/>
						<jr:tableFooter height="30" rowSpan="1"/>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1"/>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="94ee24a7-ae01-4210-bb74-b19c9e21538e" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Purchase Value]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" pattern="#,##0.000" isBlankWhenNull="true">
								<reportElement uuid="8ce7651e-c622-4b1d-ad2d-e062b002b27d" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Right" verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{PURCHASE VALUE}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="d49bba24-2aa3-4163-988a-3772e097e7f2">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column69"/>
						<jr:tableFooter height="30" rowSpan="1"/>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1"/>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="b6405027-2549-4466-89b8-4fbd4426c298" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Voucher Currency]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" isBlankWhenNull="true">
								<reportElement uuid="6a923125-6a23-47df-aac2-0a2945f17355" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{VOUCHER CURRENCY}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="b0103ef5-b839-47f5-9f5b-285975383974">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column70"/>
						<jr:tableFooter height="30" rowSpan="1"/>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1"/>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="11144bd8-950b-43ad-b676-682d5740b70e" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Purchase Unit Price]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" pattern="#,##0.000" isBlankWhenNull="true">
								<reportElement uuid="c4c519c3-f6fc-4e5e-800c-e16e411db641" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Right" verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{PURCHASE UNIT PRICE}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="8e53746b-1b07-48f5-8f55-c7c8b6a5f89b">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column71"/>
						<jr:tableFooter height="30" rowSpan="1"/>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1"/>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="a1c3e957-8655-4912-9a65-48ca316ae777" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Purch. Original Unit Price]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" pattern="#,##0.000" isBlankWhenNull="true">
								<reportElement uuid="edecf2dc-07a9-45d6-88ad-97b25a8adf61" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Right" verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{PURCHASE ORIGINAL UNIT PRICE}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="96132e27-c104-4205-b54a-228f7b427bfd">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column72"/>
						<jr:tableFooter height="30" rowSpan="1"/>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1"/>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="574cb8a2-8b57-4fda-ab24-c267b688d0c8" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Purchase FX Rate]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" pattern="#,##0.000" isBlankWhenNull="true">
								<reportElement uuid="0e5b653f-aa6f-46de-ab7b-bb8a0866f3fe" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Right" verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{PURCHASE FX RATE}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="c4e09c57-0300-4f1c-98d3-d10bec5b17c9">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column73"/>
						<jr:tableFooter height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" pattern="#,##0.000" isBlankWhenNull="true">
								<reportElement uuid="fc3f4274-ff10-426b-b191-a0c8cd99cb89" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Right" verticalAlignment="Middle">
									<font isBold="true" isItalic="false"/>
								</textElement>
								<textFieldExpression><![CDATA[$V{GT_PURCHASE_DISCHARGE_QTY}]]></textFieldExpression>
							</textField>
						</jr:tableFooter>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1">
								<textField isStretchWithOverflow="true" pattern="#,##0.000" isBlankWhenNull="true">
									<reportElement uuid="5ac686ac-6699-45ae-9604-1d4c3168e693" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
									<box leftPadding="4" rightPadding="4"/>
									<textElement textAlignment="Right" verticalAlignment="Middle">
										<font isBold="true" isItalic="true"/>
									</textElement>
									<textFieldExpression><![CDATA[$V{ST_PURCHASE_DISCHARGE_QTY}]]></textFieldExpression>
								</textField>
							</jr:cell>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="13d1603b-445d-4dd0-8e7a-25dc7321ce8d" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Pur. Discharge Quantity]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" pattern="#,##0.000" isBlankWhenNull="true">
								<reportElement uuid="b4f7a574-69b3-4daa-82b5-fd08a53318a4" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Right" verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{PURCHASE DISCHARGE QUANTITY}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="7eef4d8d-3f6b-4f2e-9ddd-9cd5479cd52f">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column74"/>
						<jr:tableFooter height="30" rowSpan="1"/>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1"/>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="186d721f-61ca-495c-ad7f-805892318a0d" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Pur. Provisional Quantity]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" pattern="#,##0.000" isBlankWhenNull="true">
								<reportElement uuid="60272a01-8993-4e94-a0c5-0f95ad4950f8" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Right" verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{PURCHASE PROVISIONAL QTY}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="3bccb36d-3bfd-4fc3-b177-1de6ae922391">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column75"/>
						<jr:tableFooter height="30" rowSpan="1"/>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1"/>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="f0fd342e-183f-48ee-a0b5-82525e93d84d" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Purchase Fixed Quantity]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" pattern="#,##0.000" isBlankWhenNull="true">
								<reportElement uuid="c5995413-55b8-42fa-b7a5-04f880a36da6" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Right" verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{PURCHASE FIXED QTY}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="8fc9fd53-1095-44b9-9c5d-3e4951e3856d">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column76"/>
						<jr:tableFooter height="30" rowSpan="1"/>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1"/>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="b0092d76-114e-4e12-b14f-59b5548be27a" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Purchase Balance To Fix]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" pattern="#,##0.000" isBlankWhenNull="true">
								<reportElement uuid="abb948cc-e36f-4ba7-9311-b40a48704b2e" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Right" verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{PURCHASE BALANCE TO FIX}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="d90515c5-d762-4407-b697-bbe762993292">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column77"/>
						<jr:tableFooter height="30" rowSpan="1"/>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1"/>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="e79c502d-6178-45ff-acf3-9910624202cd" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Purchase Fixed Price]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" pattern="#,##0.000" isBlankWhenNull="true">
								<reportElement uuid="a3551f6b-fd17-495a-9b98-0a65d10c4851" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Right" verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{PURCHASE FIXED PRICE}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="c386687d-d12c-49ae-b30e-e490bad59e43">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column78"/>
						<jr:tableFooter height="30" rowSpan="1"/>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1"/>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="cf9b0c3f-9136-4fbd-8105-69727b41b23b" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Pur. Transport / Trip No]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" isBlankWhenNull="true">
								<reportElement uuid="e6007dd2-3e4b-4b2b-a93c-5e896ce5c9f0" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{PURCHASE TRANSPORT / TRIP NO}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="592c292d-5eec-4e70-8a52-c7292ecc73a8">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column79"/>
						<jr:tableFooter height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" pattern="#,##0.000" isBlankWhenNull="true">
								<reportElement uuid="76d5c147-1b10-4389-886b-ff1907f75e73" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Right" verticalAlignment="Middle">
									<font isBold="true" isItalic="false"/>
								</textElement>
								<textFieldExpression><![CDATA[$V{GT_PURCHASE_REALIZED_QTY}]]></textFieldExpression>
							</textField>
						</jr:tableFooter>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1">
								<textField isStretchWithOverflow="true" pattern="#,##0.000" isBlankWhenNull="true">
									<reportElement uuid="14343352-d75d-4150-819f-3657f22de8c6" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
									<box leftPadding="4" rightPadding="4"/>
									<textElement textAlignment="Right" verticalAlignment="Middle">
										<font isBold="true" isItalic="true"/>
									</textElement>
									<textFieldExpression><![CDATA[$V{ST_PURCHASE_REALIZED_QTY}]]></textFieldExpression>
								</textField>
							</jr:cell>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="7265689e-d11d-4091-ad6d-a5968ebc58af" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Pur. Realized Quantity]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" pattern="#,##0.000" isBlankWhenNull="true">
								<reportElement uuid="974a8a9a-0416-419b-a389-7d7a5f1b7dcd" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Right" verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{PURCHASE REALIZED QTY}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="efc97e5f-a330-4079-a656-e50893c67c15">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column80"/>
						<jr:tableFooter height="30" rowSpan="1"/>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1"/>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="6683b968-b38d-4119-a912-4d611519e49a" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Voucher Status]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" isBlankWhenNull="true">
								<reportElement uuid="7fdfc712-f9c4-4b21-97d7-469e620a763c" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{VOUCHER STATUS}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="6758681c-8699-48ca-a081-4a41fe0cb58e">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column81"/>
						<jr:tableFooter height="30" rowSpan="1"/>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1"/>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="a836873a-4f82-4cd3-8eaa-3a4c589dd0a6" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Report Status (Realized Type)]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" isBlankWhenNull="true">
								<reportElement uuid="c5510177-777b-4a92-8d29-46c1ce0aad13" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{REPORT STATUS}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="c147493d-4653-4f7b-ae0e-a64fd086be0d">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column82"/>
						<jr:tableFooter height="30" rowSpan="1"/>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1"/>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="aebbbd4b-c359-406f-b33a-52c868e66a1f" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Linkage Voucher / Invoice]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" isBlankWhenNull="true">
								<reportElement uuid="8497b82a-e419-493c-af38-bf213f1efae9" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{LINKAGE VOUCHER/INVOICE}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="1bb388cc-19c3-43ec-b83b-631ddb55ecd0">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column83"/>
						<jr:tableFooter height="30" rowSpan="1"/>
						<jr:groupFooter groupName="PROFIT_CENTER">
							<jr:cell height="30" rowSpan="1"/>
						</jr:groupFooter>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<staticText>
								<reportElement uuid="1cbb3217-b89c-4353-b307-ec9d5f12b97f" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Linkage Status]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<textField isStretchWithOverflow="true" isBlankWhenNull="true">
								<reportElement uuid="6cad106c-c1fa-4f73-8c4d-1eff722a2252" stretchType="RelativeToBandHeight" x="0" y="0" width="90" height="30" forecolor="#010101"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{LINKAGE STATUS}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
				</jr:table>
			</componentElement>
		</band>
	</detail>
	<pageFooter>
		<band height="20">
			<textField isStretchWithOverflow="true" evaluationTime="Auto">
				<reportElement uuid="4d0e643c-b420-464f-a6f7-7109f4cb303a" key="element-161" positionType="Float" x="4069" y="0" width="90" height="20" forecolor="#010101">
					<property name="local_mesure_unity" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.y" value="px"/>
				</reportElement>
				<textElement textAlignment="Right" verticalAlignment="Bottom"/>
				<textFieldExpression><![CDATA["Page " + ($V{currentpage} == null? 1 : $V{currentpage} + 1) + " of " + $V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
		</band>
	</pageFooter>
</jasperReport>
