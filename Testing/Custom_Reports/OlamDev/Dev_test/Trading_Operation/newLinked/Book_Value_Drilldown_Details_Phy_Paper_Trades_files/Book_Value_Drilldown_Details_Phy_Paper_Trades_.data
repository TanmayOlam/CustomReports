<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="bookValueDrilldownPhy&amp;Paper" language="groovy" pageWidth="1190" pageHeight="842" orientation="Landscape" columnWidth="1150" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" uuid="99e9b555-c650-4344-a349-2294c5f4bd4c">
	<property name="com.jaspersoft.studio.unit." value="pixel"/>
	<property name="ireport.zoom" value="1.0"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<property name="com.jaspersoft.studio.unit.pageHeight" value="pixel"/>
	<property name="com.jaspersoft.studio.unit.pageWidth" value="pixel"/>
	<property name="com.jaspersoft.studio.unit.topMargin" value="pixel"/>
	<property name="com.jaspersoft.studio.unit.bottomMargin" value="pixel"/>
	<property name="com.jaspersoft.studio.unit.leftMargin" value="pixel"/>
	<property name="com.jaspersoft.studio.unit.rightMargin" value="pixel"/>
	<property name="com.jaspersoft.studio.unit.columnWidth" value="pixel"/>
	<property name="com.jaspersoft.studio.unit.columnSpacing" value="pixel"/>
	<property name="net.sf.jasperreports.export.xls.fit.width" value="1"/>
	<property name="net.sf.jasperreports.export.pdf.size.page.to.content" value="true"/>
	<property name="net.sf.jasperreports.export.xls.ignore.graphics" value="false"/>
	<property name="net.sf.jasperreports.export.xls.font.size.fix.enabled" value="false"/>
	<property name="net.sf.jasperreports.export.xls.ignore.cell.border" value="false"/>
	<property name="net.sf.jasperreports.style.evaluation.time.enabled" value="true"/>
	<property name="net.sf.jasperreports.export.xls.fit.height" value="0"/>
	<style name="Table_TH" mode="Opaque" backcolor="#1F497D" fontName="Arial">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
			<topPen lineWidth="0.0" lineColor="#000000"/>
			<leftPen lineWidth="0.0" lineColor="#000000"/>
			<bottomPen lineWidth="0.0" lineColor="#000000"/>
			<rightPen lineWidth="0.0" lineColor="#000000"/>
		</box>
	</style>
	<style name="Table_CH" mode="Opaque" backcolor="#8DB4E2" fontName="Arial" isStrikeThrough="false">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
			<topPen lineWidth="0.0" lineColor="#000000"/>
			<leftPen lineWidth="0.0" lineColor="#000000"/>
			<bottomPen lineWidth="0.0" lineColor="#000000"/>
			<rightPen lineWidth="0.0" lineColor="#000000"/>
		</box>
	</style>
	<style name="Table_TD" mode="Opaque" backcolor="#C7DAF1" fontName="Arial">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
			<topPen lineWidth="0.0" lineColor="#000000"/>
			<leftPen lineWidth="0.0" lineColor="#000000"/>
			<bottomPen lineWidth="0.0" lineColor="#000000"/>
			<rightPen lineWidth="0.0" lineColor="#000000"/>
		</box>
	</style>
	<style name="Table 1_TH" mode="Opaque" backcolor="#F0F8FF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
			<topPen lineWidth="0.5" lineColor="#000000"/>
			<leftPen lineWidth="0.5" lineColor="#000000"/>
			<bottomPen lineWidth="0.5" lineColor="#000000"/>
			<rightPen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="Table 1_CH" mode="Opaque" backcolor="#BFE1FF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
			<topPen lineWidth="0.5" lineColor="#000000"/>
			<leftPen lineWidth="0.5" lineColor="#000000"/>
			<bottomPen lineWidth="0.5" lineColor="#000000"/>
			<rightPen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="Table 1_TD" mode="Opaque" backcolor="#FFFFFF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
			<topPen lineWidth="0.5" lineColor="#000000"/>
			<leftPen lineWidth="0.5" lineColor="#000000"/>
			<bottomPen lineWidth="0.5" lineColor="#000000"/>
			<rightPen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="Table 2_TH" mode="Opaque" backcolor="#FFCC00">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
			<topPen lineWidth="0.5" lineColor="#000000"/>
			<leftPen lineWidth="0.5" lineColor="#000000"/>
			<bottomPen lineWidth="0.5" lineColor="#000000"/>
			<rightPen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="Table 2_CH" mode="Opaque" backcolor="#FFCC00">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
			<topPen lineWidth="0.5" lineColor="#000000"/>
			<leftPen lineWidth="0.5" lineColor="#000000"/>
			<bottomPen lineWidth="0.5" lineColor="#000000"/>
			<rightPen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="Table 2_TD" mode="Opaque" backcolor="#FFFFFF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
			<topPen lineWidth="0.5" lineColor="#000000"/>
			<leftPen lineWidth="0.5" lineColor="#000000"/>
			<bottomPen lineWidth="0.5" lineColor="#000000"/>
			<rightPen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="Table 3_TH" mode="Opaque" backcolor="#FFFFFF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
			<topPen lineWidth="0.5" lineColor="#000000"/>
			<leftPen lineWidth="0.5" lineColor="#000000"/>
			<bottomPen lineWidth="0.5" lineColor="#000000"/>
			<rightPen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="Table 3_CH" mode="Opaque" backcolor="#FFCC00">
		<box leftPadding="0" rightPadding="0">
			<pen lineWidth="0.5" lineColor="#000000"/>
			<topPen lineWidth="0.5" lineColor="#000000"/>
			<leftPen lineWidth="0.5" lineColor="#000000"/>
			<bottomPen lineWidth="0.5" lineColor="#000000"/>
			<rightPen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="Table 3_TD" mode="Opaque" backcolor="#FFFFFF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
			<topPen lineWidth="0.5" lineColor="#000000"/>
			<leftPen lineWidth="0.5" lineColor="#000000"/>
			<bottomPen lineWidth="0.5" lineColor="#000000"/>
			<rightPen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="table">
		<box>
			<pen lineWidth="1.0" lineColor="#000000"/>
			<topPen lineWidth="0.5" lineColor="#4F81BD"/>
			<leftPen lineWidth="0.5" lineColor="#4F81BD"/>
			<bottomPen lineWidth="0.5" lineColor="#4F81BD"/>
			<rightPen lineWidth="0.5" lineColor="#4F81BD"/>
		</box>
	</style>
	<style name="table_TH" mode="Opaque" backcolor="#F0F8FF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
			<topPen lineWidth="0.5" lineColor="#4F81BD"/>
			<leftPen lineWidth="0.5" lineColor="#4F81BD"/>
			<bottomPen lineWidth="0.5" lineColor="#4F81BD"/>
			<rightPen lineWidth="0.5" lineColor="#4F81BD"/>
		</box>
	</style>
	<style name="table_CH">
		<box>
			<topPen lineWidth="0.5" lineColor="#4F81BD"/>
			<leftPen lineWidth="0.5" lineColor="#4F81BD"/>
			<bottomPen lineWidth="0.5" lineColor="#4F81BD"/>
			<rightPen lineWidth="0.5" lineColor="#4F81BD"/>
		</box>
	</style>
	<style name="table_TD" mode="Opaque" backcolor="#FFFFFF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
			<topPen lineWidth="0.5" lineColor="#4F81BD"/>
			<leftPen lineWidth="0.5" lineColor="#4F81BD"/>
			<bottomPen lineWidth="0.5" lineColor="#4F81BD"/>
			<rightPen lineWidth="0.5" lineColor="#4F81BD"/>
		</box>
	</style>
	<style name="Total1" mode="Opaque">
		<conditionalStyle>
			<conditionExpression><![CDATA[$V{TOT_PURCH_QTY}.compareTo( new BigDecimal(0) ) == -1]]></conditionExpression>
			<style mode="Opaque" forecolor="#FF0000"/>
		</conditionalStyle>
		<conditionalStyle>
			<conditionExpression><![CDATA[$V{TOT_PURCH_QTY}.intValue() >= 0]]></conditionExpression>
			<style mode="Opaque" forecolor="#FFFFFF"/>
		</conditionalStyle>
	</style>
	<style name="Total2" mode="Opaque">
		<conditionalStyle>
			<conditionExpression><![CDATA[$V{TOT_TOTAL_COST}.compareTo( new BigDecimal(0) ) == -1]]></conditionExpression>
			<style mode="Opaque" forecolor="#FF0000"/>
		</conditionalStyle>
		<conditionalStyle>
			<conditionExpression><![CDATA[$V{TOT_TOTAL_COST}.intValue() >= 0]]></conditionExpression>
			<style mode="Opaque" forecolor="#FFFFFF"/>
		</conditionalStyle>
	</style>
	<style name="Total3" mode="Opaque">
		<conditionalStyle>
			<conditionExpression><![CDATA[$V{TOT_SALES_QTY}.compareTo( new BigDecimal(0) ) == -1]]></conditionExpression>
			<style mode="Opaque" forecolor="#FF0000"/>
		</conditionalStyle>
		<conditionalStyle>
			<conditionExpression><![CDATA[$V{TOT_SALES_QTY}.intValue() >= 0]]></conditionExpression>
			<style mode="Opaque" forecolor="#FFFFFF"/>
		</conditionalStyle>
	</style>
	<style name="Total4" mode="Opaque">
		<conditionalStyle>
			<conditionExpression><![CDATA[$V{TOT_NET_REALIZATION}.compareTo( new BigDecimal(0) ) == -1]]></conditionExpression>
			<style mode="Opaque" forecolor="#FF0000"/>
		</conditionalStyle>
		<conditionalStyle>
			<conditionExpression><![CDATA[$V{TOT_NET_REALIZATION}.intValue() >= 0]]></conditionExpression>
			<style mode="Opaque" forecolor="#FFFFFF"/>
		</conditionalStyle>
	</style>
	<style name="Total5" mode="Opaque">
		<conditionalStyle>
			<conditionExpression><![CDATA[$V{TOT_MARKET_VALUE}.compareTo( new BigDecimal(0) ) == -1]]></conditionExpression>
			<style mode="Opaque" forecolor="#FF0000"/>
		</conditionalStyle>
		<conditionalStyle>
			<conditionExpression><![CDATA[$V{TOT_MARKET_VALUE}.intValue() >= 0]]></conditionExpression>
			<style mode="Opaque" forecolor="#FFFFFF"/>
		</conditionalStyle>
	</style>
	<style name="Total6" mode="Opaque">
		<conditionalStyle>
			<conditionExpression><![CDATA[$V{TOT_PNL}.compareTo( new BigDecimal(0) ) == -1]]></conditionExpression>
			<style mode="Opaque" forecolor="#FF0000"/>
		</conditionalStyle>
		<conditionalStyle>
			<conditionExpression><![CDATA[$V{TOT_PNL}.intValue() >= 0]]></conditionExpression>
			<style mode="Opaque" forecolor="#FFFFFF"/>
		</conditionalStyle>
	</style>
	<style name="Mid1" mode="Opaque">
		<conditionalStyle>
			<conditionExpression><![CDATA[$V{PURCH_QTY}.compareTo( new BigDecimal(0) ) == -1]]></conditionExpression>
			<style mode="Opaque" forecolor="#FF0000"/>
		</conditionalStyle>
		<conditionalStyle>
			<conditionExpression><![CDATA[$V{PURCH_QTY}.intValue() >= 0]]></conditionExpression>
			<style mode="Opaque" forecolor="#000000"/>
		</conditionalStyle>
	</style>
	<style name="Mid2" mode="Opaque">
		<conditionalStyle>
			<conditionExpression><![CDATA[$V{TOTAL_COST}.compareTo( new BigDecimal(0) ) == -1]]></conditionExpression>
			<style mode="Opaque" forecolor="#FF0000"/>
		</conditionalStyle>
		<conditionalStyle>
			<conditionExpression><![CDATA[$V{TOTAL_COST}.intValue() >= 0]]></conditionExpression>
			<style mode="Opaque" forecolor="#000000"/>
		</conditionalStyle>
	</style>
	<style name="Mid3" mode="Opaque">
		<conditionalStyle>
			<conditionExpression><![CDATA[$V{SALES_QTY}.compareTo( new BigDecimal(0) ) == -1]]></conditionExpression>
			<style mode="Opaque" forecolor="#FF0000"/>
		</conditionalStyle>
		<conditionalStyle>
			<conditionExpression><![CDATA[$V{SALES_QTY}.intValue() >= 0]]></conditionExpression>
			<style mode="Opaque" forecolor="#000000"/>
		</conditionalStyle>
	</style>
	<style name="Mid4" mode="Opaque">
		<conditionalStyle>
			<conditionExpression><![CDATA[$V{NET_REALIZATION}.compareTo( new BigDecimal(0) ) == -1]]></conditionExpression>
			<style mode="Opaque" forecolor="#FF0000"/>
		</conditionalStyle>
		<conditionalStyle>
			<conditionExpression><![CDATA[$V{NET_REALIZATION}.intValue() >= 0]]></conditionExpression>
			<style mode="Opaque" forecolor="#000000"/>
		</conditionalStyle>
	</style>
	<style name="Mid5" mode="Opaque">
		<conditionalStyle>
			<conditionExpression><![CDATA[$V{MARKET_VALUE}.compareTo( new BigDecimal(0) ) == -1]]></conditionExpression>
			<style mode="Opaque" forecolor="#FF0000"/>
		</conditionalStyle>
		<conditionalStyle>
			<conditionExpression><![CDATA[$V{MARKET_VALUE}.intValue() >= 0]]></conditionExpression>
			<style mode="Opaque" forecolor="#000000"/>
		</conditionalStyle>
	</style>
	<style name="Mid6" mode="Opaque">
		<conditionalStyle>
			<conditionExpression><![CDATA[$V{PNL}.compareTo( new BigDecimal(0) ) == -1]]></conditionExpression>
			<style mode="Opaque" forecolor="#FF0000"/>
		</conditionalStyle>
		<conditionalStyle>
			<conditionExpression><![CDATA[$V{PNL}.intValue() >= 0]]></conditionExpression>
			<style mode="Opaque" forecolor="#000000"/>
		</conditionalStyle>
	</style>
	<style name="Sub1" mode="Opaque">
		<conditionalStyle>
			<conditionExpression><![CDATA[$V{SUB_PURCH_QTY}.compareTo( new BigDecimal(0) ) == -1]]></conditionExpression>
			<style mode="Opaque" forecolor="#FF0000"/>
		</conditionalStyle>
		<conditionalStyle>
			<conditionExpression><![CDATA[$V{SUB_PURCH_QTY}.intValue() >= 0]]></conditionExpression>
			<style mode="Opaque" forecolor="#000000"/>
		</conditionalStyle>
	</style>
	<style name="Sub2" mode="Opaque">
		<conditionalStyle>
			<conditionExpression><![CDATA[$V{SUB_TOTAL_COST}.compareTo( new BigDecimal(0) ) == -1]]></conditionExpression>
			<style mode="Opaque" forecolor="#FF0000"/>
		</conditionalStyle>
		<conditionalStyle>
			<conditionExpression><![CDATA[$V{SUB_TOTAL_COST}.intValue() >= 0]]></conditionExpression>
			<style mode="Opaque" forecolor="#000000"/>
		</conditionalStyle>
	</style>
	<style name="Sub3" mode="Opaque">
		<conditionalStyle>
			<conditionExpression><![CDATA[$V{SUB_SALES_QTY}.compareTo( new BigDecimal(0) ) == -1]]></conditionExpression>
			<style mode="Opaque" forecolor="#FF0000"/>
		</conditionalStyle>
		<conditionalStyle>
			<conditionExpression><![CDATA[$V{SUB_SALES_QTY}.intValue() >= 0]]></conditionExpression>
			<style mode="Opaque" forecolor="#000000"/>
		</conditionalStyle>
	</style>
	<style name="Sub4" mode="Opaque">
		<conditionalStyle>
			<conditionExpression><![CDATA[$V{SUB_NET_REALIZATION}.compareTo( new BigDecimal(0) ) == -1]]></conditionExpression>
			<style mode="Opaque" forecolor="#FF0000"/>
		</conditionalStyle>
		<conditionalStyle>
			<conditionExpression><![CDATA[$V{SUB_NET_REALIZATION}.intValue() >= 0]]></conditionExpression>
			<style mode="Opaque" forecolor="#000000"/>
		</conditionalStyle>
	</style>
	<style name="Sub5" mode="Opaque">
		<conditionalStyle>
			<conditionExpression><![CDATA[$V{SUB_MARKET_VALUE}.compareTo( new BigDecimal(0) ) == -1]]></conditionExpression>
			<style mode="Opaque" forecolor="#FF0000"/>
		</conditionalStyle>
		<conditionalStyle>
			<conditionExpression><![CDATA[$V{SUB_MARKET_VALUE}.intValue() >= 0]]></conditionExpression>
			<style mode="Opaque" forecolor="#000000"/>
		</conditionalStyle>
	</style>
	<style name="Sub6" mode="Opaque">
		<conditionalStyle>
			<conditionExpression><![CDATA[$V{SUB_PNL}.compareTo( new BigDecimal(0) ) == -1]]></conditionExpression>
			<style mode="Opaque" forecolor="#FF0000"/>
		</conditionalStyle>
		<conditionalStyle>
			<conditionExpression><![CDATA[$V{SUB_PNL}.intValue() >= 0]]></conditionExpression>
			<style mode="Opaque" forecolor="#000000"/>
		</conditionalStyle>
	</style>
	<subDataset name="physical" uuid="29fd28fb-6e5b-4448-ad3a-14ed35602c72">
		<property name="com.jaspersoft.studio.data.defaultdataadapter" value="Local DB"/>
		<parameter name="ctrbook" class="java.util.Collection"/>
		<parameter name="asofdate" class="java.util.Date"/>
		<parameter name="alloc_grp" class="java.util.Collection"/>
		<parameter name="commodity" class="java.util.Collection"/>
		<parameter name="grade" class="java.util.Collection"/>
		<parameter name="instrument_type" class="java.util.Collection"/>
		<parameter name="pc" class="java.util.Collection"/>
		<parameter name="report_status" class="java.util.Collection"/>
		<parameter name="Price_Type_status" class="java.util.Collection"/>
		<queryString>
			<![CDATA[SELECT *
FROM  (SELECT A.CONTRACT_BOOK,
       PCD.CONTRACT_DATE                                                                                                                                                                                                                                                                                                    AS PURCH_TRANSACTION_DATE,
       PURCH_POSITION_REFERENCE                                                                                                                                                                                                                                                                                             AS PURCHASE_REF_NO,
       PURCH_PROFIT_CENTER                                                                                                                                                                                                                                                                                                  AS PURCH_UNIT,
       SUPPLIER                                                                                                                                                                                                                                                                                                             AS PURCH_PARTY,
       PURCH_COMMODITY                                                                                                                                                                                                                                                                                                      AS PURCH_PRODUCT,
       PURCH_GRADE                                                                                                                                                                                                                                                                                                          AS PURCH_GRADE,
       PURCH_DELIVERY_MONTH                                                                                                                                                                                                                                                                                                 AS PURCH_SHIPMENT_MONTH,
       PURCH_EXCHANGE                                                                                                                                                                                                                                                                                                       AS PURCH_EXCH,
       PURCH_FUTURE_TERMINAL_MONTH                                                                                                                                                                                                                                                                                          AS PURCH_TERMINAL_MONTH,
       NULL                                                                                                                                                                                                                                                                                                                 AS PURCH_STRIKE,
       PURCH_INCOTERM                                                                                                                                                                                                                                                                                                       AS PURCH_CONTRACT_TERMS,
       PURCH_PRICE_TERM                                                                                                                                                                                                                                                                                                     AS PURCH_PRICE_TYPE,
       Sum(CASE
             WHEN PURCH_POSITION_REFERENCE IS NOT NULL THEN CLOSED_QTY
           END)                                                                                                                                                                                                                                                                                                             AS PURCH_QUANTITY,
       Sum(CLOSED_QTY * ( Isnull(( ( COALESCE(PPNL.MARKET_PRICE, PPNL_OPEN.MARKET_PRICE) * PURCH_MKT_TO_POS_FXRATE ) + ( COALESCE(PPNL.MARKET_BASIS, PPNL_OPEN.MARKET_BASIS) * PURCH_BASIS_TO_POS_FXRATE ) ), PURCH_UNIT_PRICE) * PURCH_POS_TO_RPT_FXRATE / COALESCE(PURCH_UOM_FACTOR_FROM_POS_TO_RPT, 1) )) / Sum(CLOSED_QTY)                                                                  AS PURCH_CONTRACT_PRICE,
       Sum(CLOSED_QTY * ( PURCH_UNIT_COST * PURCH_COST_POS_TO_RPT_FXRATE / COALESCE(PURCH_UOM_FACTOR_FROM_POS_TO_RPT,1) )) / Sum(CLOSED_QTY)                                                                                                                                                                                                                               AS PURCH_DIRECT_COST,
       Sum(( CLOSED_QTY * COALESCE(Isnull(( ( COALESCE(PPNL.MARKET_PRICE, PPNL_OPEN.MARKET_PRICE) * PURCH_MKT_TO_POS_FXRATE ) + ( COALESCE(PPNL.MARKET_BASIS, PPNL_OPEN.MARKET_BASIS) * PURCH_BASIS_TO_POS_FXRATE ) ), PURCH_UNIT_PRICE), 0) * PURCH_POS_TO_RPT_FXRATE / COALESCE(PURCH_UOM_FACTOR_FROM_POS_TO_RPT, 1) ) + ( CLOSED_QTY * ( PURCH_UNIT_COST * PURCH_COST_POS_TO_RPT_FXRATE / COALESCE(PURCH_UOM_FACTOR_FROM_POS_TO_RPT,1)) )) AS TOTAL_COST,
       SCD.CONTRACT_DATE                                                                                                                                                                                                                                                                                                    AS SALES_TRANSACTION_DATE,
       SALES_POSITION_REFERENCE                                                                                                                                                                                                                                                                                             AS SALES_REF_NO,
       SALES_PROFIT_CENTER                                                                                                                                                                                                                                                                                                  AS SALES_UNIT,
       COUNTERPARTY                                                                                                                                                                                                                                                                                                         AS SALES_PARTY,
       SALES_COMMODITY                                                                                                                                                                                                                                                                                                      AS SALES_PRODUCT,
       SALES_GRADE                                                                                                                                                                                                                                                                                                          AS SALES_GRADE,
       SALES_DELIVERY_MONTH                                                                                                                                                                                                                                                                                                 AS SALES_SHIPMENT_MONTH,
       SALES_EXCHANGE                                                                                                                                                                                                                                                                                                       AS SALES_EXCH,
       SALES_FUTURE_TERMINAL_MONTH                    	                                                                                                                                                                                                                                                                      AS SALES_TERMINAL_MONTH,
       NULL                                                                                                                                                                                                                                                                                                                 AS SALES_STRIKE,
       SALES_INCOTERM                                                                                                                                                                                                                                                                                                       AS SALES_CONTRACT_TERMS,
       SALES_PRICE_TERM                                                                                                                                                                                                                                                                                                     AS SALES_PRICE_TYPE,
       Sum(CASE
             WHEN SALES_POSITION_REFERENCE IS NOT NULL THEN CLOSED_QTY
           END)                                                                                                                                                                                                                                                                                                             AS SALES_QUANTITY,
       Sum(CLOSED_QTY * Isnull(( ( COALESCE(SPNL.MARKET_PRICE, SPNL_OPEN.MARKET_PRICE) * SALES_MKT_TO_POS_FXRATE ) + ( COALESCE(SPNL.MARKET_BASIS, SPNL_OPEN.MARKET_BASIS) * SALES_BASIS_TO_POS_FXRATE ) ), SALES_UNIT_PRICE) * SALES_POS_TO_RPT_FXRATE / COALESCE(SALES_UOM_FACTOR_FROM_POS_TO_RPT, 1)) / Sum(CLOSED_QTY)                                                                      AS SALES_CONTRACT_PRICE,
       Sum(CLOSED_QTY * SALES_UNIT_COST * SALES_COST_POS_TO_RPT_FXRATE / COALESCE(SALES_UOM_FACTOR_FROM_POS_TO_RPT,1) ) / Sum(CLOSED_QTY)                                                                                                                                                                                                                                   AS SALES_DIRECT_COST,
       Sum(( CLOSED_QTY * COALESCE(Isnull(( ( COALESCE(SPNL.MARKET_PRICE, SPNL_OPEN.MARKET_PRICE) * SALES_MKT_TO_POS_FXRATE ) + ( COALESCE(SPNL.MARKET_BASIS, SPNL_OPEN.MARKET_BASIS) * SALES_BASIS_TO_POS_FXRATE ) ), SALES_UNIT_PRICE), 0) * SALES_POS_TO_RPT_FXRATE / COALESCE(SALES_UOM_FACTOR_FROM_POS_TO_RPT, 1) ) - ( CLOSED_QTY * SALES_UNIT_COST * SALES_COST_POS_TO_RPT_FXRATE / COALESCE(SALES_UOM_FACTOR_FROM_POS_TO_RPT,1) ))     AS NET_REALIZATION,
       NULL                                                                                                                                                                                                                                                                                                                 AS MARKET_PRICE,
       NULL                                                                                                                                                                                                                                                                                                                 AS MARKET_VALUE,
       Sum(BOOKED_VALUE)                                                                                                                                                                                                                                                                                                    AS PNL,
       CASE
         WHEN A.INSTRUMENT_TYPE = 'PHYSICAL'
              AND COALESCE(SALES_CONTRACT_TYPE, PURCH_CONTRACT_TYPE) = 'PHYSICAL' THEN 'Physicals'
         WHEN A.INSTRUMENT_TYPE = 'PHYSICAL'
              AND COALESCE(SALES_CONTRACT_TYPE, PURCH_CONTRACT_TYPE) = 'PAPER' THEN 'Paper Trades'
         WHEN A.INSTRUMENT_TYPE = 'FUTURES' THEN 'Futures'
         WHEN A.INSTRUMENT_TYPE = 'OPTION' THEN 'Options'
         WHEN A.INSTRUMENT_TYPE = 'FOREX' THEN 'Currency Covers'
       END                                                                                                                                                                                                                                                                                                                  AS TRADE_TYPE,
       'Closed'                                                                                                                                                                                                                                                                                                             AS REPORT_STATUS,
       CASE
         WHEN A.EOD_DATE < CD.START_DATE THEN 'Booked Till Last Month End'
         ELSE 'Booked For The Month'
       END                                                                                                                                                                                                                                                                                                                  AS CONTRACT_STATUS,
       'Closed'                                                                                                                                                                                                                                                                                                             AS PRICE_TYPE_STATUS
FROM   BI_VIEW_BOOK_VALUE_DETAILS A
       JOIN EXTRACTED_FINANCIAL_CALENDAR_DETAIL CD
         ON $P{asofdate} BETWEEN CD.START_DATE AND CD.END_DATE
            AND A.CONTRACT_BOOK IN (SELECT CONTRACT_BOOK
                                    FROM   EXTRACTED_FINANCIAL_CALENDAR_HEADER CH
                                    WHERE  CH.GROUP_ID = CD.GROUP_ID)
       JOIN (SELECT CONTRACT_BOOK,
                    Max(EOD_DATE) AS EOD_DATE
             FROM   BI_VIEW_BOOK_VALUE_DETAILS
             WHERE  EOD_DATE <= $P{asofdate}
             GROUP  BY CONTRACT_BOOK) MAX_EOD_DATE
         ON A.CONTRACT_BOOK = MAX_EOD_DATE.CONTRACT_BOOK
       JOIN (SELECT POSITION_ID,
                    Min(POSITION_DATE) CONTRACT_DATE
             FROM   DAILY_PNL_ATTRIBUTION DPAT
             WHERE  INSTRUMENT_TYPE = 'PHYSICAL'
             GROUP  BY POSITION_ID) PCD
         ON PCD.POSITION_ID = A.PURCH_POSITION_ID
       JOIN (SELECT POSITION_ID,
                    Min(POSITION_DATE) CONTRACT_DATE
             FROM   DAILY_PNL_ATTRIBUTION DPAT
             WHERE  INSTRUMENT_TYPE = 'PHYSICAL'
             GROUP  BY POSITION_ID) SCD
         ON SCD.POSITION_ID = A.SALES_POSITION_ID
       LEFT JOIN (SELECT DPA.POSITION_REF,
                         DPA.INSTRUMENT_TYPE,
                         DPA.ALLOCATION_ID,
                         DPA.PRICING_ID,
                         Min(POSITION_DATE)                                                                                                     POSITION_DATE,
                         Max(DPA.CURRENT_PHY_MARKET_PRICE / NULLIF(C.DENOMINATION_FACTOR, 0) / UOM_FACTOR_FROM_MKT_TO_POS)                      MARKET_PRICE,
                         Max(Isnull(DPA.CURRENT_BASIS_MARKET_PRICE, 0) / NULLIF(C.BASIS_DENOMINATION_FACTOR, 0) / UOM_FACTOR_FROM_BASIS_TO_POS) MARKET_BASIS
                  FROM   DAILY_PNL_ATTRIBUTION DPA
                         JOIN DAILY_CONTRACT_DATA C
                           ON C.POSITION_ID = DPA.POSITION_ID
                  WHERE  DPA.EOD_DATE = (SELECT Max(EOD_DATE)
                                         FROM   DAILY_PNL_ATTRIBUTION D
                                         WHERE  D.EOD_DATE <= Dateadd(yy, Datediff(yy, 0, $P{asofdate}), 0) - 1)
                         AND NOT EXISTS (SELECT 1
                                         FROM   DUMP_BI_FINANCIAL_LOAD_DETAILS DBF
                                         WHERE  DBF.POSITION_ID = DPA.POSITION_ID
                                                AND DBF.ALLOCATION_ID = DPA.ALLOCATION_ID
                                                AND DBF.PRICING_ID = DPA.PRICING_ID
                                                AND DBF.QTY_FIXED_IN_THIS_DOCUMENT > 0
                                                AND Datepart(yyyy, DBF.DOCUMENT_DATE) = Datepart(yyyy, $P{asofdate}))
                         AND DPA.INSTRUMENT_TYPE = 'PHYSICAL'
                         AND CURRENT_OPEN_QUANTITY > 0
                  GROUP  BY DPA.POSITION_REF,
                            DPA.INSTRUMENT_TYPE,
                            DPA.ALLOCATION_ID,
                            DPA.PRICING_ID) SPNL
              ON SPNL.POSITION_REF = A.SALES_POSITION_REFERENCE
                 AND SPNL.INSTRUMENT_TYPE = A.INSTRUMENT_TYPE
                 AND Isnull(SPNL.ALLOCATION_ID, 'XXX') = Isnull(A.SALES_ALLOCATION_ID, 'XXX')
                 AND Isnull(SPNL.PRICING_ID, 'XXX') = Isnull(A.SALES_PRICING_ID, 'XXX')
				 LEFT JOIN (SELECT DPA.POSITION_REF,
                         DPA.INSTRUMENT_TYPE,
                         DPA.ALLOCATION_ID,
                         DPA.PRICING_ID,
                         Min(POSITION_DATE)                                                                                                     POSITION_DATE,
                         Max(DPA.CURRENT_PHY_MARKET_PRICE / NULLIF(C.DENOMINATION_FACTOR, 0) / UOM_FACTOR_FROM_MKT_TO_POS)                      MARKET_PRICE,
                         Max(Isnull(DPA.CURRENT_BASIS_MARKET_PRICE, 0) / NULLIF(C.BASIS_DENOMINATION_FACTOR, 0) / UOM_FACTOR_FROM_BASIS_TO_POS) MARKET_BASIS
                  FROM   DAILY_PNL_ATTRIBUTION DPA
                         JOIN DAILY_CONTRACT_DATA C
                           ON C.POSITION_ID = DPA.POSITION_ID
                  WHERE  DPA.EOD_DATE = (SELECT Max(EOD_DATE)
                                         FROM   DAILY_PNL_ATTRIBUTION D
                                         WHERE  D.EOD_DATE <= Dateadd(yy, Datediff(yy, 0, $P{asofdate}), 0) - 1)
                         AND NOT EXISTS (SELECT 1
                                         FROM   DUMP_BI_FINANCIAL_LOAD_DETAILS DBF
                                         WHERE  DBF.POSITION_ID = DPA.POSITION_ID
                                                AND DBF.ALLOCATION_ID = DPA.ALLOCATION_ID
                                                AND DBF.PRICING_ID = DPA.PRICING_ID
                                                AND DBF.QTY_FIXED_IN_THIS_DOCUMENT > 0
                                                AND Datepart(yyyy, DBF.DOCUMENT_DATE) = Datepart(yyyy, $P{asofdate}))
                         AND DPA.INSTRUMENT_TYPE = 'PHYSICAL'
                         AND CURRENT_OPEN_QUANTITY > 0
						 AND DPA.ALLOCATION_TYPE = 'OPEN'
                  GROUP  BY DPA.POSITION_REF,
                            DPA.INSTRUMENT_TYPE,
                            DPA.ALLOCATION_ID,
                            DPA.PRICING_ID) SPNL_OPEN
              ON SPNL_OPEN.POSITION_REF = A.SALES_POSITION_REFERENCE
                 AND SPNL_OPEN.INSTRUMENT_TYPE = A.INSTRUMENT_TYPE
                 AND Isnull(SPNL_OPEN.PRICING_ID, 'XXX') = Isnull(A.SALES_PRICING_ID, 'XXX')
       LEFT JOIN (SELECT DPA.POSITION_REF,
                         DPA.INSTRUMENT_TYPE,
                         DPA.ALLOCATION_ID,
                         DPA.PRICING_ID,
                         Min(POSITION_DATE)                                                                                                     POSITION_DATE,
                         Max(DPA.CURRENT_PHY_MARKET_PRICE / NULLIF(C.DENOMINATION_FACTOR, 0) / UOM_FACTOR_FROM_MKT_TO_POS)                      MARKET_PRICE,
                         Max(Isnull(DPA.CURRENT_BASIS_MARKET_PRICE, 0) / NULLIF(C.BASIS_DENOMINATION_FACTOR, 0) / UOM_FACTOR_FROM_BASIS_TO_POS) MARKET_BASIS
                  FROM   DAILY_PNL_ATTRIBUTION DPA
                         JOIN DAILY_CONTRACT_DATA C
                           ON C.POSITION_ID = DPA.POSITION_ID
                  WHERE  DPA.EOD_DATE = (SELECT Max(EOD_DATE)
                                         FROM   DAILY_PNL_ATTRIBUTION D
                                         WHERE  D.EOD_DATE <= Dateadd(yy, Datediff(yy, 0, $P{asofdate}), 0) - 1)
                         AND NOT EXISTS (SELECT 1
                                         FROM   DUMP_BI_FINANCIAL_LOAD_DETAILS DBF
                                         WHERE  DBF.POSITION_ID = DPA.POSITION_ID
                                                AND DBF.ALLOCATION_ID = DPA.ALLOCATION_ID
                                                AND DBF.PRICING_ID = DPA.PRICING_ID
                                                AND DBF.QTY_FIXED_IN_THIS_DOCUMENT > 0
                                                AND Datepart(yyyy, DBF.DOCUMENT_DATE) = Datepart(yyyy, $P{asofdate}))
                         AND DPA.INSTRUMENT_TYPE = 'PHYSICAL'
                         AND CURRENT_OPEN_QUANTITY > 0
                  GROUP  BY DPA.POSITION_REF,
                            DPA.INSTRUMENT_TYPE,
                            DPA.ALLOCATION_ID,
                            DPA.PRICING_ID) PPNL
              ON PPNL.POSITION_REF = A.PURCH_POSITION_REFERENCE
                 AND PPNL.INSTRUMENT_TYPE = A.INSTRUMENT_TYPE
                 AND Isnull(PPNL.ALLOCATION_ID, 'XXX') = Isnull(A.PURCH_ALLOCATION_ID, 'XXX')
                 AND Isnull(PPNL.PRICING_ID, 'XXX') = Isnull(A.PURCH_PRICING_ID, 'XXX')
		LEFT JOIN (SELECT DPA.POSITION_REF,
                         DPA.INSTRUMENT_TYPE,
                         DPA.ALLOCATION_ID,
                         DPA.PRICING_ID,
                         Min(POSITION_DATE)                                                                                                     POSITION_DATE,
                         Max(DPA.CURRENT_PHY_MARKET_PRICE / NULLIF(C.DENOMINATION_FACTOR, 0) / UOM_FACTOR_FROM_MKT_TO_POS)                      MARKET_PRICE,
                         Max(Isnull(DPA.CURRENT_BASIS_MARKET_PRICE, 0) / NULLIF(C.BASIS_DENOMINATION_FACTOR, 0) / UOM_FACTOR_FROM_BASIS_TO_POS) MARKET_BASIS
                  FROM   DAILY_PNL_ATTRIBUTION DPA
                         JOIN DAILY_CONTRACT_DATA C
                           ON C.POSITION_ID = DPA.POSITION_ID
                  WHERE  DPA.EOD_DATE = (SELECT Max(EOD_DATE)
                                         FROM   DAILY_PNL_ATTRIBUTION D
                                         WHERE  D.EOD_DATE <= Dateadd(yy, Datediff(yy, 0, $P{asofdate}), 0) - 1)
                         AND NOT EXISTS (SELECT 1
                                         FROM   DUMP_BI_FINANCIAL_LOAD_DETAILS DBF
                                         WHERE  DBF.POSITION_ID = DPA.POSITION_ID
                                                AND DBF.ALLOCATION_ID = DPA.ALLOCATION_ID
                                                AND DBF.PRICING_ID = DPA.PRICING_ID
                                                AND DBF.QTY_FIXED_IN_THIS_DOCUMENT > 0
                                                AND Datepart(yyyy, DBF.DOCUMENT_DATE) = Datepart(yyyy, $P{asofdate}))
                         AND DPA.INSTRUMENT_TYPE = 'PHYSICAL'
                         AND CURRENT_OPEN_QUANTITY > 0
						 AND DPA.ALLOCATION_TYPE = 'OPEN'
                  GROUP  BY DPA.POSITION_REF,
                            DPA.INSTRUMENT_TYPE,
                            DPA.ALLOCATION_ID,
                            DPA.PRICING_ID) PPNL_OPEN
              ON PPNL_OPEN.POSITION_REF = A.PURCH_POSITION_REFERENCE
                 AND PPNL_OPEN.INSTRUMENT_TYPE = A.INSTRUMENT_TYPE
                 AND Isnull(PPNL_OPEN.PRICING_ID, 'XXX') = Isnull(A.PURCH_PRICING_ID, 'XXX')
WHERE  A.INSTRUMENT_TYPE = 'PHYSICAL'
       AND ALLOCATION_GROUP IN ( 'BOOKED' )
       AND A.EOD_DATE <= $P{asofdate}
       AND MAX_EOD_DATE.EOD_DATE = $P{asofdate}
       AND Datepart(yyyy, A.EOD_DATE) = Datepart(yyyy, $P{asofdate})
GROUP  BY A.CONTRACT_BOOK,
          PCD.CONTRACT_DATE,
          PURCH_POSITION_REFERENCE,
          PURCH_PROFIT_CENTER,
          SUPPLIER,
          PURCH_COMMODITY,
          PURCH_GRADE,
          PURCH_DELIVERY_MONTH,
          PURCH_EXCHANGE,
          PURCH_FUTURE_TERMINAL_MONTH,
          PURCH_INCOTERM,
          PURCH_PRICE_TERM,
          SCD.CONTRACT_DATE,
          SALES_POSITION_REFERENCE,
          SALES_PROFIT_CENTER,
          COUNTERPARTY,
          SALES_COMMODITY,
          SALES_GRADE,
          SALES_DELIVERY_MONTH,
          SALES_EXCHANGE,
          SALES_FUTURE_TERMINAL_MONTH,
          SALES_INCOTERM,
          SALES_PRICE_TERM,
          CASE
            WHEN A.INSTRUMENT_TYPE = 'PHYSICAL'
                 AND COALESCE(SALES_CONTRACT_TYPE, PURCH_CONTRACT_TYPE) = 'PHYSICAL' THEN 'Physicals'
            WHEN A.INSTRUMENT_TYPE = 'PHYSICAL'
                 AND COALESCE(SALES_CONTRACT_TYPE, PURCH_CONTRACT_TYPE) = 'PAPER' THEN 'Paper Trades'
            WHEN A.INSTRUMENT_TYPE = 'FUTURES' THEN 'Futures'
            WHEN A.INSTRUMENT_TYPE = 'OPTION' THEN 'Options'
            WHEN A.INSTRUMENT_TYPE = 'FOREX' THEN 'Currency Covers'
          END,
          CASE
            WHEN A.EOD_DATE < CD.START_DATE THEN 'Booked Till Last Month End'
            ELSE 'Booked For The Month'
          END
       UNION ALL
SELECT A.CONTRACT_BOOK,
       PCD.CONTRACT_DATE                                                                                                                                                                                  AS PURCH_TRANSACTION_DATE,
       PURCH_POSITION_REFERENCE                                                                                                                                                                           AS PURCHASE_REF_NO,
       PURCH_PROFIT_CENTER                                                                                                                                                                                AS PURCH_UNIT,
       SUPPLIER                                                                                                                                                                                           AS PURCH_PARTY,
       PURCH_COMMODITY                                                                                                                                                                                    AS PURCH_PRODUCT,
       PURCH_GRADE                                                                                                                                                                                        AS PURCH_GRADE,
       PURCH_DELIVERY_MONTH                                                                                                                                                                               AS PURCH_SHIPMENT_MONTH,
       PURCH_EXCHANGE                                                                                                                                                                                     AS PURCH_EXCH,
       PURCH_FUTURE_TERMINAL_MONTH                                                                                                                                                                        AS PURCH_TERMINAL_MONTH,
       NULL                                                                                                                                                                                               AS PURCH_STRIKE,
       PURCH_INCOTERM                                                                                                                                                                                     AS PURCH_CONTRACT_TERMS,
       PURCH_PRICE_TERM                                                                                                                                                                                   AS PURCH_PRICE_TYPE,
       CASE
         WHEN PURCH_POSITION_REFERENCE IS NOT NULL THEN OPEN_QTY
       END                                                                                                                                                                                                AS PURCH_QUANTITY,
       Isnull(( CASE
                  WHEN PURCH_EVENT_TYPE = 'BASIS' THEN ( COALESCE(PPNL.MARKET_BASIS, PPNL_OPEN.MARKET_BASIS) * PURCH_BASIS_TO_POS_FXRATE )
                  ELSE ( ( COALESCE(PPNL.MARKET_PRICE, PPNL_OPEN.MARKET_PRICE) * PURCH_MKT_TO_POS_FXRATE ) + ( COALESCE(PPNL.MARKET_BASIS, PPNL_OPEN.MARKET_BASIS) * PURCH_BASIS_TO_POS_FXRATE ) )
                END ), PURCH_UNIT_PRICE) * PURCH_POS_TO_RPT_FXRATE / COALESCE(PURCH_UOM_FACTOR_FROM_POS_TO_RPT, 1)                                                                                        AS PURCH_CONTRACT_PRICE,
       PURCH_UNIT_COST * PURCH_POS_TO_RPT_FXRATE  / COALESCE(PURCH_UOM_FACTOR_FROM_POS_TO_RPT,1)                                                                                                                                                        AS PURCH_DIRECT_COST,
       ( OPEN_QTY * COALESCE(Isnull(( CASE
                                        WHEN PURCH_EVENT_TYPE = 'BASIS' THEN ( COALESCE(PPNL.MARKET_BASIS, PPNL_OPEN.MARKET_BASIS) * PURCH_BASIS_TO_POS_FXRATE )
                                        ELSE ( ( COALESCE(PPNL.MARKET_PRICE, PPNL_OPEN.MARKET_PRICE) * PURCH_MKT_TO_POS_FXRATE ) + ( COALESCE(PPNL.MARKET_BASIS, PPNL_OPEN.MARKET_BASIS) * PURCH_BASIS_TO_POS_FXRATE ) )
                                      END ), PURCH_UNIT_PRICE), 0) * PURCH_POS_TO_RPT_FXRATE / COALESCE(PURCH_UOM_FACTOR_FROM_POS_TO_RPT, 1) ) + ( OPEN_QTY * PURCH_UNIT_COST * PURCH_POS_TO_RPT_FXRATE / COALESCE(PURCH_UOM_FACTOR_FROM_POS_TO_RPT,1)) AS TOTAL_COST,
       SCD.CONTRACT_DATE                                                                                                                                                                                  AS SALES_TRANSACTION_DATE,
       SALES_POSITION_REFERENCE                                                                                                                                                                           AS SALES_REF_NO,
       SALES_PROFIT_CENTER                                                                                                                                                                                AS SALES_UNIT,
       COUNTERPARTY                                                                                                                                                                                       AS SALES_PARTY,
       SALES_COMMODITY                                                                                                                                                                                    AS SALES_PRODUCT,
       SALES_GRADE                                                                                                                                                                                        AS SALES_GRADE,
       SALES_DELIVERY_MONTH                                                                                                                                                                               AS SALES_SHIPMENT_MONTH,
       SALES_EXCHANGE                                                                                                                                                                                     AS SALES_EXCH,
       SALES_FUTURE_TERMINAL_MONTH                                                                                                                                                                        AS SALES_TERMINAL_MONTH,
       NULL                                                                                                                                                                                               AS SALES_STRIKE,
       SALES_INCOTERM                                                                                                                                                                                     AS SALES_CONTRACT_TERMS,
       SALES_PRICE_TERM                                                                                                                                                                                   AS SALES_PRICE_TYPE,
       CASE
         WHEN SALES_POSITION_REFERENCE IS NOT NULL THEN OPEN_QTY
       END                                                                                                                                                                                                AS SALES_QUANTITY,
       Isnull(( CASE
                  WHEN SALES_EVENT_TYPE = 'BASIS' THEN ( COALESCE(SPNL.MARKET_BASIS, SPNL_OPEN.MARKET_BASIS) * SALES_BASIS_TO_POS_FXRATE )
                  ELSE ( ( COALESCE(SPNL.MARKET_PRICE, SPNL_OPEN.MARKET_PRICE) * SALES_MKT_TO_POS_FXRATE ) + ( COALESCE(SPNL.MARKET_BASIS, SPNL_OPEN.MARKET_BASIS) * SALES_BASIS_TO_POS_FXRATE ) )
                END ), SALES_UNIT_PRICE) * SALES_POS_TO_RPT_FXRATE / COALESCE(SALES_UOM_FACTOR_FROM_POS_TO_RPT, 1)                                                                                        AS SALES_CONTRACT_PRICE,
       SALES_UNIT_COST * SALES_POS_TO_RPT_FXRATE  / COALESCE(SALES_UOM_FACTOR_FROM_POS_TO_RPT,1)                                                                                                                                                       AS SALES_DIRECT_COST,
       ( OPEN_QTY * COALESCE(Isnull(( CASE
                                        WHEN SALES_EVENT_TYPE = 'BASIS' THEN ( COALESCE(SPNL.MARKET_BASIS, SPNL_OPEN.MARKET_BASIS) * SALES_BASIS_TO_POS_FXRATE )
                                        ELSE ( ( COALESCE(SPNL.MARKET_PRICE, SPNL_OPEN.MARKET_PRICE) * SALES_MKT_TO_POS_FXRATE ) + ( COALESCE(SPNL.MARKET_BASIS, SPNL_OPEN.MARKET_BASIS) * SALES_BASIS_TO_POS_FXRATE ) )
                                      END ), SALES_UNIT_PRICE), 0) * SALES_POS_TO_RPT_FXRATE / COALESCE(SALES_UOM_FACTOR_FROM_POS_TO_RPT, 1) ) - ( OPEN_QTY * SALES_UNIT_COST * SALES_POS_TO_RPT_FXRATE / COALESCE(SALES_UOM_FACTOR_FROM_POS_TO_RPT,1)) AS NET_REALIZATION,
       CASE
         WHEN ( SALES_EVENT_TYPE = 'BASIS'
                 OR PURCH_EVENT_TYPE = 'BASIS' ) THEN COALESCE(SALES_MARKET_BASIS_PRICE, PURCH_MARKET_BASIS_PRICE)
         WHEN ( SALES_EVENT_TYPE = 'COMMODITY'
                 OR PURCH_EVENT_TYPE = 'COMMODITY' ) THEN COALESCE(SALES_MARKET_UNIT_PRICE, PURCH_MARKET_UNIT_PRICE)
                                                          + COALESCE(SALES_MARKET_BASIS_PRICE, PURCH_MARKET_BASIS_PRICE)
       END                                                                                                                                                                                                AS MARKET_PRICE,
       CASE
         WHEN ( SALES_EVENT_TYPE = 'BASIS'
                 OR PURCH_EVENT_TYPE = 'BASIS' ) THEN COALESCE(SALES_MARKET_BASIS_PRICE, PURCH_MARKET_BASIS_PRICE)
         WHEN ( SALES_EVENT_TYPE = 'COMMODITY'
                 OR PURCH_EVENT_TYPE = 'COMMODITY' ) THEN COALESCE(SALES_MARKET_UNIT_PRICE, PURCH_MARKET_UNIT_PRICE)
                                                          + COALESCE(SALES_MARKET_BASIS_PRICE, PURCH_MARKET_BASIS_PRICE)
       END * OPEN_QTY                                                                                                                                                                                     AS MARKET_VALUE,
       CASE
         WHEN SALES_EVENT_TYPE IS NOT NULL THEN SALES_OPEN_VALUE
         WHEN PURCH_EVENT_TYPE IS NOT NULL THEN PURCH_OPEN_VALUE
       END                                                                                                                                                                                                AS PNL,
       CASE
         WHEN A.INSTRUMENT_TYPE = 'PHYSICAL'
              AND COALESCE(SALES_CONTRACT_TYPE, PURCH_CONTRACT_TYPE) = 'PHYSICAL' THEN 'Physicals'
         WHEN A.INSTRUMENT_TYPE = 'PHYSICAL'
              AND COALESCE(SALES_CONTRACT_TYPE, PURCH_CONTRACT_TYPE) = 'PAPER' THEN 'Paper Trades'
         WHEN A.INSTRUMENT_TYPE = 'FUTURES' THEN 'Futures'
         WHEN A.INSTRUMENT_TYPE = 'OPTION' THEN 'Options'
         WHEN A.INSTRUMENT_TYPE = 'FOREX' THEN 'Currency Covers'
       END                                                                                                                                                                                                AS TRADE_TYPE,
       CASE ALLOCATION_GROUP
         WHEN 'SHORT LINKED' THEN 'Closed'
         WHEN 'LONG LINKED' THEN 'Closed'
         WHEN 'SHORT UNLINKED' THEN 'Open'
         WHEN 'LONG UNLINKED' THEN 'Open'
       END                                                                                                                                                                                                AS REPORT_STATUS,
       CASE
         WHEN A.INSTRUMENT_TYPE = 'PHYSICAL'
              AND COALESCE(SALES_CONTRACT_TYPE, PURCH_CONTRACT_TYPE) = 'PHYSICAL'
              AND ALLOCATION_GROUP = 'SHORT UNLINKED' THEN 'Unlinked Sales - OIL'
         WHEN A.INSTRUMENT_TYPE = 'PHYSICAL'
              AND COALESCE(SALES_CONTRACT_TYPE, PURCH_CONTRACT_TYPE) = 'PHYSICAL'
              AND ALLOCATION_GROUP = 'LONG UNLINKED' THEN 'Unlinked Purchase - OIL'
         WHEN ALLOCATION_GROUP = 'SHORT LINKED' THEN 'Linked Sales'
         WHEN ALLOCATION_GROUP = 'LONG LINKED' THEN 'Linked Purchase'
         WHEN ALLOCATION_GROUP = 'SHORT UNLINKED' THEN 'Unlinked Sales - OIL'
         WHEN ALLOCATION_GROUP = 'LONG UNLINKED' THEN 'Unlinked Purchase - OIL'
       END                                                                                                                                                                                                AS CONTRACT_STATUS,
       CASE
         WHEN ( SALES_EVENT_TYPE = 'COMMODITY'
                 OR PURCH_EVENT_TYPE = 'COMMODITY' ) THEN 'Open'
         WHEN ( SALES_EVENT_TYPE = 'BASIS'
                 OR PURCH_EVENT_TYPE = 'BASIS' ) THEN 'Unpriced'
       END                                                                                                                                                                                                AS PRICE_TYPE_STATUS
FROM   BI_VIEW_BOOK_VALUE_DETAILS A
       LEFT JOIN (SELECT POSITION_ID,
                         Min(POSITION_DATE) CONTRACT_DATE
                  FROM   DAILY_PNL_ATTRIBUTION DPAT
                  WHERE  INSTRUMENT_TYPE = 'PHYSICAL'
                  GROUP  BY POSITION_ID) PCD
              ON PCD.POSITION_ID = A.PURCH_POSITION_ID
       LEFT JOIN (SELECT POSITION_ID,
                         Min(POSITION_DATE) CONTRACT_DATE
                  FROM   DAILY_PNL_ATTRIBUTION DPAT
                  WHERE  INSTRUMENT_TYPE = 'PHYSICAL'
                  GROUP  BY POSITION_ID) SCD
              ON SCD.POSITION_ID = A.SALES_POSITION_ID
       LEFT JOIN (SELECT DPA.POSITION_REF,
                         DPA.INSTRUMENT_TYPE,
                         DPA.ALLOCATION_ID,
                         DPA.PRICING_ID,
                         Min(POSITION_DATE)                                                                                                     POSITION_DATE,
                         Max(DPA.CURRENT_PHY_MARKET_PRICE / NULLIF(C.DENOMINATION_FACTOR, 0) / UOM_FACTOR_FROM_MKT_TO_POS)                      MARKET_PRICE,
                         Max(Isnull(DPA.CURRENT_BASIS_MARKET_PRICE, 0) / NULLIF(C.BASIS_DENOMINATION_FACTOR, 0) / UOM_FACTOR_FROM_BASIS_TO_POS) MARKET_BASIS
                  FROM   DAILY_PNL_ATTRIBUTION DPA
                         JOIN DAILY_CONTRACT_DATA C
                           ON C.POSITION_ID = DPA.POSITION_ID
                  WHERE  DPA.EOD_DATE = (SELECT Max(EOD_DATE)
                                         FROM   DAILY_PNL_ATTRIBUTION D
                                         WHERE  D.EOD_DATE <= Dateadd(yy, Datediff(yy, 0, $P{asofdate}), 0) - 1)
                         AND DPA.INSTRUMENT_TYPE = 'PHYSICAL'
                         AND CURRENT_OPEN_QUANTITY > 0
                  GROUP  BY DPA.POSITION_REF,
                            DPA.INSTRUMENT_TYPE,
                            DPA.ALLOCATION_ID,
                            DPA.PRICING_ID) SPNL
              ON SPNL.POSITION_REF = A.SALES_POSITION_REFERENCE
                 AND SPNL.INSTRUMENT_TYPE = A.INSTRUMENT_TYPE
                 AND Isnull(SPNL.ALLOCATION_ID, 'XXX') = Isnull(A.SALES_ALLOCATION_ID, 'XXX')
                 AND Isnull(SPNL.PRICING_ID, 'XXX') = Isnull(A.SALES_PRICING_ID, 'XXX')
				 LEFT JOIN (SELECT DPA.POSITION_REF,
                         DPA.INSTRUMENT_TYPE,
                         DPA.ALLOCATION_ID,
                         DPA.PRICING_ID,
                         Min(POSITION_DATE)                                                                                                     POSITION_DATE,
                         Max(DPA.CURRENT_PHY_MARKET_PRICE / NULLIF(C.DENOMINATION_FACTOR, 0) / UOM_FACTOR_FROM_MKT_TO_POS)                      MARKET_PRICE,
                         Max(Isnull(DPA.CURRENT_BASIS_MARKET_PRICE, 0) / NULLIF(C.BASIS_DENOMINATION_FACTOR, 0) / UOM_FACTOR_FROM_BASIS_TO_POS) MARKET_BASIS
                  FROM   DAILY_PNL_ATTRIBUTION DPA
                         JOIN DAILY_CONTRACT_DATA C
                           ON C.POSITION_ID = DPA.POSITION_ID
                  WHERE  DPA.EOD_DATE = (SELECT Max(EOD_DATE)
                                         FROM   DAILY_PNL_ATTRIBUTION D
                                         WHERE  D.EOD_DATE <= Dateadd(yy, Datediff(yy, 0, $P{asofdate}), 0) - 1)
                         AND DPA.INSTRUMENT_TYPE = 'PHYSICAL'
						 AND DPA.ALLOCATION_TYPE = 'OPEN'
                         AND CURRENT_OPEN_QUANTITY > 0
                  GROUP  BY DPA.POSITION_REF,
                            DPA.INSTRUMENT_TYPE,
                            DPA.ALLOCATION_ID,
                            DPA.PRICING_ID) SPNL_OPEN
              ON SPNL_OPEN.POSITION_REF = A.SALES_POSITION_REFERENCE
                 AND SPNL_OPEN.INSTRUMENT_TYPE = A.INSTRUMENT_TYPE
                 AND Isnull(SPNL_OPEN.PRICING_ID, 'XXX') = Isnull(A.SALES_PRICING_ID, 'XXX')
       LEFT JOIN (SELECT DPA.POSITION_REF,
                         DPA.INSTRUMENT_TYPE,
                         DPA.ALLOCATION_ID,
                         DPA.PRICING_ID,
                         Min(POSITION_DATE)                                                                                                     POSITION_DATE,
                         Max(DPA.CURRENT_PHY_MARKET_PRICE / NULLIF(C.DENOMINATION_FACTOR, 0) / UOM_FACTOR_FROM_MKT_TO_POS)                      MARKET_PRICE,
                         Max(Isnull(DPA.CURRENT_BASIS_MARKET_PRICE, 0) / NULLIF(C.BASIS_DENOMINATION_FACTOR, 0) / UOM_FACTOR_FROM_BASIS_TO_POS) MARKET_BASIS
                  FROM   DAILY_PNL_ATTRIBUTION DPA
                         JOIN DAILY_CONTRACT_DATA C
                           ON C.POSITION_ID = DPA.POSITION_ID
                  WHERE  DPA.EOD_DATE = (SELECT Max(EOD_DATE)
                                         FROM   DAILY_PNL_ATTRIBUTION D
                                         WHERE  D.EOD_DATE <= Dateadd(yy, Datediff(yy, 0, $P{asofdate}), 0) - 1)
                         AND DPA.INSTRUMENT_TYPE = 'PHYSICAL'
                         AND CURRENT_OPEN_QUANTITY > 0
                  GROUP  BY DPA.POSITION_REF,
                            DPA.INSTRUMENT_TYPE,
                            DPA.ALLOCATION_ID,
                            DPA.PRICING_ID) PPNL
              ON PPNL.POSITION_REF = A.PURCH_POSITION_REFERENCE
                 AND PPNL.INSTRUMENT_TYPE = A.INSTRUMENT_TYPE
                 AND Isnull(PPNL.ALLOCATION_ID, 'XXX') = Isnull(A.PURCH_ALLOCATION_ID, 'XXX')
                 AND Isnull(PPNL.PRICING_ID, 'XXX') = Isnull(A.PURCH_PRICING_ID, 'XXX')
				 LEFT JOIN (SELECT DPA.POSITION_REF,
                         DPA.INSTRUMENT_TYPE,
                         DPA.ALLOCATION_ID,
                         DPA.PRICING_ID,
                         Min(POSITION_DATE)                                                                                                     POSITION_DATE,
                         Max(DPA.CURRENT_PHY_MARKET_PRICE / NULLIF(C.DENOMINATION_FACTOR, 0) / UOM_FACTOR_FROM_MKT_TO_POS)                      MARKET_PRICE,
                         Max(Isnull(DPA.CURRENT_BASIS_MARKET_PRICE, 0) / NULLIF(C.BASIS_DENOMINATION_FACTOR, 0) / UOM_FACTOR_FROM_BASIS_TO_POS) MARKET_BASIS
                  FROM   DAILY_PNL_ATTRIBUTION DPA
                         JOIN DAILY_CONTRACT_DATA C
                           ON C.POSITION_ID = DPA.POSITION_ID
                  WHERE  DPA.EOD_DATE = (SELECT Max(EOD_DATE)
                                         FROM   DAILY_PNL_ATTRIBUTION D
                                         WHERE  D.EOD_DATE <= Dateadd(yy, Datediff(yy, 0, $P{asofdate}), 0) - 1)
                         AND DPA.INSTRUMENT_TYPE = 'PHYSICAL'
						 AND DPA.ALLOCATION_TYPE = 'OPEN'
                         AND CURRENT_OPEN_QUANTITY > 0
                  GROUP  BY DPA.POSITION_REF,
                            DPA.INSTRUMENT_TYPE,
                            DPA.ALLOCATION_ID,
                            DPA.PRICING_ID) PPNL_OPEN
              ON PPNL_OPEN.POSITION_REF = A.PURCH_POSITION_REFERENCE
                 AND PPNL_OPEN.INSTRUMENT_TYPE = A.INSTRUMENT_TYPE
                 AND Isnull(PPNL_OPEN.PRICING_ID, 'XXX') = Isnull(A.PURCH_PRICING_ID, 'XXX')
WHERE  A.INSTRUMENT_TYPE = 'PHYSICAL'
       AND A.ALLOCATION_GROUP IN ( 'SHORT UNLINKED', 'LONG UNLINKED' )
       AND A.EOD_DATE = $P{asofdate}
       AND ( (( SALES_EVENT_TYPE = 'BASIS'
                 OR PURCH_EVENT_TYPE = 'BASIS' ))
              OR SALES_EVENT_TYPE = 'COMMODITY'
              OR PURCH_EVENT_TYPE = 'COMMODITY' )
       UNION ALL
       SELECT ASDF.CONTRACT_BOOK,
              NULL                             AS PURCH_TRANSACTION_DATE,
              CASE
                WHEN ASDF.ORIGIN_DATA_TYPE IN ( 'IV', 'PO' ) THEN ASDF.POSITION_ID
              END                              AS PURCHASE_REF_NO,
              CASE
                WHEN ASDF.ORIGIN_DATA_TYPE IN ( 'IV', 'PO' ) THEN ASDF.PROFIT_CENTER
              END                              AS PURCH_UNIT,
              CASE
                WHEN ASDF.ORIGIN_DATA_TYPE IN ( 'IV', 'PO' ) THEN ASDF.COUNTERPARTY_CODE
              END                              AS PURCH_PARTY,
              CASE
                WHEN ASDF.ORIGIN_DATA_TYPE IN ( 'IV', 'PO' ) THEN ASDF.MATERIAL_GROUP
              END                              AS PURCH_PRODUCT,
              CASE
                WHEN ASDF.ORIGIN_DATA_TYPE IN ( 'IV', 'PO' ) THEN ASDF.MATERIAL_CODE
              END                              AS PURCH_GRADE,
              CASE
                WHEN ASDF.ORIGIN_DATA_TYPE IN ( 'IV', 'PO' ) THEN MTHMAP.SHORTNAME
              END                              AS PURCH_SHIPMENT_MONTH,
              NULL                             AS PURCH_EXCH,
              NULL                             AS PURCH_TERMINAL_MONTH,
              NULL                             AS PURCH_STRIKE,
              NULL                             AS PURCH_CONTRACT_TERMS,
              NULL                             AS PURCH_PRICE_TYPE,
              CASE
                WHEN ASDF.ORIGIN_DATA_TYPE IN ( 'IV', 'PO' ) THEN ASDF.QUANTITY
              END                              AS PURCH_QUANTITY,
              CASE
                WHEN ASDF.ORIGIN_DATA_TYPE IN ( 'IV', 'PO' ) THEN ASDF.CONTRACT_UNIT_PRICE_R_UOM
              END                              AS PURCH_CONTRACT_PRICE,
              NULL                             AS PURCH_DIRECT_COST,
              CASE
                WHEN ASDF.ORIGIN_DATA_TYPE IN ( 'IV', 'PO' ) THEN ASDF.QUANTITY * ASDF.CONTRACT_UNIT_PRICE_R_UOM
              END                              AS TOTAL_COST,
              NULL                             AS SALES_TRANSACTION_DATE,
              CASE
                WHEN ASDF.ORIGIN_DATA_TYPE IN ( 'SO' ) THEN ASDF.POSITION_ID
              END                              AS SALES_REF_NO,
              CASE
                WHEN ASDF.ORIGIN_DATA_TYPE IN ( 'SO' ) THEN ASDF.PROFIT_CENTER
              END                              AS SALES_UNIT,
              CASE
                WHEN ASDF.ORIGIN_DATA_TYPE IN ( 'SO' ) THEN ASDF.COUNTERPARTY_CODE
              END                              AS SALES_PARTY,
              CASE
                WHEN ASDF.ORIGIN_DATA_TYPE IN ( 'SO' ) THEN ASDF.MATERIAL_GROUP
              END                              AS SALES_PRODUCT,
              CASE
                WHEN ASDF.ORIGIN_DATA_TYPE IN ( 'SO' ) THEN ASDF.MATERIAL_CODE
              END                              AS SALES_GRADE,
              CASE
                WHEN ASDF.ORIGIN_DATA_TYPE IN ( 'SO' ) THEN MTHMAP.SHORTNAME
              END                              AS SALES_SHIPMENT_MONTH,
              NULL                             AS SALES_EXCH,
              NULL                             AS SALES_TERMINAL_MONTH,
              NULL                             AS SALES_STRIKE,
              NULL                             AS SALES_CONTRACT_TERMS,
              NULL                             AS SALES_PRICE_TYPE,
              CASE
                WHEN ASDF.ORIGIN_DATA_TYPE IN ( 'SO' ) THEN ASDF.QUANTITY
              END                              AS SALES_QUANTITY,
              CASE
                WHEN ASDF.ORIGIN_DATA_TYPE IN ( 'SO' ) THEN ASDF.CONTRACT_UNIT_PRICE_R_UOM
              END                              AS SALES_CONTRACT_PRICE,
              NULL                             AS SALES_DIRECT_COST,
              CASE
                WHEN ASDF.ORIGIN_DATA_TYPE IN ( 'SO' ) THEN ASDF.QUANTITY * ASDF.CONTRACT_UNIT_PRICE_R_UOM
              END                              AS TOTAL_COST,
              ASDF.MARKET_RATE                 AS MARKET_PRICE,
              ASDF.MARKET_RATE * ASDF.QUANTITY  AS MARKET_VALUE,
              ASDF.MARK_TO_MARKET              AS PNL,
              'Physicals'                              AS TRADE_TYPE,
              'Open'                           AS REPORT_STATUS,
              CASE
                WHEN ASDF.ORIGIN_DATA_TYPE IN ( 'PO', 'IV' ) THEN 'Unlinked Purchase - Origin'
                WHEN ASDF.ORIGIN_DATA_TYPE IN ( 'SO' ) THEN 'Unlinked Sales - Origin'
              END                              AS CONTRACT_STATUS,
              CASE ASDF.PRICED_UNPRICED
                WHEN 'Priced' THEN 'Open'
                WHEN 'Unpriced' THEN 'Unpriced'
              END                              AS PRICE_TYPE_STATUS
       FROM   DM_POSITION_DATA ASDF
              JOIN (SELECT ORIGIN_DATA_TYPE,
                           Max(REPORT_DATE) AS REPORT_DATE
                    FROM   DM_POSITION_DATA
                    WHERE  ORIGIN_DATA_TYPE IN ( 'SO', 'PO', 'IV' )
                           AND REPORT_DATE = '1900-01-01'
                    GROUP  BY ORIGIN_DATA_TYPE) ORIGIN_MAX
                ON ASDF.ORIGIN_DATA_TYPE = ORIGIN_MAX.ORIGIN_DATA_TYPE
                   AND ASDF.REPORT_DATE = ORIGIN_MAX.REPORT_DATE
              LEFT JOIN BI_MONTHQUARTERMAPPING MTHMAP
                     ON ASDF.DELIVERY_MONTH_AND_YEAR >= MTHMAP.STARTPERIOD
                        AND ASDF.DELIVERY_MONTH_AND_YEAR <= MTHMAP.ENDPERIOD
       WHERE  ASDF.ORIGIN_DATA_TYPE IN ( 'PO', 'IV', 'SO' )
	   UNION ALL
SELECT SPNL.CONTRACT_BOOK,
       PCD.CONTRACT_DATE                                                                                                                               AS PURCH_TRANSACTION_DATE,
       PPNL.POSITION_REF                                                                                                                               AS PURCHASE_REF_NO,
       PPNL.PROFIT_CENTER                                                                                                                              AS PURCH_UNIT,
       PPNL.COUNTERPARTY                                                                                                                               AS PURCH_PARTY,
       PPNL.COMMODITY                                                                                                                                  AS PURCH_PRODUCT,
       PPNL.SPECIFICATION                                                                                                                              AS PURCH_GRADE,
       PPNL.PHYSICAL_DELIVERY_MONTH                                                                                                                    AS PURCH_SHIPMENT_MONTH,
       C2.FUTURE_EXCHANGE                                                                                                                              AS PURCH_EXCH,
       PPNL.FUTURE_DELIVERY_MONTH                                                                                                                      AS PURCH_TERMINAL_MONTH,
       NULL                                                                                                                                            AS PURCH_STRIKE,
       PPNL.INCOTERM                                                                                                                                   AS PURCH_CONTRACT_TERMS,
       C2.PRICE_TERM                                                                                                                                   AS PURCH_PRICE_TYPE,
       BOOKED_QTY                                                                                                                                      AS PURCH_QUANTITY,
       CASE
         WHEN FIFO.PURCH_STATUS = 'COMMODITY' THEN COALESCE(PPNL.WT_AVG_PRICE * PPNL.CURRENT_POS_TO_RPT_FXRATE / COALESCE(PPNL.UOM_FACTOR_FROM_POS_TO_RPT, 1), 0)
         ELSE
           CASE
             WHEN FIFO.PRICING_STATUS = 'Open' THEN COALESCE(PPNL.CONTRACT_BASIS, 0)
                                                    + COALESCE(PPNL.MKT_PRICE, 0)
             ELSE COALESCE(PPNL.CONTRACT_BASIS, 0)
           END
       END                                                                                                                                             AS PURCH_CONTRACT_PRICE,
       PPNL.SECONDARY_COST * PPNL.CURRENT_POS_TO_RPT_FXRATE / COALESCE(PPNL.UOM_FACTOR_FROM_POS_TO_RPT, 1)                                             AS PURCH_DIRECT_COST,
       ( BOOKED_QTY * ( CASE
                          WHEN FIFO.PURCH_STATUS = 'COMMODITY' THEN COALESCE(PPNL.WT_AVG_PRICE * PPNL.CURRENT_POS_TO_RPT_FXRATE / COALESCE(PPNL.UOM_FACTOR_FROM_POS_TO_RPT, 1), 0)
                          ELSE
                            CASE
                              WHEN FIFO.PRICING_STATUS = 'Open' THEN COALESCE(PPNL.CONTRACT_BASIS, 0)
                                                                     + COALESCE(PPNL.MKT_PRICE, 0)
                              ELSE COALESCE(PPNL.CONTRACT_BASIS, 0)
                            END
                        END ) ) + ( BOOKED_QTY * PPNL.SECONDARY_COST * PPNL.CURRENT_POS_TO_RPT_FXRATE / COALESCE(PPNL.UOM_FACTOR_FROM_POS_TO_RPT, 1) ) AS TOTAL_COST,
       SCD.CONTRACT_DATE                                                                                                                               AS SALES_TRANSACTION_DATE,
       SPNL.POSITION_REF                                                                                                                               AS SALES_REF_NO,
       SPNL.PROFIT_CENTER                                                                                                                              AS SALES_UNIT,
       SPNL.COUNTERPARTY                                                                                                                               AS SALES_PARTY,
       SPNL.COMMODITY                                                                                                                                  AS SALES_PRODUCT,
       SPNL.SPECIFICATION                                                                                                                              AS SALES_GRADE,
       SPNL.PHYSICAL_DELIVERY_MONTH                                                                                                                    AS SALES_SHIPMENT_MONTH,
       C.FUTURE_EXCHANGE                                                                                                                               AS SALES_EXCH,
       SPNL.FUTURE_DELIVERY_MONTH                                                                                                                      AS SALES_TERMINAL_MONTH,
       NULL                                                                                                                                            AS SALES_STRIKE,
       SPNL.INCOTERM                                                                                                                                   AS SALES_CONTRACT_TERMS,
       C.PRICE_TERM                                                                                                                                    AS SALES_PRICE_TYPE,
       BOOKED_QTY                                                                                                                                      AS SALES_QUANTITY,
       CASE
         WHEN FIFO.SALES_STATUS = 'COMMODITY' THEN COALESCE(SPNL.WT_AVG_PRICE * SPNL.CURRENT_POS_TO_RPT_FXRATE / COALESCE(SPNL.UOM_FACTOR_FROM_POS_TO_RPT, 1), 0)
         ELSE
           CASE
             WHEN FIFO.PRICING_STATUS = 'Open' THEN COALESCE(SPNL.CONTRACT_BASIS, 0)
                                                    + COALESCE(SPNL.MKT_PRICE, 0)
             ELSE COALESCE(SPNL.CONTRACT_BASIS, 0)
           END
       END                                                                                                                                             AS SALES_CONTRACT_PRICE,
       SPNL.SECONDARY_COST * SPNL.CURRENT_POS_TO_RPT_FXRATE / COALESCE(SPNL.UOM_FACTOR_FROM_POS_TO_RPT, 1)                                             AS SALES_DIRECT_COST,
       ( BOOKED_QTY * ( CASE
                          WHEN FIFO.SALES_STATUS = 'COMMODITY' THEN COALESCE(SPNL.WT_AVG_PRICE * SPNL.CURRENT_POS_TO_RPT_FXRATE / COALESCE(SPNL.UOM_FACTOR_FROM_POS_TO_RPT, 1), 0)
                          ELSE
                            CASE
                              WHEN FIFO.PRICING_STATUS = 'Open' THEN COALESCE(SPNL.CONTRACT_BASIS, 0)
                                                                     + COALESCE(SPNL.MKT_PRICE, 0)
                              ELSE COALESCE(SPNL.CONTRACT_BASIS, 0)
                            END
                        END ) ) - ( BOOKED_QTY * SPNL.SECONDARY_COST * SPNL.CURRENT_POS_TO_RPT_FXRATE / COALESCE(SPNL.UOM_FACTOR_FROM_POS_TO_RPT, 1) ) AS NET_REALIZATION,
       NULL                                                                                                                                            AS MARKET_PRICE,
       NULL                                                                                                                                            AS MARKET_VALUE,
       CASE FIFO.PRICING_STATUS
         WHEN 'Closed' THEN ( BOOKED_QTY * COALESCE(SPNL.WT_AVG_PRICE, 0) * SPNL.CURRENT_POS_TO_RPT_FXRATE / COALESCE(SPNL.UOM_FACTOR_FROM_POS_TO_RPT, 1) ) - ( BOOKED_QTY * SPNL.SECONDARY_COST * SPNL.CURRENT_POS_TO_RPT_FXRATE / COALESCE(SPNL.UOM_FACTOR_FROM_POS_TO_RPT, 1) ) - ( ( BOOKED_QTY * COALESCE(PPNL.WT_AVG_PRICE, 0) * PPNL.CURRENT_POS_TO_RPT_FXRATE / COALESCE(PPNL.UOM_FACTOR_FROM_POS_TO_RPT, 1) ) + ( BOOKED_QTY * PPNL.SECONDARY_COST * PPNL.CURRENT_POS_TO_RPT_FXRATE / COALESCE(PPNL.UOM_FACTOR_FROM_POS_TO_RPT, 1) ) )
         WHEN 'Open' THEN ( BOOKED_QTY * CASE
                                           WHEN FIFO.SALES_STATUS = 'COMMODITY' THEN ( COALESCE(SPNL.WT_AVG_PRICE, 0) * SPNL.CURRENT_POS_TO_RPT_FXRATE / COALESCE(SPNL.UOM_FACTOR_FROM_POS_TO_RPT, 1) )
                                           ELSE COALESCE(SPNL.CONTRACT_BASIS, 0)
                                                + COALESCE(SPNL.MKT_PRICE, 0)
                                         END ) - ( BOOKED_QTY * CASE
                                                                  WHEN FIFO.PURCH_STATUS = 'COMMODITY' THEN ( COALESCE(PPNL.WT_AVG_PRICE, 0) * PPNL.CURRENT_POS_TO_RPT_FXRATE / COALESCE(PPNL.UOM_FACTOR_FROM_POS_TO_RPT, 1) )
                                                                  ELSE COALESCE(PPNL.CONTRACT_BASIS, 0)
                                                                       + COALESCE(PPNL.MKT_PRICE, 0)
                                                                END ) - ( BOOKED_QTY * SPNL.SECONDARY_COST * SPNL.CURRENT_POS_TO_RPT_FXRATE / COALESCE(SPNL.UOM_FACTOR_FROM_POS_TO_RPT, 1) ) - ( BOOKED_QTY * PPNL.SECONDARY_COST * PPNL.CURRENT_POS_TO_RPT_FXRATE / COALESCE(PPNL.UOM_FACTOR_FROM_POS_TO_RPT, 1) )
         WHEN 'Unpriced' THEN ( BOOKED_QTY * CASE
                                               WHEN FIFO.SALES_STATUS = 'COMMODITY' THEN ( COALESCE(SPNL.WT_AVG_PRICE, 0) * SPNL.CURRENT_POS_TO_RPT_FXRATE / COALESCE(SPNL.UOM_FACTOR_FROM_POS_TO_RPT, 1) )
                                               ELSE COALESCE(SPNL.CONTRACT_BASIS, 0)
                                                    + COALESCE(SPNL.MKT_PRICE, 0)
                                             END ) - ( BOOKED_QTY * CASE
                                                                      WHEN FIFO.PURCH_STATUS = 'COMMODITY' THEN ( COALESCE(PPNL.WT_AVG_PRICE, 0) * PPNL.CURRENT_POS_TO_RPT_FXRATE / COALESCE(PPNL.UOM_FACTOR_FROM_POS_TO_RPT, 1) )
                                                                      ELSE COALESCE(PPNL.CONTRACT_BASIS, 0)
                                                                           + COALESCE(PPNL.MKT_PRICE, 0)
                                                                    END ) - ( BOOKED_QTY * SPNL.SECONDARY_COST * SPNL.CURRENT_POS_TO_RPT_FXRATE / COALESCE(SPNL.UOM_FACTOR_FROM_POS_TO_RPT, 1) ) - ( BOOKED_QTY * PPNL.SECONDARY_COST * PPNL.CURRENT_POS_TO_RPT_FXRATE / COALESCE(PPNL.UOM_FACTOR_FROM_POS_TO_RPT, 1) )
       END                                                                                                                                             AS PNL,
       CASE
         WHEN COALESCE(C.CTR_TYPE, C2.CTR_TYPE) = 'PHYSICAL' THEN 'Physicals'
         WHEN COALESCE(C.CTR_TYPE, C2.CTR_TYPE) = 'PAPER' THEN 'Paper Trades'
       END                                                                                                                                             AS TRADE_TYPE,
       'Closed'                                                                                                                                        AS REPORT_STATUS,
       ALLOCATION_GROUP                                                                                                                                AS CONTRACT_STATUS,
       FIFO.PRICING_STATUS                                                                                                                             AS PRICE_TYPE_STATUS
FROM   (SELECT SALES_ID,
               PURCHASE_ID,
               SALES_ALLOCATION_ID,
               PURCH_ALLOCATION_ID,
               ALLOCATION_GROUP,
               EOD_DATE,
               CASE PRICING_STATUS
                 WHEN 'OPEN_QTY' THEN 'Open'
                 WHEN 'CLOSED_QTY' THEN 'Closed'
                 WHEN 'UNPRICED_QTY' THEN 'Unpriced'
               END      PRICING_STATUS,
               QUANTITY AS BOOKED_QTY,
               CASE PRICING_STATUS
                 WHEN 'CLOSED_QTY' THEN 'COMMODITY'
                 WHEN 'OPEN_QTY' THEN SALES_STATUS
                 WHEN 'UNPRICED_QTY' THEN 'BASIS'
               END      SALES_STATUS,
               CASE PRICING_STATUS
                 WHEN 'CLOSED_QTY' THEN 'COMMODITY'
                 WHEN 'OPEN_QTY' THEN PURCH_STATUS
                 WHEN 'UNPRICED_QTY' THEN 'BASIS'
               END      PURCH_STATUS
        FROM   (SELECT SALES_ID,
                       CASE
                         WHEN SPNL.ALLOCATION_GROUP = PPNL.ALLOCATION_GROUP THEN PPNL.ALLOCATION_GROUP
                         ELSE 'Booked For The Month'
                       END                  ALLOCATION_GROUP,
                       PURCHASE_ID,
                       SALES_ALLOCATION_ID,
                       PURCH_ALLOCATION_ID,
                       EOD_DATE,
                       Cast(0 AS NUMERIC (19,8))   CLOSED_QTY,
                       Cast(CASE
                              WHEN SPNL.TOTAL_FIXED_PRICE_QTY > PPNL.TOTAL_FIXED_PRICE_QTY THEN
                                CASE
                                  WHEN ( SPNL.TOTAL_FIXED_PRICE_QTY - PPNL.TOTAL_FIXED_PRICE_QTY ) > PPNL.TOTAL_PROV_PRICE_QTY THEN PPNL.TOTAL_PROV_PRICE_QTY
                                  ELSE ( SPNL.TOTAL_FIXED_PRICE_QTY - PPNL.TOTAL_FIXED_PRICE_QTY )
                                END
                              ELSE
                                CASE
                                  WHEN ( PPNL.TOTAL_FIXED_PRICE_QTY - SPNL.TOTAL_FIXED_PRICE_QTY ) > SPNL.TOTAL_PROV_PRICE_QTY THEN SPNL.TOTAL_PROV_PRICE_QTY
                                  ELSE ( PPNL.TOTAL_FIXED_PRICE_QTY - SPNL.TOTAL_FIXED_PRICE_QTY )
                                END
                            END AS NUMERIC (19,8)) OPEN_QTY,
                       Cast(CASE
                              WHEN SPNL.TOTAL_FIXED_PRICE_QTY > PPNL.TOTAL_FIXED_PRICE_QTY THEN
                                CASE
                                  WHEN ( SPNL.TOTAL_FIXED_PRICE_QTY - PPNL.TOTAL_FIXED_PRICE_QTY ) > PPNL.TOTAL_PROV_PRICE_QTY THEN 0
                                  ELSE PPNL.TOTAL_PROV_PRICE_QTY - ( SPNL.TOTAL_FIXED_PRICE_QTY - PPNL.TOTAL_FIXED_PRICE_QTY )
                                END
                              ELSE
                                CASE
                                  WHEN ( PPNL.TOTAL_FIXED_PRICE_QTY - SPNL.TOTAL_FIXED_PRICE_QTY ) > SPNL.TOTAL_PROV_PRICE_QTY THEN 0
                                  ELSE SPNL.TOTAL_PROV_PRICE_QTY - ( PPNL.TOTAL_FIXED_PRICE_QTY - SPNL.TOTAL_FIXED_PRICE_QTY )
                                END
                            END AS NUMERIC (19,8)) UNPRICED_QTY,
                       CASE
                         WHEN SPNL.TOTAL_FIXED_PRICE_QTY > PPNL.TOTAL_FIXED_PRICE_QTY THEN 'COMMODITY'
                         ELSE 'BASIS'
                       END                  SALES_STATUS,
                       CASE
                         WHEN PPNL.TOTAL_FIXED_PRICE_QTY > SPNL.TOTAL_FIXED_PRICE_QTY THEN 'COMMODITY'
                         ELSE 'BASIS'
                       END                  PURCH_STATUS
                FROM   (SELECT DISTINCT SALES_ID,
                                        PURCHASE_ID,
                                        ALLOCATION_ID SALES_ALLOCATION_ID,
                                        ALLOCATION_ID PURCH_ALLOCATION_ID,
                                        EOD_DATE
                        FROM   BI_VIEW_BOOK_VALUE_LINKED_FIFO
                        UNION
                        SELECT SALES_POSITION_ID,
                               PURCHASE_POSITION_ID,
                               SALES_ALLOCATION_ID,
                               PURCHASE_ALLOCATION_ID,
                               EOD_DATE
                        FROM   BI_VIEW_BOOK_VALUE_STOCK_MATCH) X
                       JOIN (SELECT POSITION_ID,
                                    ALLOCATION_ID,
                                    LOAD_ID,
                                    CASE
                                      WHEN DOCUMENT_DATE <= B.MONTH_END THEN 'Booked Till Last Month End'
                                      ELSE 'Booked For The Month'
                                    END                        ALLOCATION_GROUP,
                                    Max(DOCUMENT_DATE)         DOCUMENT_DATE,
                                    Max(LOAD_QTY)              LOAD_QTY,
                                    Max(TOTAL_FIXED_PRICE_QTY) TOTAL_FIXED_PRICE_QTY,
                                    Min(TOTAL_PROV_PRICE_QTY)  TOTAL_PROV_PRICE_QTY
                             FROM   (SELECT POSITION_ID,
                                            LOAD_ID,
                                            ALLOCATION_ID,
                                            DOCUMENT_REF,
                                            Max(DOCUMENT_DATE)         DOCUMENT_DATE,
                                            Max(LOAD_QTY)              LOAD_QTY,
                                            Sum(TOTAL_FIXED_PRICE_QTY) TOTAL_FIXED_PRICE_QTY,
                                            Sum(TOTAL_PROV_PRICE_QTY)  TOTAL_PROV_PRICE_QTY
                                     FROM   DUMP_BI_FINANCIAL_LOAD_DETAILS X
                                     GROUP  BY POSITION_ID,
                                               LOAD_ID,
                                               ALLOCATION_ID,
                                               DOCUMENT_REF) D
                                    JOIN (SELECT Dateadd(ss, -1, Dateadd(MONTH, Datediff(MONTH, 0, $P{asofdate}), 0)) MONTH_END) B
                                      ON 1 = 1
                             WHERE  Datepart(yyyy, DOCUMENT_DATE) = Datepart(yyyy, $P{asofdate})
                                    AND DOCUMENT_DATE <= $P{asofdate}
                             GROUP  BY POSITION_ID,
                                       LOAD_ID,
                                       ALLOCATION_ID,
                                       CASE
                                         WHEN DOCUMENT_DATE <= B.MONTH_END THEN 'Booked Till Last Month End'
                                         ELSE 'Booked For The Month'
                                       END) SPNL
                         ON X.SALES_ID = SPNL.POSITION_ID
                            AND X.SALES_ALLOCATION_ID = SPNL.ALLOCATION_ID
                       JOIN (SELECT POSITION_ID,
                                    LOAD_ID,
                                    ALLOCATION_ID,
                                    CASE
                                      WHEN DOCUMENT_DATE <= B.MONTH_END THEN 'Booked Till Last Month End'
                                      ELSE 'Booked For The Month'
                                    END                        ALLOCATION_GROUP,
                                    Max(DOCUMENT_DATE)         DOCUMENT_DATE,
                                    Max(LOAD_QTY)              LOAD_QTY,
                                    Max(TOTAL_FIXED_PRICE_QTY) TOTAL_FIXED_PRICE_QTY,
                                    Min(TOTAL_PROV_PRICE_QTY)  TOTAL_PROV_PRICE_QTY
                             FROM   (SELECT POSITION_ID,
                                            LOAD_ID,
                                            ALLOCATION_ID,
                                            DOCUMENT_REF,
                                            Max(DOCUMENT_DATE)         DOCUMENT_DATE,
                                            Max(LOAD_QTY)              LOAD_QTY,
                                            Sum(TOTAL_FIXED_PRICE_QTY) TOTAL_FIXED_PRICE_QTY,
                                            Sum(TOTAL_PROV_PRICE_QTY)  TOTAL_PROV_PRICE_QTY
                                     FROM   DUMP_BI_FINANCIAL_LOAD_DETAILS X
                                     GROUP  BY POSITION_ID,
                                               LOAD_ID,
                                               ALLOCATION_ID,
                                               DOCUMENT_REF) D
                                    JOIN (SELECT Dateadd(ss, -1, Dateadd(MONTH, Datediff(MONTH, 0, $P{asofdate}), 0)) MONTH_END) B
                                      ON 1 = 1
                             WHERE  Datepart(yyyy, DOCUMENT_DATE) = Datepart(yyyy, $P{asofdate})
                                    AND DOCUMENT_DATE <= $P{asofdate}
                             GROUP  BY POSITION_ID,
                                       LOAD_ID,
                                       ALLOCATION_ID,
                                       CASE
                                         WHEN DOCUMENT_DATE <= B.MONTH_END THEN 'Booked Till Last Month End'
                                         ELSE 'Booked For The Month'
                                       END) PPNL
                         ON X.PURCHASE_ID = PPNL.POSITION_ID
                            AND X.PURCH_ALLOCATION_ID = PPNL.ALLOCATION_ID
                WHERE  EOD_DATE = $P{asofdate}) Z
               UNPIVOT ( QUANTITY
                       FOR PRICING_STATUS IN (CLOSED_QTY,
                                              OPEN_QTY,
                                              UNPRICED_QTY) ) AS UNPVT
        WHERE  QUANTITY > 0) FIFO
       JOIN DAILY_CONTRACT_DATA C2
         ON C2.POSITION_ID = FIFO.PURCHASE_ID
       JOIN DAILY_CONTRACT_DATA C
         ON C.POSITION_ID = FIFO.SALES_ID
       JOIN (SELECT X.POSITION_ID,
                    Min(X.POSITION_DATE)                                                                                                                                                                                                                          POSITION_DATE,
                    X.POSITION_REF,
                    COUNTERPARTY,
                    PHYSICAL_DELIVERY_MONTH,
                    FUTURE_DELIVERY_MONTH,
                    INCOTERM,
                    Avg(CURRENT_POS_TO_RPT_FXRATE)                                                                                                                                                                                                                AS CURRENT_POS_TO_RPT_FXRATE,
                    Avg(UOM_FACTOR_FROM_POS_TO_RPT)                                                                                                                                                                                                               AS UOM_FACTOR_FROM_POS_TO_RPT,
                    Avg(CURRENT_MKT_TO_POS_FXRATE)                                                                                                                                                                                                                AS CURRENT_MKT_TO_POS_FXRATE,
                    EOD_DATE,
                    X.ALLOCATION_ID,
                    PROFIT_CENTER,
                    COMMODITY,
                    SPECIFICATION,
                    CONTRACT_BOOK,
                    COALESCE(Sum(Isnull((COALESCE(Y.MARKET_PRICE, Y_OPEN.MARKET_PRICE) * CURRENT_MKT_TO_POS_FXRATE / Isnull(UOM_FACTOR_FROM_MKT_TO_POS, 1)), CURRENT_POSITION_PRICE) * CURRENT_OPEN_QUANTITY * CASE WHEN X.ALLOCATION_ID = X.PRICING_ID THEN 0 ELSE 1 END) / NULLIF(Sum(CURRENT_OPEN_QUANTITY * CASE WHEN X.ALLOCATION_ID = X.PRICING_ID THEN 0 ELSE 1 END), 0), 0)
                    + COALESCE(Sum(Isnull(((COALESCE(Y.MARKET_BASIS, Y_OPEN.MARKET_BASIS) * CURRENT_BASIS_TO_POS_FXRATE / Isnull(UOM_FACTOR_FROM_BASIS_TO_POS, 1))), CURRENT_POSITION_BASIS) * CURRENT_OPEN_QUANTITY) / NULLIF(Sum(CURRENT_OPEN_QUANTITY), 0), 0) AS WT_AVG_PRICE,
                    Avg(( ( Isnull(CURRENT_BASIS_MARKET_PRICE, 0) / NULLIF(C.BASIS_DENOMINATION_FACTOR, 1) * Isnull(CURRENT_BASIS_TO_POS_FXRATE, 1) / Isnull(UOM_FACTOR_FROM_BASIS_TO_POS, 1) ) * CURRENT_POS_TO_RPT_FXRATE / UOM_FACTOR_FROM_POS_TO_RPT ))       AS BASIS,
                    Avg(( ( CURRENT_PHY_MARKET_PRICE / NULLIF(C.DENOMINATION_FACTOR, 0) * CURRENT_MKT_TO_POS_FXRATE / Isnull(UOM_FACTOR_FROM_MKT_TO_POS, 1) ) * CURRENT_POS_TO_RPT_FXRATE / UOM_FACTOR_FROM_POS_TO_RPT ))                                         AS MKT_PRICE,
                    Isnull(Sum(CURRENT_OPEN_QUANTITY * ( COALESCE(YEAR_TO_DATE_UNIT_FREIGHT_COST, 0)
                                                         + COALESCE(YEAR_TO_DATE_UNIT_OTHER_COST, 0) )) / NULLIF(Sum(CURRENT_OPEN_QUANTITY), 0), 0)                                                                                                                         AS SECONDARY_COST,
                    CASE
                      WHEN Isnull(Sum(CURRENT_OPEN_QUANTITY * Isnull((( COALESCE(Y.MARKET_BASIS, Y_OPEN.MARKET_BASIS) * CURRENT_BASIS_TO_POS_FXRATE / Isnull(UOM_FACTOR_FROM_BASIS_TO_POS, 1) )), CURRENT_POSITION_BASIS) * CURRENT_POS_TO_RPT_FXRATE / COALESCE(UOM_FACTOR_FROM_POS_TO_RPT, 1)) / NULLIF(Sum(CURRENT_OPEN_QUANTITY), 0), 0) = 0 THEN Avg(Isnull((( COALESCE(Y.MARKET_BASIS, Y_OPEN.MARKET_BASIS) * CURRENT_BASIS_TO_POS_FXRATE / Isnull(UOM_FACTOR_FROM_BASIS_TO_POS, 1) )), CURRENT_POSITION_BASIS) * CURRENT_POS_TO_RPT_FXRATE / COALESCE(UOM_FACTOR_FROM_POS_TO_RPT, 1))
                      ELSE Isnull(Sum(CURRENT_OPEN_QUANTITY * Isnull((( COALESCE(Y.MARKET_BASIS, Y_OPEN.MARKET_BASIS) * CURRENT_BASIS_TO_POS_FXRATE / Isnull(UOM_FACTOR_FROM_BASIS_TO_POS, 1) )), CURRENT_POSITION_BASIS) * CURRENT_POS_TO_RPT_FXRATE / COALESCE(UOM_FACTOR_FROM_POS_TO_RPT, 1)) / NULLIF(Sum(CURRENT_OPEN_QUANTITY), 0), 0)
                    END                                                                                                                                                                                                                                           CONTRACT_BASIS,
                    Sum(COALESCE(TOTAL_BOOKED_QUANTITY, 0))                                                                                                                                                                                                       TOTAL_BOOKED_QUANTITY,
                    Sum(COALESCE(TOTAL_PROVISIONAL_BOOKED_QUANTITY, 0))                                                                                                                                                                                           TOTAL_PROVISIONAL_BOOKED_QUANTITY,
                    CASE
                      WHEN Isnull(PRICING_TYPE, 'PRICED') != 'PRICED'
                           AND X.ALLOCATION_ID = X.PRICING_ID THEN 'BASIS'
                      ELSE 'COMMODITY'
                    END                                                                                                                                                                                                                                           STATUS
             FROM   DAILY_PNL_ATTRIBUTION X
                    JOIN DAILY_CONTRACT_DATA C
                      ON C.POSITION_ID = X.POSITION_ID
                    LEFT JOIN (SELECT DPA.POSITION_REF,
                                      DPA.INSTRUMENT_TYPE,
                                      DPA.ALLOCATION_ID,
                                      DPA.PRICING_ID,
                                      Min(POSITION_DATE)                                                                      POSITION_DATE,
                                      Max(DPA.CURRENT_PHY_MARKET_PRICE / NULLIF(C.DENOMINATION_FACTOR, 0))                    MARKET_PRICE,
                                      Max(Isnull(DPA.CURRENT_BASIS_MARKET_PRICE, 0) / NULLIF(C.BASIS_DENOMINATION_FACTOR, 0)) MARKET_BASIS
                               FROM   DAILY_PNL_ATTRIBUTION DPA
                                      JOIN DAILY_CONTRACT_DATA C
                                        ON C.POSITION_ID = DPA.POSITION_ID
                               WHERE  DPA.EOD_DATE = (SELECT Max(EOD_DATE)
                                                      FROM   DAILY_PNL_ATTRIBUTION D
                                                      WHERE  D.EOD_DATE <= Dateadd(yy, Datediff(yy, 0, $P{asofdate}), 0) - 1)
                                      AND NOT EXISTS (SELECT 1
                                                      FROM   DUMP_BI_FINANCIAL_LOAD_DETAILS DBF
                                                      WHERE  DBF.POSITION_ID = DPA.POSITION_ID
                                                             AND DBF.ALLOCATION_ID = DPA.ALLOCATION_ID
                                                             AND DBF.PRICING_ID = DPA.PRICING_ID
                                                             AND DBF.QTY_FIXED_IN_THIS_DOCUMENT > 0
                                                             AND Datepart(yyyy, DBF.DOCUMENT_DATE) = Datepart(yyyy, $P{asofdate}))
                                      AND DPA.INSTRUMENT_TYPE = 'PHYSICAL'
                                      AND CURRENT_OPEN_QUANTITY > 0
                               GROUP  BY DPA.POSITION_REF,
                                         DPA.INSTRUMENT_TYPE,
                                         DPA.ALLOCATION_ID,
                                         DPA.PRICING_ID) Y
                           ON X.POSITION_REF = Y.POSITION_REF
                              AND X.INSTRUMENT_TYPE = Y.INSTRUMENT_TYPE
                              AND Isnull(X.ALLOCATION_ID, 'XXX') = Isnull(Y.ALLOCATION_ID, 'XXX')
                              AND Isnull(X.PRICING_ID, 'XXX') = Isnull(Y.PRICING_ID, 'XXX')
                    LEFT JOIN (SELECT DPA.POSITION_REF,
                                      DPA.INSTRUMENT_TYPE,
                                      DPA.ALLOCATION_ID,
                                      DPA.PRICING_ID,
                                      Min(POSITION_DATE)                                                                      POSITION_DATE,
                                      Max(DPA.CURRENT_PHY_MARKET_PRICE / NULLIF(C.DENOMINATION_FACTOR, 0))                    MARKET_PRICE,
                                      Max(Isnull(DPA.CURRENT_BASIS_MARKET_PRICE, 0) / NULLIF(C.BASIS_DENOMINATION_FACTOR, 0)) MARKET_BASIS
                               FROM   DAILY_PNL_ATTRIBUTION DPA
                                      JOIN DAILY_CONTRACT_DATA C
                                        ON C.POSITION_ID = DPA.POSITION_ID
                               WHERE  DPA.EOD_DATE = (SELECT Max(EOD_DATE)
                                                      FROM   DAILY_PNL_ATTRIBUTION D
                                                      WHERE  D.EOD_DATE <= Dateadd(yy, Datediff(yy, 0, $P{asofdate}), 0) - 1)
                                      AND DPA.INSTRUMENT_TYPE = 'PHYSICAL'
                                      AND DPA.ALLOCATION_TYPE = 'OPEN'
                                      AND CURRENT_OPEN_QUANTITY > 0
                               GROUP  BY DPA.POSITION_REF,
                                         DPA.INSTRUMENT_TYPE,
                                         DPA.ALLOCATION_ID,
                                         DPA.PRICING_ID) Y_OPEN
                           ON X.POSITION_REF = Y_OPEN.POSITION_REF
                              AND X.INSTRUMENT_TYPE = Y_OPEN.INSTRUMENT_TYPE
                              AND Isnull(X.PRICING_ID, 'XXX') = Isnull(Y_OPEN.PRICING_ID, 'XXX')
             WHERE  X.INSTRUMENT_TYPE = 'PHYSICAL'
                    AND X.EOD_DATE = $P{asofdate}
             GROUP  BY X.POSITION_ID,
                       X.POSITION_REF,
                       COUNTERPARTY,
                       PHYSICAL_DELIVERY_MONTH,
                       FUTURE_DELIVERY_MONTH,
                       INCOTERM,
                       EOD_DATE,
                       X.ALLOCATION_ID,
                       PROFIT_CENTER,
                       COMMODITY,
                       SPECIFICATION,
                       CONTRACT_BOOK,
                       CASE
                         WHEN Isnull(PRICING_TYPE, 'PRICED') != 'PRICED'
                              AND X.ALLOCATION_ID = X.PRICING_ID THEN 'BASIS'
                         ELSE 'COMMODITY'
                       END) SPNL
         ON FIFO.SALES_ID = SPNL.POSITION_ID
            AND FIFO.SALES_ALLOCATION_ID = SPNL.ALLOCATION_ID
            AND FIFO.EOD_DATE = SPNL.EOD_DATE
            AND FIFO.SALES_STATUS = SPNL.STATUS
       JOIN (SELECT X.POSITION_ID,
                    Min(X.POSITION_DATE)                                                                                                                                                                                                                          POSITION_DATE,
                    X.POSITION_REF,
                    COUNTERPARTY,
                    PHYSICAL_DELIVERY_MONTH,
                    FUTURE_DELIVERY_MONTH,
                    INCOTERM,
                    Avg(CURRENT_POS_TO_RPT_FXRATE)                                                                                                                                                                                                                AS CURRENT_POS_TO_RPT_FXRATE,
                    Avg(UOM_FACTOR_FROM_POS_TO_RPT)                                                                                                                                                                                                               AS UOM_FACTOR_FROM_POS_TO_RPT,
                    Avg(CURRENT_MKT_TO_POS_FXRATE)                                                                                                                                                                                                                AS CURRENT_MKT_TO_POS_FXRATE,
                    EOD_DATE,
                    X.ALLOCATION_ID,
                    PROFIT_CENTER,
                    COMMODITY,
                    SPECIFICATION,
                    CONTRACT_BOOK,
                    COALESCE(Sum(Isnull((COALESCE(Y.MARKET_PRICE, Y_OPEN.MARKET_PRICE) * CURRENT_MKT_TO_POS_FXRATE / Isnull(UOM_FACTOR_FROM_MKT_TO_POS, 1)), CURRENT_POSITION_PRICE) * CURRENT_OPEN_QUANTITY * CASE WHEN X.ALLOCATION_ID = X.PRICING_ID THEN 0 ELSE 1 END) / NULLIF(Sum(CURRENT_OPEN_QUANTITY * CASE WHEN X.ALLOCATION_ID = X.PRICING_ID THEN 0 ELSE 1 END), 0), 0)
                    + COALESCE(Sum(Isnull(((COALESCE(Y.MARKET_BASIS, Y_OPEN.MARKET_BASIS) * CURRENT_BASIS_TO_POS_FXRATE / Isnull(UOM_FACTOR_FROM_BASIS_TO_POS, 1))), CURRENT_POSITION_BASIS) * CURRENT_OPEN_QUANTITY) / NULLIF(Sum(CURRENT_OPEN_QUANTITY), 0), 0) AS WT_AVG_PRICE,
                    Avg(( ( Isnull(CURRENT_BASIS_MARKET_PRICE, 0) / NULLIF(C.BASIS_DENOMINATION_FACTOR, 1) * Isnull(CURRENT_BASIS_TO_POS_FXRATE, 1) / Isnull(UOM_FACTOR_FROM_BASIS_TO_POS, 1) ) * CURRENT_POS_TO_RPT_FXRATE / UOM_FACTOR_FROM_POS_TO_RPT ))       AS BASIS,
                    Avg(( ( CURRENT_PHY_MARKET_PRICE / NULLIF(C.DENOMINATION_FACTOR, 0) * CURRENT_MKT_TO_POS_FXRATE / Isnull(UOM_FACTOR_FROM_MKT_TO_POS, 1) ) * CURRENT_POS_TO_RPT_FXRATE / UOM_FACTOR_FROM_POS_TO_RPT ))                                         AS MKT_PRICE,
                    Isnull(Sum(CURRENT_OPEN_QUANTITY * ( COALESCE(YEAR_TO_DATE_UNIT_FREIGHT_COST, 0)
                                                         + COALESCE(YEAR_TO_DATE_UNIT_OTHER_COST, 0) )) / NULLIF(Sum(CURRENT_OPEN_QUANTITY), 0), 0)                                                                                                                         AS SECONDARY_COST,
                    CASE
                      WHEN Isnull(Sum(CURRENT_OPEN_QUANTITY * Isnull((( COALESCE(Y.MARKET_BASIS, Y_OPEN.MARKET_BASIS) * CURRENT_BASIS_TO_POS_FXRATE / Isnull(UOM_FACTOR_FROM_BASIS_TO_POS, 1) )), CURRENT_POSITION_BASIS) * CURRENT_POS_TO_RPT_FXRATE / COALESCE(UOM_FACTOR_FROM_POS_TO_RPT, 1)) / NULLIF(Sum(CURRENT_OPEN_QUANTITY), 0), 0) = 0 THEN Avg(Isnull((( COALESCE(Y.MARKET_BASIS, Y_OPEN.MARKET_BASIS) * CURRENT_BASIS_TO_POS_FXRATE / Isnull(UOM_FACTOR_FROM_BASIS_TO_POS, 1) )), CURRENT_POSITION_BASIS) * CURRENT_POS_TO_RPT_FXRATE / COALESCE(UOM_FACTOR_FROM_POS_TO_RPT, 1))
                      ELSE Isnull(Sum(CURRENT_OPEN_QUANTITY * Isnull((( COALESCE(Y.MARKET_BASIS, Y_OPEN.MARKET_BASIS) * CURRENT_BASIS_TO_POS_FXRATE / Isnull(UOM_FACTOR_FROM_BASIS_TO_POS, 1) )), CURRENT_POSITION_BASIS) * CURRENT_POS_TO_RPT_FXRATE / COALESCE(UOM_FACTOR_FROM_POS_TO_RPT, 1)) / NULLIF(Sum(CURRENT_OPEN_QUANTITY), 0), 0)
                    END                                                                                                                                                                                                                                           CONTRACT_BASIS,
                    Sum(COALESCE(TOTAL_BOOKED_QUANTITY, 0))                                                                                                                                                                                                       TOTAL_BOOKED_QUANTITY,
                    Sum(COALESCE(TOTAL_PROVISIONAL_BOOKED_QUANTITY, 0))                                                                                                                                                                                           TOTAL_PROVISIONAL_BOOKED_QUANTITY,
                    CASE
                      WHEN Isnull(PRICING_TYPE, 'PRICED') != 'PRICED'
                           AND X.ALLOCATION_ID = X.PRICING_ID THEN 'BASIS'
                      ELSE 'COMMODITY'
                    END                                                                                                                                                                                                                                           STATUS
             FROM   DAILY_PNL_ATTRIBUTION X
                    JOIN DAILY_CONTRACT_DATA C
                      ON C.POSITION_ID = X.POSITION_ID
                    LEFT JOIN (SELECT DPA.POSITION_REF,
                                      DPA.INSTRUMENT_TYPE,
                                      DPA.ALLOCATION_ID,
                                      DPA.PRICING_ID,
                                      Min(POSITION_DATE)                                                                      POSITION_DATE,
                                      Max(DPA.CURRENT_PHY_MARKET_PRICE / NULLIF(C.DENOMINATION_FACTOR, 0))                    MARKET_PRICE,
                                      Max(Isnull(DPA.CURRENT_BASIS_MARKET_PRICE, 0) / NULLIF(C.BASIS_DENOMINATION_FACTOR, 0)) MARKET_BASIS
                               FROM   DAILY_PNL_ATTRIBUTION DPA
                                      JOIN DAILY_CONTRACT_DATA C
                                        ON C.POSITION_ID = DPA.POSITION_ID
                               WHERE  DPA.EOD_DATE = (SELECT Max(EOD_DATE)
                                                      FROM   DAILY_PNL_ATTRIBUTION D
                                                      WHERE  D.EOD_DATE <= Dateadd(yy, Datediff(yy, 0, $P{asofdate}), 0) - 1)
                                      AND NOT EXISTS (SELECT 1
                                                      FROM   DUMP_BI_FINANCIAL_LOAD_DETAILS DBF
                                                      WHERE  DBF.POSITION_ID = DPA.POSITION_ID
                                                             AND DBF.ALLOCATION_ID = DPA.ALLOCATION_ID
                                                             AND DBF.PRICING_ID = DPA.PRICING_ID
                                                             AND DBF.QTY_FIXED_IN_THIS_DOCUMENT > 0
                                                             AND Datepart(yyyy, DBF.DOCUMENT_DATE) = Datepart(yyyy, $P{asofdate}))
                                      AND DPA.INSTRUMENT_TYPE = 'PHYSICAL'
                                      AND CURRENT_OPEN_QUANTITY > 0
                               GROUP  BY DPA.POSITION_REF,
                                         DPA.INSTRUMENT_TYPE,
                                         DPA.ALLOCATION_ID,
                                         DPA.PRICING_ID) Y
                           ON X.POSITION_REF = Y.POSITION_REF
                              AND X.INSTRUMENT_TYPE = Y.INSTRUMENT_TYPE
                              AND Isnull(X.ALLOCATION_ID, 'XXX') = Isnull(Y.ALLOCATION_ID, 'XXX')
                              AND Isnull(X.PRICING_ID, 'XXX') = Isnull(Y.PRICING_ID, 'XXX')
                    LEFT JOIN (SELECT DPA.POSITION_REF,
                                      DPA.INSTRUMENT_TYPE,
                                      DPA.ALLOCATION_ID,
                                      DPA.PRICING_ID,
                                      Min(POSITION_DATE)                                                                      POSITION_DATE,
                                      Max(DPA.CURRENT_PHY_MARKET_PRICE / NULLIF(C.DENOMINATION_FACTOR, 0))                    MARKET_PRICE,
                                      Max(Isnull(DPA.CURRENT_BASIS_MARKET_PRICE, 0) / NULLIF(C.BASIS_DENOMINATION_FACTOR, 0)) MARKET_BASIS
                               FROM   DAILY_PNL_ATTRIBUTION DPA
                                      JOIN DAILY_CONTRACT_DATA C
                                        ON C.POSITION_ID = DPA.POSITION_ID
                               WHERE  DPA.EOD_DATE = (SELECT Max(EOD_DATE)
                                                      FROM   DAILY_PNL_ATTRIBUTION D
                                                      WHERE  D.EOD_DATE <= Dateadd(yy, Datediff(yy, 0, $P{asofdate}), 0) - 1)
                                      AND DPA.INSTRUMENT_TYPE = 'PHYSICAL'
                                      AND DPA.ALLOCATION_TYPE = 'OPEN'
                                      AND CURRENT_OPEN_QUANTITY > 0
                               GROUP  BY DPA.POSITION_REF,
                                         DPA.INSTRUMENT_TYPE,
                                         DPA.ALLOCATION_ID,
                                         DPA.PRICING_ID) Y_OPEN
                           ON X.POSITION_REF = Y_OPEN.POSITION_REF
                              AND X.INSTRUMENT_TYPE = Y_OPEN.INSTRUMENT_TYPE
                              AND Isnull(X.PRICING_ID, 'XXX') = Isnull(Y_OPEN.PRICING_ID, 'XXX')
             WHERE  X.INSTRUMENT_TYPE = 'PHYSICAL'
                    AND X.EOD_DATE = $P{asofdate}
             GROUP  BY X.POSITION_ID,
                       X.POSITION_REF,
                       COUNTERPARTY,
                       PHYSICAL_DELIVERY_MONTH,
                       FUTURE_DELIVERY_MONTH,
                       INCOTERM,
                       EOD_DATE,
                       X.ALLOCATION_ID,
                       PROFIT_CENTER,
                       COMMODITY,
                       SPECIFICATION,
                       CONTRACT_BOOK,
                       CASE
                         WHEN Isnull(PRICING_TYPE, 'PRICED') != 'PRICED'
                              AND X.ALLOCATION_ID = X.PRICING_ID THEN 'BASIS'
                         ELSE 'COMMODITY'
                       END) PPNL
         ON FIFO.PURCHASE_ID = PPNL.POSITION_ID
            AND FIFO.PURCH_ALLOCATION_ID = PPNL.ALLOCATION_ID
            AND FIFO.EOD_DATE = PPNL.EOD_DATE
            AND FIFO.PURCH_STATUS = PPNL.STATUS
       LEFT JOIN (SELECT POSITION_ID,
                         Min(POSITION_DATE) CONTRACT_DATE
                  FROM   DAILY_PNL_ATTRIBUTION DPAT
                  WHERE  INSTRUMENT_TYPE = 'PHYSICAL'
                  GROUP  BY POSITION_ID) PCD
              ON PCD.POSITION_ID = PPNL.POSITION_ID
       LEFT JOIN (SELECT POSITION_ID,
                         Min(POSITION_DATE) CONTRACT_DATE
                  FROM   DAILY_PNL_ATTRIBUTION DPAT
                  WHERE  INSTRUMENT_TYPE = 'PHYSICAL'
                  GROUP  BY POSITION_ID) SCD
              ON SCD.POSITION_ID = SPNL.POSITION_ID
WHERE  FIFO.EOD_DATE = $P{asofdate}
UNION ALL
SELECT
  SPNL.CONTRACT_BOOK,
  PCD.CONTRACT_DATE AS PURCH_TRANSACTION_DATE,
  PPNL.POSITION_REF AS PURCHASE_REF_NO,
  PPNL.PROFIT_CENTER AS PURCH_UNIT,
  PPNL.COUNTERPARTY AS PURCH_PARTY,
  PPNL.COMMODITY AS PURCH_PRODUCT,
  PPNL.SPECIFICATION AS PURCH_GRADE,
  PPNL.PHYSICAL_DELIVERY_MONTH AS PURCH_SHIPMENT_MONTH,
  C2.FUTURE_EXCHANGE AS PURCH_EXCH,
  PPNL.FUTURE_DELIVERY_MONTH AS PURCH_TERMINAL_MONTH,
  NULL AS PURCH_STRIKE,
  PPNL.INCOTERM AS PURCH_CONTRACT_TERMS,
  C2.PRICE_TERM AS PURCH_PRICE_TYPE,
  (FIFO.QTY - COALESCE(BOOKED_QTY, 0)) AS PURCH_QUANTITY,
  CASE
    WHEN FIFO.PURCH_STATUS = 'COMMODITY' THEN COALESCE(PPNL.WT_AVG_PRICE * PPNL.CURRENT_POS_TO_RPT_FXRATE / COALESCE(PPNL.UOM_FACTOR_FROM_POS_TO_RPT, 1), 0)
    ELSE CASE WHEN FIFO.PRICING_STATUS = 'Open' THEN COALESCE(PPNL.CONTRACT_BASIS, 0) + COALESCE(PPNL.MKT_PRICE, 0) ELSE COALESCE(PPNL.CONTRACT_BASIS, 0) END
  END AS PURCH_CONTRACT_PRICE,
  PPNL.SECONDARY_COST * PPNL.CURRENT_POS_TO_RPT_FXRATE / COALESCE(PPNL.UOM_FACTOR_FROM_POS_TO_RPT, 1) AS PURCH_DIRECT_COST,
  ((FIFO.QTY - COALESCE(BOOKED_QTY, 0)) * (CASE
    WHEN FIFO.PURCH_STATUS = 'COMMODITY' THEN COALESCE(PPNL.WT_AVG_PRICE * PPNL.CURRENT_POS_TO_RPT_FXRATE / COALESCE(PPNL.UOM_FACTOR_FROM_POS_TO_RPT, 1), 0)
    ELSE CASE WHEN FIFO.PRICING_STATUS = 'Open' THEN COALESCE(PPNL.CONTRACT_BASIS, 0) + COALESCE(PPNL.MKT_PRICE, 0) ELSE COALESCE(PPNL.CONTRACT_BASIS, 0) END
  END)) + ((FIFO.QTY - COALESCE(BOOKED_QTY, 0)) * PPNL.SECONDARY_COST * PPNL.CURRENT_POS_TO_RPT_FXRATE / COALESCE(PPNL.UOM_FACTOR_FROM_POS_TO_RPT, 1))
  AS TOTAL_COST,
  SCD.CONTRACT_DATE AS SALES_TRANSACTION_DATE,
  SPNL.POSITION_REF AS SALES_REF_NO,
  SPNL.PROFIT_CENTER AS SALES_UNIT,
  SPNL.COUNTERPARTY AS SALES_PARTY,
  SPNL.COMMODITY AS SALES_PRODUCT,
  SPNL.SPECIFICATION AS SALES_GRADE,
  SPNL.PHYSICAL_DELIVERY_MONTH AS SALES_SHIPMENT_MONTH,
  C.FUTURE_EXCHANGE AS SALES_EXCH,
  SPNL.FUTURE_DELIVERY_MONTH AS SALES_TERMINAL_MONTH,
  NULL AS SALES_STRIKE,
  SPNL.INCOTERM AS SALES_CONTRACT_TERMS,
  C.PRICE_TERM AS SALES_PRICE_TYPE,
  (FIFO.QTY - COALESCE(BOOKED_QTY, 0)) AS SALES_QUANTITY,
  CASE
    WHEN FIFO.SALES_STATUS = 'COMMODITY' THEN COALESCE(SPNL.WT_AVG_PRICE * SPNL.CURRENT_POS_TO_RPT_FXRATE / COALESCE(SPNL.UOM_FACTOR_FROM_POS_TO_RPT, 1), 0)
    ELSE CASE WHEN FIFO.PRICING_STATUS = 'Open' THEN COALESCE(SPNL.CONTRACT_BASIS, 0) + COALESCE(SPNL.MKT_PRICE, 0) ELSE COALESCE(SPNL.CONTRACT_BASIS, 0) END
  END AS SALES_CONTRACT_PRICE,
  SPNL.SECONDARY_COST * SPNL.CURRENT_POS_TO_RPT_FXRATE / COALESCE(SPNL.UOM_FACTOR_FROM_POS_TO_RPT, 1) AS SALES_DIRECT_COST,
  ((FIFO.QTY - COALESCE(BOOKED_QTY, 0)) * (CASE
    WHEN FIFO.SALES_STATUS = 'COMMODITY' THEN COALESCE(SPNL.WT_AVG_PRICE * SPNL.CURRENT_POS_TO_RPT_FXRATE / COALESCE(SPNL.UOM_FACTOR_FROM_POS_TO_RPT, 1), 0)
    ELSE CASE WHEN FIFO.PRICING_STATUS = 'Open' THEN COALESCE(SPNL.CONTRACT_BASIS, 0) + COALESCE(SPNL.MKT_PRICE, 0) ELSE COALESCE(SPNL.CONTRACT_BASIS, 0) END
  END)) - ((FIFO.QTY - COALESCE(BOOKED_QTY, 0)) * SPNL.SECONDARY_COST * SPNL.CURRENT_POS_TO_RPT_FXRATE / COALESCE(SPNL.UOM_FACTOR_FROM_POS_TO_RPT, 1)) AS NET_REALIZATION,
  NULL AS MARKET_PRICE,
  NULL AS MARKET_VALUE,
  CASE FIFO.PRICING_STATUS
    WHEN 'Closed' THEN ((FIFO.QTY - COALESCE(BOOKED_QTY, 0)) * COALESCE(SPNL.WT_AVG_PRICE, 0) * SPNL.CURRENT_POS_TO_RPT_FXRATE / COALESCE(SPNL.UOM_FACTOR_FROM_POS_TO_RPT, 1)) - ((FIFO.QTY - COALESCE(BOOKED_QTY, 0)) * SPNL.SECONDARY_COST * SPNL.CURRENT_POS_TO_RPT_FXRATE / COALESCE(SPNL.UOM_FACTOR_FROM_POS_TO_RPT, 1)) -
      (((FIFO.QTY - COALESCE(BOOKED_QTY, 0)) * COALESCE(PPNL.WT_AVG_PRICE, 0) * PPNL.CURRENT_POS_TO_RPT_FXRATE / COALESCE(PPNL.UOM_FACTOR_FROM_POS_TO_RPT, 1)) + ((FIFO.QTY - COALESCE(BOOKED_QTY, 0)) * PPNL.SECONDARY_COST * PPNL.CURRENT_POS_TO_RPT_FXRATE / COALESCE(PPNL.UOM_FACTOR_FROM_POS_TO_RPT, 1)))
    WHEN 'Open' THEN ((FIFO.QTY - COALESCE(BOOKED_QTY, 0)) * CASE
        WHEN FIFO.SALES_STATUS = 'COMMODITY' THEN (COALESCE(SPNL.WT_AVG_PRICE, 0) * SPNL.CURRENT_POS_TO_RPT_FXRATE / COALESCE(SPNL.UOM_FACTOR_FROM_POS_TO_RPT, 1))
        ELSE COALESCE(SPNL.CONTRACT_BASIS, 0)
          + COALESCE(SPNL.MKT_PRICE, 0)
      END) - ((FIFO.QTY - COALESCE(BOOKED_QTY, 0)) * CASE
        WHEN FIFO.PURCH_STATUS = 'COMMODITY' THEN (COALESCE(PPNL.WT_AVG_PRICE, 0) * PPNL.CURRENT_POS_TO_RPT_FXRATE / COALESCE(PPNL.UOM_FACTOR_FROM_POS_TO_RPT, 1))
        ELSE COALESCE(PPNL.CONTRACT_BASIS, 0)
          + COALESCE(PPNL.MKT_PRICE, 0)
      END) - ((FIFO.QTY - COALESCE(BOOKED_QTY, 0)) * SPNL.SECONDARY_COST * SPNL.CURRENT_POS_TO_RPT_FXRATE / COALESCE(SPNL.UOM_FACTOR_FROM_POS_TO_RPT, 1)) - ((FIFO.QTY - COALESCE(BOOKED_QTY, 0)) * PPNL.SECONDARY_COST * PPNL.CURRENT_POS_TO_RPT_FXRATE / COALESCE(PPNL.UOM_FACTOR_FROM_POS_TO_RPT, 1))
    WHEN 'Unpriced' THEN ((FIFO.QTY - COALESCE(BOOKED_QTY, 0)) * CASE
        WHEN FIFO.SALES_STATUS = 'COMMODITY' THEN (COALESCE(SPNL.WT_AVG_PRICE, 0) * SPNL.CURRENT_POS_TO_RPT_FXRATE / COALESCE(SPNL.UOM_FACTOR_FROM_POS_TO_RPT, 1))
        ELSE COALESCE(SPNL.CONTRACT_BASIS, 0)
          + COALESCE(SPNL.MKT_PRICE, 0)
      END) - ((FIFO.QTY - COALESCE(BOOKED_QTY, 0)) * CASE
        WHEN FIFO.PURCH_STATUS = 'COMMODITY' THEN (COALESCE(PPNL.WT_AVG_PRICE, 0) * PPNL.CURRENT_POS_TO_RPT_FXRATE / COALESCE(PPNL.UOM_FACTOR_FROM_POS_TO_RPT, 1))
        ELSE COALESCE(PPNL.CONTRACT_BASIS, 0)
          + COALESCE(PPNL.MKT_PRICE, 0)
      END) - ((FIFO.QTY - COALESCE(BOOKED_QTY, 0)) * SPNL.SECONDARY_COST * SPNL.CURRENT_POS_TO_RPT_FXRATE / COALESCE(SPNL.UOM_FACTOR_FROM_POS_TO_RPT, 1)) - ((FIFO.QTY - COALESCE(BOOKED_QTY, 0)) * PPNL.SECONDARY_COST * PPNL.CURRENT_POS_TO_RPT_FXRATE / COALESCE(PPNL.UOM_FACTOR_FROM_POS_TO_RPT, 1))
  END AS PNL,
  CASE
    WHEN COALESCE(C.CTR_TYPE, C2.CTR_TYPE) = 'PHYSICAL' THEN 'Physicals'
    WHEN COALESCE(C.CTR_TYPE, C2.CTR_TYPE) = 'PAPER' THEN 'Paper Trades'
  END AS TRADE_TYPE,
  'Closed' AS REPORT_STATUS,
  'Linked' AS CONTRACT_STATUS,
  FIFO.PRICING_STATUS AS PRICE_TYPE_STATUS
FROM (SELECT
  SALES_ID,
  PURCHASE_ID,
  ALLOCATION_ID SALES_ALLOCATION_ID,
  ALLOCATION_ID PURCHASE_ALLOCATION_ID,
  EOD_DATE,
  QTY,
  PRICING_STATUS,
  SALES_STATUS,
  PURCH_STATUS
FROM BI_VIEW_BOOK_VALUE_LINKED_FIFO
UNION ALL
SELECT
  SALES_POSITION_ID,
  PURCHASE_POSITION_ID,
  SALES_ALLOCATION_ID,
  PURCHASE_ALLOCATION_ID,
  EOD_DATE,
  SUM(QUANTITY) QUANTITY,
  PRICING_STATUS,
  SALES_STATUS,
  PURCH_STATUS
FROM BI_VIEW_BOOK_VALUE_STOCK_MATCH
GROUP BY SALES_POSITION_ID,
         PURCHASE_POSITION_ID,
         SALES_ALLOCATION_ID,
         PURCHASE_ALLOCATION_ID,
         EOD_DATE,
         PRICING_STATUS,
         SALES_STATUS,
         PURCH_STATUS) FIFO
JOIN DAILY_CONTRACT_DATA C2
  ON C2.POSITION_ID = FIFO.PURCHASE_ID
JOIN DAILY_CONTRACT_DATA C
  ON C.POSITION_ID = FIFO.SALES_ID
JOIN (SELECT
  X.POSITION_ID,
                            Min(X.POSITION_DATE)                                                                                                                                                                                                                    POSITION_DATE,
                            X.POSITION_REF,
                            COUNTERPARTY,
                            PHYSICAL_DELIVERY_MONTH,
                            FUTURE_DELIVERY_MONTH,
                            INCOTERM,
                            Avg(CURRENT_POS_TO_RPT_FXRATE)                                                                                                                                                                                                          AS CURRENT_POS_TO_RPT_FXRATE,
                            Avg(UOM_FACTOR_FROM_POS_TO_RPT)                                                                                                                                                                                                         AS UOM_FACTOR_FROM_POS_TO_RPT,
                            Avg(CURRENT_MKT_TO_POS_FXRATE)                                                                                                                                                                                                          AS CURRENT_MKT_TO_POS_FXRATE,
                            EOD_DATE,
                            X.ALLOCATION_ID,
                            PROFIT_CENTER,
                            COMMODITY,
                            SPECIFICATION,
                            CONTRACT_BOOK,
                            COALESCE(Sum(Isnull((COALESCE(Y.MARKET_PRICE, Y_OPEN.MARKET_PRICE) * CURRENT_MKT_TO_POS_FXRATE / Isnull(UOM_FACTOR_FROM_MKT_TO_POS, 1)), CURRENT_POSITION_PRICE) * CURRENT_OPEN_QUANTITY * CASE WHEN X.ALLOCATION_ID = X.PRICING_ID THEN 0 ELSE 1 END) / NULLIF(Sum(CURRENT_OPEN_QUANTITY * CASE WHEN X.ALLOCATION_ID = X.PRICING_ID THEN 0 ELSE 1 END), 0), 0)
                            + COALESCE(Sum(Isnull(((COALESCE(Y.MARKET_BASIS, Y_OPEN.MARKET_BASIS) * CURRENT_BASIS_TO_POS_FXRATE / Isnull(UOM_FACTOR_FROM_BASIS_TO_POS, 1))), CURRENT_POSITION_BASIS) * CURRENT_OPEN_QUANTITY) / NULLIF(Sum(CURRENT_OPEN_QUANTITY), 0), 0)                          AS WT_AVG_PRICE,
                            Avg(( ( Isnull(CURRENT_BASIS_MARKET_PRICE, 0) / NULLIF(C.BASIS_DENOMINATION_FACTOR, 1) * Isnull(CURRENT_BASIS_TO_POS_FXRATE, 1) / Isnull(UOM_FACTOR_FROM_BASIS_TO_POS, 1) ) * CURRENT_POS_TO_RPT_FXRATE / UOM_FACTOR_FROM_POS_TO_RPT )) AS BASIS,
                            Avg(( ( CURRENT_PHY_MARKET_PRICE / NULLIF(C.DENOMINATION_FACTOR, 0) * CURRENT_MKT_TO_POS_FXRATE / Isnull(UOM_FACTOR_FROM_MKT_TO_POS, 1) ) * CURRENT_POS_TO_RPT_FXRATE / UOM_FACTOR_FROM_POS_TO_RPT ))                                   AS MKT_PRICE,
                            Isnull(Sum(CURRENT_OPEN_QUANTITY * ( COALESCE(YEAR_TO_DATE_UNIT_FREIGHT_COST, 0)
                                                                 + COALESCE(YEAR_TO_DATE_UNIT_OTHER_COST, 0) )) / NULLIF(Sum(CURRENT_OPEN_QUANTITY), 0), 0)                                                                                                                   AS SECONDARY_COST,
                            CASE
                              WHEN Isnull(Sum(CURRENT_OPEN_QUANTITY * Isnull((( COALESCE(Y.MARKET_BASIS, Y_OPEN.MARKET_BASIS) * CURRENT_BASIS_TO_POS_FXRATE / Isnull(UOM_FACTOR_FROM_BASIS_TO_POS, 1) )), CURRENT_POSITION_BASIS) * CURRENT_POS_TO_RPT_FXRATE / COALESCE(UOM_FACTOR_FROM_POS_TO_RPT, 1)) / NULLIF(Sum(CURRENT_OPEN_QUANTITY), 0), 0) = 0 THEN Avg(Isnull((( COALESCE(Y.MARKET_BASIS, Y_OPEN.MARKET_BASIS) * CURRENT_BASIS_TO_POS_FXRATE / Isnull(UOM_FACTOR_FROM_BASIS_TO_POS, 1) )), CURRENT_POSITION_BASIS) * CURRENT_POS_TO_RPT_FXRATE / COALESCE(UOM_FACTOR_FROM_POS_TO_RPT, 1))
                              ELSE Isnull(Sum(CURRENT_OPEN_QUANTITY * Isnull((( COALESCE(Y.MARKET_BASIS, Y_OPEN.MARKET_BASIS) * CURRENT_BASIS_TO_POS_FXRATE / Isnull(UOM_FACTOR_FROM_BASIS_TO_POS, 1) )), CURRENT_POSITION_BASIS) * CURRENT_POS_TO_RPT_FXRATE / COALESCE(UOM_FACTOR_FROM_POS_TO_RPT, 1)) / NULLIF(Sum(CURRENT_OPEN_QUANTITY), 0), 0)
                            END                                                                                                                                                                                                                                     CONTRACT_BASIS,
                            Sum(COALESCE(TOTAL_BOOKED_QUANTITY, 0))                                                                                                                                                                                                 TOTAL_BOOKED_QUANTITY,
                            Sum(COALESCE(TOTAL_PROVISIONAL_BOOKED_QUANTITY, 0))                                                                                                                                                                                     TOTAL_PROVISIONAL_BOOKED_QUANTITY,
                            CASE
                              WHEN Isnull(PRICING_TYPE, 'PRICED') != 'PRICED'
                                   AND X.ALLOCATION_ID = X.PRICING_ID THEN 'BASIS'
                              ELSE 'COMMODITY'
                            END STATUS
FROM DAILY_PNL_ATTRIBUTION X
JOIN DAILY_CONTRACT_DATA C
  ON C.POSITION_ID = X.POSITION_ID
LEFT JOIN (SELECT
  DPA.POSITION_REF,
  DPA.INSTRUMENT_TYPE,
  DPA.ALLOCATION_ID,
  DPA.PRICING_ID,
  MIN(POSITION_DATE) POSITION_DATE,
  MAX(DPA.CURRENT_PHY_MARKET_PRICE / NULLIF(C.DENOMINATION_FACTOR, 0)) MARKET_PRICE,
  MAX(ISNULL(DPA.CURRENT_BASIS_MARKET_PRICE, 0) / NULLIF(C.BASIS_DENOMINATION_FACTOR, 0)) MARKET_BASIS
FROM DAILY_PNL_ATTRIBUTION DPA
JOIN DAILY_CONTRACT_DATA C
  ON C.POSITION_ID = DPA.POSITION_ID
WHERE DPA.EOD_DATE = (SELECT
  MAX(EOD_DATE)
FROM DAILY_PNL_ATTRIBUTION D
WHERE D.EOD_DATE <= DATEADD(yy, DATEDIFF(yy, 0, $P{asofdate}), 0) - 1)
AND DPA.INSTRUMENT_TYPE = 'PHYSICAL'
AND CURRENT_OPEN_QUANTITY > 0
GROUP BY DPA.POSITION_REF,
         DPA.INSTRUMENT_TYPE,
         DPA.ALLOCATION_ID,
         DPA.PRICING_ID) Y
  ON X.POSITION_REF = Y.POSITION_REF
  AND X.INSTRUMENT_TYPE = Y.INSTRUMENT_TYPE
  AND ISNULL(X.ALLOCATION_ID,'XXX') = ISNULL(Y.ALLOCATION_ID,'XXX')
  AND ISNULL(X.PRICING_ID,'XXX') = ISNULL(Y.PRICING_ID,'XXX')
  LEFT JOIN (SELECT DPA.POSITION_REF,
                                              DPA.INSTRUMENT_TYPE,
                                              DPA.ALLOCATION_ID,
                                              DPA.PRICING_ID,
                                              Min(POSITION_DATE)                                                                      POSITION_DATE,
                                              Max(DPA.CURRENT_PHY_MARKET_PRICE / NULLIF(C.DENOMINATION_FACTOR, 0))                    MARKET_PRICE,
                                              Max(Isnull(DPA.CURRENT_BASIS_MARKET_PRICE, 0) / NULLIF(C.BASIS_DENOMINATION_FACTOR, 0)) MARKET_BASIS
                                       FROM   DAILY_PNL_ATTRIBUTION DPA
                                              JOIN DAILY_CONTRACT_DATA C
                                                ON C.POSITION_ID = DPA.POSITION_ID
                                       WHERE  DPA.EOD_DATE = (SELECT Max(EOD_DATE)
                                                              FROM   DAILY_PNL_ATTRIBUTION D
                                                              WHERE  D.EOD_DATE <= Dateadd(yy, Datediff(yy, 0, $P{asofdate}), 0) - 1)
                                              AND DPA.INSTRUMENT_TYPE = 'PHYSICAL'
											  AND DPA.ALLOCATION_TYPE = 'OPEN'
                                              AND CURRENT_OPEN_QUANTITY > 0
                                       GROUP  BY DPA.POSITION_REF,
                                                 DPA.INSTRUMENT_TYPE,
                                                 DPA.ALLOCATION_ID,
                                                 DPA.PRICING_ID) Y_OPEN
                                   ON X.POSITION_REF = Y_OPEN.POSITION_REF
                                      AND X.INSTRUMENT_TYPE = Y_OPEN.INSTRUMENT_TYPE
                                      AND Isnull(X.PRICING_ID, 'XXX') = Isnull(Y_OPEN.PRICING_ID, 'XXX')
WHERE X.INSTRUMENT_TYPE = 'PHYSICAL'
AND X.EOD_DATE = $P{asofdate}
GROUP BY X.POSITION_ID,
         X.POSITION_REF,
         COUNTERPARTY,
         PHYSICAL_DELIVERY_MONTH,
         FUTURE_DELIVERY_MONTH,
         INCOTERM,
         EOD_DATE,
         X.ALLOCATION_ID,
         PROFIT_CENTER,
         COMMODITY,
         SPECIFICATION,
         CONTRACT_BOOK,
         CASE
           WHEN ISNULL(PRICING_TYPE, 'PRICED') != 'PRICED' AND
             X.ALLOCATION_ID = X.PRICING_ID THEN 'BASIS'
           ELSE 'COMMODITY'
         END) SPNL
  ON FIFO.SALES_ID = SPNL.POSITION_ID
  AND FIFO.SALES_ALLOCATION_ID = SPNL.ALLOCATION_ID
  AND FIFO.EOD_DATE = SPNL.EOD_DATE
  AND FIFO.SALES_STATUS = SPNL.STATUS
JOIN (SELECT
  X.POSITION_ID,
       Min(X.POSITION_DATE)                                                                                                                                                                                                                    POSITION_DATE,
       X.POSITION_REF,
       COUNTERPARTY,
       PHYSICAL_DELIVERY_MONTH,
       FUTURE_DELIVERY_MONTH,
       INCOTERM,
       Avg(CURRENT_POS_TO_RPT_FXRATE)                                                                                                                                                                                                          AS CURRENT_POS_TO_RPT_FXRATE,
       Avg(UOM_FACTOR_FROM_POS_TO_RPT)                                                                                                                                                                                                         AS UOM_FACTOR_FROM_POS_TO_RPT,
       Avg(CURRENT_MKT_TO_POS_FXRATE)                                                                                                                                                                                                          AS CURRENT_MKT_TO_POS_FXRATE,
       EOD_DATE,
       X.ALLOCATION_ID,
       PROFIT_CENTER,
       COMMODITY,
       SPECIFICATION,
       CONTRACT_BOOK,
       COALESCE(Sum(Isnull((COALESCE(Y.MARKET_PRICE, Y_OPEN.MARKET_PRICE) * CURRENT_MKT_TO_POS_FXRATE / Isnull(UOM_FACTOR_FROM_MKT_TO_POS, 1)), CURRENT_POSITION_PRICE) * CURRENT_OPEN_QUANTITY * CASE WHEN X.ALLOCATION_ID = X.PRICING_ID THEN 0 ELSE 1 END) / NULLIF(Sum(CURRENT_OPEN_QUANTITY * CASE WHEN X.ALLOCATION_ID = X.PRICING_ID THEN 0 ELSE 1 END), 0), 0)
       + COALESCE(Sum(Isnull(((COALESCE(Y.MARKET_BASIS, Y_OPEN.MARKET_BASIS) * CURRENT_BASIS_TO_POS_FXRATE / Isnull(UOM_FACTOR_FROM_BASIS_TO_POS, 1))), CURRENT_POSITION_BASIS) * CURRENT_OPEN_QUANTITY) / NULLIF(Sum(CURRENT_OPEN_QUANTITY), 0), 0)                          AS WT_AVG_PRICE,
       Avg(( ( Isnull(CURRENT_BASIS_MARKET_PRICE, 0) / NULLIF(C.BASIS_DENOMINATION_FACTOR, 1) * Isnull(CURRENT_BASIS_TO_POS_FXRATE, 1) / Isnull(UOM_FACTOR_FROM_BASIS_TO_POS, 1) ) * CURRENT_POS_TO_RPT_FXRATE / UOM_FACTOR_FROM_POS_TO_RPT )) AS BASIS,
       Avg(( ( CURRENT_PHY_MARKET_PRICE / NULLIF(C.DENOMINATION_FACTOR, 0) * CURRENT_MKT_TO_POS_FXRATE / Isnull(UOM_FACTOR_FROM_MKT_TO_POS, 1) ) * CURRENT_POS_TO_RPT_FXRATE / UOM_FACTOR_FROM_POS_TO_RPT ))                                   AS MKT_PRICE,
       Isnull(Sum(CURRENT_OPEN_QUANTITY * ( COALESCE(YEAR_TO_DATE_UNIT_FREIGHT_COST, 0)
                                            + COALESCE(YEAR_TO_DATE_UNIT_OTHER_COST, 0) )) / NULLIF(Sum(CURRENT_OPEN_QUANTITY), 0), 0)                                                                                                                   AS SECONDARY_COST,
       CASE
         WHEN Isnull(Sum(CURRENT_OPEN_QUANTITY * Isnull((( COALESCE(Y.MARKET_BASIS, Y_OPEN.MARKET_BASIS) * CURRENT_BASIS_TO_POS_FXRATE / Isnull(UOM_FACTOR_FROM_BASIS_TO_POS, 1) )), CURRENT_POSITION_BASIS) * CURRENT_POS_TO_RPT_FXRATE / COALESCE(UOM_FACTOR_FROM_POS_TO_RPT, 1)) / NULLIF(Sum(CURRENT_OPEN_QUANTITY), 0), 0) = 0 THEN Avg(Isnull((( COALESCE(Y.MARKET_BASIS, Y_OPEN.MARKET_BASIS) * CURRENT_BASIS_TO_POS_FXRATE / Isnull(UOM_FACTOR_FROM_BASIS_TO_POS, 1) )), CURRENT_POSITION_BASIS) * CURRENT_POS_TO_RPT_FXRATE / COALESCE(UOM_FACTOR_FROM_POS_TO_RPT, 1))
         ELSE Isnull(Sum(CURRENT_OPEN_QUANTITY * Isnull((( COALESCE(Y.MARKET_BASIS, Y_OPEN.MARKET_BASIS) * CURRENT_BASIS_TO_POS_FXRATE / Isnull(UOM_FACTOR_FROM_BASIS_TO_POS, 1) )), CURRENT_POSITION_BASIS) * CURRENT_POS_TO_RPT_FXRATE / COALESCE(UOM_FACTOR_FROM_POS_TO_RPT, 1)) / NULLIF(Sum(CURRENT_OPEN_QUANTITY), 0), 0)
       END                                                                                                                                                                                                                                     CONTRACT_BASIS,
       Sum(COALESCE(TOTAL_BOOKED_QUANTITY, 0))                                                                                                                                                                                                 TOTAL_BOOKED_QUANTITY,
       Sum(COALESCE(TOTAL_PROVISIONAL_BOOKED_QUANTITY, 0))                                                                                                                                                                                     TOTAL_PROVISIONAL_BOOKED_QUANTITY,
       CASE
         WHEN Isnull(PRICING_TYPE, 'PRICED') != 'PRICED'
              AND X.ALLOCATION_ID = X.PRICING_ID THEN 'BASIS'
         ELSE 'COMMODITY'
       END STATUS
FROM DAILY_PNL_ATTRIBUTION X
JOIN DAILY_CONTRACT_DATA C
  ON C.POSITION_ID = X.POSITION_ID
LEFT JOIN (SELECT
  DPA.POSITION_REF,
  DPA.INSTRUMENT_TYPE,
  DPA.ALLOCATION_ID,
  DPA.PRICING_ID,
  MIN(POSITION_DATE) POSITION_DATE,
  MAX(DPA.CURRENT_PHY_MARKET_PRICE / NULLIF(C.DENOMINATION_FACTOR, 0)) MARKET_PRICE,
  MAX(ISNULL(DPA.CURRENT_BASIS_MARKET_PRICE, 0) / NULLIF(C.BASIS_DENOMINATION_FACTOR, 0)) MARKET_BASIS
FROM DAILY_PNL_ATTRIBUTION DPA
JOIN DAILY_CONTRACT_DATA C
  ON C.POSITION_ID = DPA.POSITION_ID
WHERE DPA.EOD_DATE = (SELECT
  MAX(EOD_DATE)
FROM DAILY_PNL_ATTRIBUTION D
WHERE D.EOD_DATE <= DATEADD(yy, DATEDIFF(yy, 0, $P{asofdate}), 0) - 1)
AND DPA.INSTRUMENT_TYPE = 'PHYSICAL'
AND CURRENT_OPEN_QUANTITY > 0
GROUP BY DPA.POSITION_REF,
         DPA.INSTRUMENT_TYPE,
         DPA.ALLOCATION_ID,
         DPA.PRICING_ID) Y
  ON X.POSITION_REF = Y.POSITION_REF
  AND X.INSTRUMENT_TYPE = Y.INSTRUMENT_TYPE
  AND ISNULL(X.ALLOCATION_ID,'XXX') = ISNULL(Y.ALLOCATION_ID,'XXX')
  AND ISNULL(X.PRICING_ID,'XXX') = ISNULL(Y.PRICING_ID,'XXX')
  LEFT JOIN (SELECT DPA.POSITION_REF,
                         DPA.INSTRUMENT_TYPE,
                         DPA.ALLOCATION_ID,
                         DPA.PRICING_ID,
                         Min(POSITION_DATE)                                                                      POSITION_DATE,
                         Max(DPA.CURRENT_PHY_MARKET_PRICE / NULLIF(C.DENOMINATION_FACTOR, 0))                    MARKET_PRICE,
                         Max(Isnull(DPA.CURRENT_BASIS_MARKET_PRICE, 0) / NULLIF(C.BASIS_DENOMINATION_FACTOR, 0)) MARKET_BASIS
                  FROM   DAILY_PNL_ATTRIBUTION DPA
                         JOIN DAILY_CONTRACT_DATA C
                           ON C.POSITION_ID = DPA.POSITION_ID
                  WHERE  DPA.EOD_DATE = (SELECT Max(EOD_DATE)
                                         FROM   DAILY_PNL_ATTRIBUTION D
                                         WHERE  D.EOD_DATE <= Dateadd(yy, Datediff(yy, 0, $P{asofdate}), 0) - 1)
                         AND DPA.INSTRUMENT_TYPE = 'PHYSICAL'
                         AND DPA.ALLOCATION_TYPE = 'OPEN'
                  AND CURRENT_OPEN_QUANTITY > 0
                  GROUP  BY DPA.POSITION_REF,
                            DPA.INSTRUMENT_TYPE,
                            DPA.ALLOCATION_ID,
                            DPA.PRICING_ID) Y_OPEN
              ON X.POSITION_REF = Y_OPEN.POSITION_REF
                 AND X.INSTRUMENT_TYPE = Y_OPEN.INSTRUMENT_TYPE
                 AND Isnull(X.PRICING_ID, 'XXX') = Isnull(Y_OPEN.PRICING_ID, 'XXX')
WHERE X.INSTRUMENT_TYPE = 'PHYSICAL'
AND X.EOD_DATE = $P{asofdate}
GROUP BY X.POSITION_ID,
         X.POSITION_REF,
         COUNTERPARTY,
         PHYSICAL_DELIVERY_MONTH,
         FUTURE_DELIVERY_MONTH,
         INCOTERM,
         EOD_DATE,
         X.ALLOCATION_ID,
         PROFIT_CENTER,
         COMMODITY,
         SPECIFICATION,
         CONTRACT_BOOK,
         CASE
           WHEN ISNULL(PRICING_TYPE, 'PRICED') != 'PRICED' AND
             X.ALLOCATION_ID = X.PRICING_ID THEN 'BASIS'
           ELSE 'COMMODITY'
         END) PPNL
  ON FIFO.PURCHASE_ID = PPNL.POSITION_ID
  AND FIFO.PURCHASE_ALLOCATION_ID = PPNL.ALLOCATION_ID
  AND FIFO.EOD_DATE = PPNL.EOD_DATE
  AND FIFO.PURCH_STATUS = PPNL.STATUS
LEFT JOIN (SELECT
  POSITION_ID,
  MIN(POSITION_DATE) CONTRACT_DATE
FROM DAILY_PNL_ATTRIBUTION DPAT
WHERE INSTRUMENT_TYPE = 'PHYSICAL'
GROUP BY POSITION_ID) PCD
  ON PCD.POSITION_ID = PPNL.POSITION_ID
LEFT JOIN (SELECT
  POSITION_ID,
  MIN(POSITION_DATE) CONTRACT_DATE
FROM DAILY_PNL_ATTRIBUTION DPAT
WHERE INSTRUMENT_TYPE = 'PHYSICAL'
GROUP BY POSITION_ID) SCD
  ON SCD.POSITION_ID = SPNL.POSITION_ID
LEFT JOIN (SELECT
  CASE
    WHEN PRICING_STATUS = 'Unpriced' THEN CASE
        WHEN Y.UNPRICED_QTY <= X.QTY THEN Y.UNPRICED_QTY
        ELSE X.QTY
      END
    WHEN PRICING_STATUS = 'Open' THEN CASE
        WHEN X.TOT_QTY <= (Y.UNPRICED_QTY + Y.OPEN_QTY) THEN CASE
            WHEN X.SEQ = 1 THEN X.TOT_QTY
            ELSE CASE
                WHEN X.QTY <= Y.OPEN_QTY THEN X.QTY
                ELSE Y.OPEN_QTY
              END
          END
        ELSE CASE
            WHEN X.SEQ = 1 THEN (Y.UNPRICED_QTY + Y.OPEN_QTY)
            ELSE CASE
                WHEN X.QTY <= Y.OPEN_QTY THEN X.QTY
                ELSE Y.OPEN_QTY
              END
          END
      END
    WHEN PRICING_STATUS = 'Closed' THEN CASE
        WHEN X.TOT_QTY <= (Y.TOTAL_QTY) THEN CASE
            WHEN X.SEQ = 1 THEN X.TOT_QTY
			WHEN X.SEQ = 2 THEN CASE
                WHEN X.QTY <= Y.OPEN_QTY THEN X.QTY
                ELSE Y.OPEN_QTY
              END
            ELSE CASE
                WHEN X.QTY <= (Y.TOTAL_QTY - (Y.OPEN_QTY + Y.UNPRICED_QTY)) THEN X.QTY
                ELSE (Y.TOTAL_QTY - (Y.OPEN_QTY + Y.UNPRICED_QTY))
              END
          END
        ELSE CASE
            WHEN X.SEQ = 1 THEN (Y.TOTAL_QTY)
			WHEN X.SEQ = 2 THEN CASE
                WHEN X.QTY <= Y.OPEN_QTY THEN X.QTY
                ELSE Y.OPEN_QTY
              END
            ELSE CASE
                WHEN X.QTY <= (Y.TOTAL_QTY - (Y.OPEN_QTY + Y.UNPRICED_QTY)) THEN X.QTY
                ELSE (Y.TOTAL_QTY - (Y.OPEN_QTY + Y.UNPRICED_QTY))
              END
          END
      END
  END AS BOOKED_QTY,
  Y.ALLOCATION_GROUP,
  X.*
FROM (SELECT
  SALES_POSITION_ID,
  PURCHASE_POSITION_ID,
  SALES_ALLOCATION_ID,
  PURCHASE_ALLOCATION_ID,
  EOD_DATE,
  QTY,
  PRICING_STATUS,
  SALES_STATUS,
  PURCH_STATUS,
  SUM(QTY) OVER (PARTITION BY SALES_POSITION_ID,
  PURCHASE_POSITION_ID,
  SALES_ALLOCATION_ID,
  PURCHASE_ALLOCATION_ID, EOD_DATE ORDER BY CASE
    WHEN PRICING_STATUS = 'UNPRICED' THEN 1
    WHEN PRICING_STATUS = 'OPEN' THEN 2
    WHEN PRICING_STATUS = 'CLOSED' THEN 3
  END ROWS UNBOUNDED PRECEDING) TOT_QTY,
  ROW_NUMBER() OVER (PARTITION BY SALES_POSITION_ID,
  PURCHASE_POSITION_ID,
  SALES_ALLOCATION_ID,
  PURCHASE_ALLOCATION_ID, EOD_DATE ORDER BY CASE
    WHEN PRICING_STATUS = 'UNPRICED' THEN 1
    WHEN PRICING_STATUS = 'OPEN' THEN 2
    WHEN PRICING_STATUS = 'CLOSED' THEN 3
  END) SEQ
FROM (SELECT
  SALES_ID SALES_POSITION_ID,
  PURCHASE_ID PURCHASE_POSITION_ID,
  ALLOCATION_ID SALES_ALLOCATION_ID,
  ALLOCATION_ID PURCHASE_ALLOCATION_ID,
  EOD_DATE,
  QTY,
  PRICING_STATUS,
  SALES_STATUS,
  PURCH_STATUS
FROM BI_VIEW_BOOK_VALUE_LINKED_FIFO
UNION ALL
SELECT
  SALES_POSITION_ID,
  PURCHASE_POSITION_ID,
  SALES_ALLOCATION_ID,
  PURCHASE_ALLOCATION_ID,
  EOD_DATE,
  SUM(QUANTITY) QUANTITY,
  PRICING_STATUS,
  SALES_STATUS,
  PURCH_STATUS
FROM BI_VIEW_BOOK_VALUE_STOCK_MATCH
GROUP BY SALES_POSITION_ID,
         PURCHASE_POSITION_ID,
         SALES_ALLOCATION_ID,
         PURCHASE_ALLOCATION_ID,
         EOD_DATE,
         PRICING_STATUS,
         SALES_STATUS,
         PURCH_STATUS) A
WHERE EOD_DATE = $P{asofdate}) X
JOIN (SELECT
  SALES_POSITION_ID,
  PURCHASE_POSITION_ID,
  SALES_ALLOCATION_ID,
  PURCHASE_ALLOCATION_ID,
  EOD_DATE,
  SPNL.ALLOCATION_GROUP,
  CAST(CASE
    WHEN SPNL.TOTAL_FIXED_PRICE_QTY > PPNL.TOTAL_FIXED_PRICE_QTY THEN PPNL.TOTAL_FIXED_PRICE_QTY
    ELSE SPNL.TOTAL_FIXED_PRICE_QTY
  END AS numeric (19,8)) CLOSED_QTY,
  CAST(CASE
    WHEN SPNL.TOTAL_FIXED_PRICE_QTY > PPNL.TOTAL_FIXED_PRICE_QTY THEN CASE
        WHEN (SPNL.TOTAL_FIXED_PRICE_QTY - PPNL.TOTAL_FIXED_PRICE_QTY) > PPNL.TOTAL_PROV_PRICE_QTY THEN PPNL.TOTAL_PROV_PRICE_QTY
        ELSE (SPNL.TOTAL_FIXED_PRICE_QTY - PPNL.TOTAL_FIXED_PRICE_QTY)
      END
    ELSE CASE
        WHEN (PPNL.TOTAL_FIXED_PRICE_QTY - SPNL.TOTAL_FIXED_PRICE_QTY) > SPNL.TOTAL_PROV_PRICE_QTY THEN SPNL.TOTAL_PROV_PRICE_QTY
        ELSE (PPNL.TOTAL_FIXED_PRICE_QTY - SPNL.TOTAL_FIXED_PRICE_QTY)
      END
  END AS numeric (19,8)) OPEN_QTY,
  CAST(CASE
    WHEN SPNL.TOTAL_FIXED_PRICE_QTY > PPNL.TOTAL_FIXED_PRICE_QTY THEN CASE
        WHEN (SPNL.TOTAL_FIXED_PRICE_QTY - PPNL.TOTAL_FIXED_PRICE_QTY) > PPNL.TOTAL_PROV_PRICE_QTY THEN 0
        ELSE PPNL.TOTAL_PROV_PRICE_QTY - (SPNL.TOTAL_FIXED_PRICE_QTY - PPNL.TOTAL_FIXED_PRICE_QTY)
      END
    ELSE CASE
        WHEN (PPNL.TOTAL_FIXED_PRICE_QTY - SPNL.TOTAL_FIXED_PRICE_QTY) > SPNL.TOTAL_PROV_PRICE_QTY THEN 0
        ELSE SPNL.TOTAL_PROV_PRICE_QTY - (PPNL.TOTAL_FIXED_PRICE_QTY - SPNL.TOTAL_FIXED_PRICE_QTY)
      END
  END AS numeric (19,8)) UNPRICED_QTY,
  CAST(CASE
    WHEN SPNL.TOTAL_FIXED_PRICE_QTY > PPNL.TOTAL_FIXED_PRICE_QTY THEN PPNL.TOTAL_FIXED_PRICE_QTY
    ELSE SPNL.TOTAL_FIXED_PRICE_QTY
  END AS numeric (19,8)) + CAST(CASE
    WHEN SPNL.TOTAL_FIXED_PRICE_QTY > PPNL.TOTAL_FIXED_PRICE_QTY THEN CASE
        WHEN (SPNL.TOTAL_FIXED_PRICE_QTY - PPNL.TOTAL_FIXED_PRICE_QTY) > PPNL.TOTAL_PROV_PRICE_QTY THEN PPNL.TOTAL_PROV_PRICE_QTY
        ELSE (SPNL.TOTAL_FIXED_PRICE_QTY - PPNL.TOTAL_FIXED_PRICE_QTY)
      END
    ELSE CASE
        WHEN (PPNL.TOTAL_FIXED_PRICE_QTY - SPNL.TOTAL_FIXED_PRICE_QTY) > SPNL.TOTAL_PROV_PRICE_QTY THEN SPNL.TOTAL_PROV_PRICE_QTY
        ELSE (PPNL.TOTAL_FIXED_PRICE_QTY - SPNL.TOTAL_FIXED_PRICE_QTY)
      END
  END AS numeric (19,8)) + CAST(CASE
    WHEN SPNL.TOTAL_FIXED_PRICE_QTY > PPNL.TOTAL_FIXED_PRICE_QTY THEN CASE
        WHEN (SPNL.TOTAL_FIXED_PRICE_QTY - PPNL.TOTAL_FIXED_PRICE_QTY) > PPNL.TOTAL_PROV_PRICE_QTY THEN 0
        ELSE PPNL.TOTAL_PROV_PRICE_QTY - (SPNL.TOTAL_FIXED_PRICE_QTY - PPNL.TOTAL_FIXED_PRICE_QTY)
      END
    ELSE CASE
        WHEN (PPNL.TOTAL_FIXED_PRICE_QTY - SPNL.TOTAL_FIXED_PRICE_QTY) > SPNL.TOTAL_PROV_PRICE_QTY THEN 0
        ELSE SPNL.TOTAL_PROV_PRICE_QTY - (PPNL.TOTAL_FIXED_PRICE_QTY - SPNL.TOTAL_FIXED_PRICE_QTY)
      END
  END AS numeric (19,8)) TOTAL_QTY
FROM (SELECT
  SALES_ID SALES_POSITION_ID,
  PURCHASE_ID PURCHASE_POSITION_ID,
  ALLOCATION_ID SALES_ALLOCATION_ID,
  ALLOCATION_ID PURCHASE_ALLOCATION_ID,
  EOD_DATE
FROM BI_VIEW_BOOK_VALUE_LINKED_FIFO
UNION
SELECT
  SALES_POSITION_ID,
  PURCHASE_POSITION_ID,
  SALES_ALLOCATION_ID,
  PURCHASE_ALLOCATION_ID,
  EOD_DATE
FROM BI_VIEW_BOOK_VALUE_STOCK_MATCH) X
JOIN (SELECT
  POSITION_ID,
  ALLOCATION_ID,
  LOAD_ID,
  'Linked' ALLOCATION_GROUP,
  MAX(DOCUMENT_DATE) DOCUMENT_DATE,
  MAX(LOAD_QTY) LOAD_QTY,
  MAX(TOTAL_FIXED_PRICE_QTY) TOTAL_FIXED_PRICE_QTY,
  MIN(TOTAL_PROV_PRICE_QTY) TOTAL_PROV_PRICE_QTY
FROM (SELECT
  POSITION_ID,
  LOAD_ID,
  ALLOCATION_ID,
  DOCUMENT_REF,
  MAX(DOCUMENT_DATE) DOCUMENT_DATE,
  MAX(LOAD_QTY) LOAD_QTY,
  SUM(TOTAL_FIXED_PRICE_QTY) TOTAL_FIXED_PRICE_QTY,
  SUM(TOTAL_PROV_PRICE_QTY) TOTAL_PROV_PRICE_QTY
FROM DUMP_BI_FINANCIAL_LOAD_DETAILS X
GROUP BY POSITION_ID,
         LOAD_ID,
		 ALLOCATION_ID,
		 DOCUMENT_REF) D
WHERE DOCUMENT_DATE <= $P{asofdate}
GROUP BY POSITION_ID,
ALLOCATION_ID,
         LOAD_ID) SPNL
  ON X.SALES_POSITION_ID = SPNL.POSITION_ID
  AND X.SALES_ALLOCATION_ID = SPNL.ALLOCATION_ID
JOIN (SELECT
  POSITION_ID,
  ALLOCATION_ID,
  LOAD_ID,
  'Linked' ALLOCATION_GROUP,
  MAX(DOCUMENT_DATE) DOCUMENT_DATE,
  MAX(LOAD_QTY) LOAD_QTY,
  MAX(TOTAL_FIXED_PRICE_QTY) TOTAL_FIXED_PRICE_QTY,
  MIN(TOTAL_PROV_PRICE_QTY) TOTAL_PROV_PRICE_QTY
FROM (SELECT
  POSITION_ID,
  LOAD_ID,
  ALLOCATION_ID,
  DOCUMENT_REF,
  MAX(DOCUMENT_DATE) DOCUMENT_DATE,
  MAX(LOAD_QTY) LOAD_QTY,
  SUM(TOTAL_FIXED_PRICE_QTY) TOTAL_FIXED_PRICE_QTY,
  SUM(TOTAL_PROV_PRICE_QTY) TOTAL_PROV_PRICE_QTY
FROM DUMP_BI_FINANCIAL_LOAD_DETAILS X
GROUP BY POSITION_ID,
         LOAD_ID,
		 ALLOCATION_ID,
		 DOCUMENT_REF) D
WHERE DOCUMENT_DATE <= $P{asofdate}
GROUP BY POSITION_ID,
ALLOCATION_ID,
         LOAD_ID) PPNL
  ON X.PURCHASE_POSITION_ID = PPNL.POSITION_ID
  AND X.PURCHASE_ALLOCATION_ID = PPNL.ALLOCATION_ID
  AND SPNL.ALLOCATION_GROUP = PPNL.ALLOCATION_GROUP
WHERE EOD_DATE = $P{asofdate}) Y
  ON X.PURCHASE_POSITION_ID = Y.PURCHASE_POSITION_ID
  AND X.SALES_POSITION_ID = Y.SALES_POSITION_ID
  AND X.SALES_ALLOCATION_ID = Y.SALES_ALLOCATION_ID
  AND X.PURCHASE_ALLOCATION_ID = Y.PURCHASE_ALLOCATION_ID
  AND X.EOD_DATE = Y.EOD_DATE) PROV
  ON PROV.SALES_POSITION_ID = FIFO.SALES_ID
  AND PROV.PURCHASE_POSITION_ID = FIFO.PURCHASE_ID
  AND PROV.SALES_POSITION_ID = FIFO.SALES_ID
  AND PROV.PURCHASE_ALLOCATION_ID = FIFO.PURCHASE_ALLOCATION_ID
  AND PROV.EOD_DATE = FIFO.EOD_DATE
  AND PROV.PRICING_STATUS = FIFO.PRICING_STATUS
  AND PROV.SALES_STATUS = FIFO.SALES_STATUS
  AND PROV.PURCH_STATUS = FIFO.PURCH_STATUS
WHERE FIFO.EOD_DATE = $P{asofdate}
AND (FIFO.QTY - COALESCE(BOOKED_QTY, 0)) <> 0)L1
WHERE
$X{IN,CONTRACT_BOOK,ctrbook}
AND  $X{IN,TRADE_TYPE,instrument_type}
AND  $X{IN,CONTRACT_STATUS,alloc_grp}
AND ($X{IN, PURCH_PRODUCT, commodity} OR $X{IN, SALES_PRODUCT, commodity})
AND ($X{IN, PURCH_GRADE, grade} OR $X{IN, SALES_GRADE, grade})
AND ($X{IN, PURCH_UNIT, pc} OR $X{IN, SALES_UNIT, pc})
AND  $X{IN,REPORT_STATUS,report_status}
AND  $X{IN,PRICE_TYPE_STATUS,Price_Type_status}
ORDER  BY TRADE_TYPE Desc,
          REPORT_STATUS,
		  CASE CONTRACT_STATUS
           WHEN 'Booked Till Last Month End' THEN 1
           WHEN 'Booked For The Month' THEN 2
           WHEN 'Linked' THEN 3
           WHEN 'Unlinked Sales' THEN 4
           WHEN 'Unlinked Purchase' THEN 5
           WHEN 'Unlinked Sales - Origin' THEN 6
           WHEN 'Unlinked Sales - OIL' THEN 7
           WHEN 'Unlinked Purchase - Origin' THEN 8
           WHEN 'Unlinked Purchase - OIL' THEN 9
		  END,
		  PURCH_TRANSACTION_DATE,
          SALES_TRANSACTION_DATE,
          PURCHASE_REF_NO,
          SALES_REF_NO]]>
		</queryString>
		<field name="CONTRACT_BOOK" class="java.lang.String"/>
		<field name="PURCH_TRANSACTION_DATE" class="java.sql.Date"/>
		<field name="PURCHASE_REF_NO" class="java.lang.String"/>
		<field name="PURCH_UNIT" class="java.lang.String"/>
		<field name="PURCH_PARTY" class="java.lang.String"/>
		<field name="PURCH_PRODUCT" class="java.lang.String"/>
		<field name="PURCH_GRADE" class="java.lang.String"/>
		<field name="PURCH_SHIPMENT_MONTH" class="java.lang.String"/>
		<field name="PURCH_EXCH" class="java.lang.String"/>
		<field name="PURCH_TERMINAL_MONTH" class="java.lang.String"/>
		<field name="PURCH_STRIKE" class="java.lang.Integer"/>
		<field name="PURCH_CONTRACT_TERMS" class="java.lang.String"/>
		<field name="PURCH_PRICE_TYPE" class="java.lang.String"/>
		<field name="PURCH_QUANTITY" class="java.math.BigDecimal"/>
		<field name="PURCH_CONTRACT_PRICE" class="java.math.BigDecimal"/>
		<field name="PURCH_DIRECT_COST" class="java.math.BigDecimal"/>
		<field name="TOTAL_COST" class="java.math.BigDecimal"/>
		<field name="SALES_TRANSACTION_DATE" class="java.sql.Date"/>
		<field name="SALES_REF_NO" class="java.lang.String"/>
		<field name="SALES_UNIT" class="java.lang.String"/>
		<field name="SALES_PARTY" class="java.lang.String"/>
		<field name="SALES_PRODUCT" class="java.lang.String"/>
		<field name="SALES_GRADE" class="java.lang.String"/>
		<field name="SALES_SHIPMENT_MONTH" class="java.lang.String"/>
		<field name="SALES_EXCH" class="java.lang.String"/>
		<field name="SALES_TERMINAL_MONTH" class="java.lang.String"/>
		<field name="SALES_STRIKE" class="java.lang.Integer"/>
		<field name="SALES_CONTRACT_TERMS" class="java.lang.String"/>
		<field name="SALES_PRICE_TYPE" class="java.lang.String"/>
		<field name="SALES_QUANTITY" class="java.math.BigDecimal"/>
		<field name="SALES_CONTRACT_PRICE" class="java.math.BigDecimal"/>
		<field name="SALES_DIRECT_COST" class="java.math.BigDecimal"/>
		<field name="NET_REALIZATION" class="java.math.BigDecimal"/>
		<field name="MARKET_PRICE" class="java.math.BigDecimal"/>
		<field name="MARKET_VALUE" class="java.math.BigDecimal"/>
		<field name="PNL" class="java.math.BigDecimal"/>
		<field name="TRADE_TYPE" class="java.lang.String"/>
		<field name="REPORT_STATUS" class="java.lang.String"/>
		<field name="CONTRACT_STATUS" class="java.lang.String"/>
		<field name="PRICE_TYPE_STATUS" class="java.lang.String"/>
		<variable name="PURCH_QTY" class="java.math.BigDecimal" resetType="Group" resetGroup="Report_Status" calculation="Sum">
			<variableExpression><![CDATA[$F{PURCH_QUANTITY}]]></variableExpression>
		</variable>
		<variable name="TOTAL_COST" class="java.math.BigDecimal" resetType="Group" resetGroup="Report_Status" calculation="Sum">
			<variableExpression><![CDATA[$F{TOTAL_COST}]]></variableExpression>
		</variable>
		<variable name="SALES_QTY" class="java.math.BigDecimal" resetType="Group" resetGroup="Report_Status" calculation="Sum">
			<variableExpression><![CDATA[$F{SALES_QUANTITY}]]></variableExpression>
		</variable>
		<variable name="NET_REALIZATION" class="java.math.BigDecimal" resetType="Group" resetGroup="Report_Status" calculation="Sum">
			<variableExpression><![CDATA[$F{NET_REALIZATION}]]></variableExpression>
		</variable>
		<variable name="MARKET_VALUE" class="java.math.BigDecimal" resetType="Group" resetGroup="Report_Status" calculation="Sum">
			<variableExpression><![CDATA[$F{MARKET_VALUE}]]></variableExpression>
		</variable>
		<variable name="PNL" class="java.math.BigDecimal" resetType="Group" resetGroup="Report_Status" calculation="Sum">
			<variableExpression><![CDATA[$F{PNL}]]></variableExpression>
		</variable>
		<variable name="SUB_PURCH_QTY" class="java.math.BigDecimal" resetType="Group" resetGroup="Contract_Status" calculation="Sum">
			<variableExpression><![CDATA[$F{PURCH_QUANTITY}]]></variableExpression>
		</variable>
		<variable name="SUB_TOTAL_COST" class="java.math.BigDecimal" resetType="Group" resetGroup="Contract_Status" calculation="Sum">
			<variableExpression><![CDATA[$F{TOTAL_COST}]]></variableExpression>
		</variable>
		<variable name="SUB_SALES_QTY" class="java.math.BigDecimal" resetType="Group" resetGroup="Contract_Status" calculation="Sum">
			<variableExpression><![CDATA[$F{SALES_QUANTITY}]]></variableExpression>
		</variable>
		<variable name="SUB_NET_REALIZATION" class="java.math.BigDecimal" resetType="Group" resetGroup="Contract_Status" calculation="Sum">
			<variableExpression><![CDATA[$F{NET_REALIZATION}]]></variableExpression>
		</variable>
		<variable name="SUB_MARKET_VALUE" class="java.math.BigDecimal" resetType="Group" resetGroup="Contract_Status" calculation="Sum">
			<variableExpression><![CDATA[$F{MARKET_VALUE}]]></variableExpression>
		</variable>
		<variable name="SUB_PNL" class="java.math.BigDecimal" resetType="Group" resetGroup="Contract_Status" calculation="Sum">
			<variableExpression><![CDATA[$F{PNL}]]></variableExpression>
		</variable>
		<variable name="TOT_PURCH_QTY" class="java.math.BigDecimal" resetType="Group" resetGroup="Instrument_Type" calculation="Sum">
			<variableExpression><![CDATA[$F{PURCH_QUANTITY}]]></variableExpression>
		</variable>
		<variable name="TOT_TOTAL_COST" class="java.math.BigDecimal" resetType="Group" resetGroup="Instrument_Type" calculation="Sum">
			<variableExpression><![CDATA[$F{TOTAL_COST}]]></variableExpression>
		</variable>
		<variable name="TOT_SALES_QTY" class="java.math.BigDecimal" resetType="Group" resetGroup="Instrument_Type" calculation="Sum">
			<variableExpression><![CDATA[$F{SALES_QUANTITY}]]></variableExpression>
		</variable>
		<variable name="TOT_NET_REALIZATION" class="java.math.BigDecimal" resetType="Group" resetGroup="Instrument_Type" calculation="Sum">
			<variableExpression><![CDATA[$F{NET_REALIZATION}]]></variableExpression>
		</variable>
		<variable name="TOT_MARKET_VALUE" class="java.math.BigDecimal" resetType="Group" resetGroup="Instrument_Type" calculation="Sum">
			<variableExpression><![CDATA[$F{MARKET_VALUE}]]></variableExpression>
		</variable>
		<variable name="TOT_PNL" class="java.math.BigDecimal" resetType="Group" resetGroup="Instrument_Type" calculation="Sum">
			<variableExpression><![CDATA[$F{PNL}]]></variableExpression>
		</variable>
		<group name="Instrument_Type">
			<groupExpression><![CDATA[$F{TRADE_TYPE}]]></groupExpression>
		</group>
		<group name="Report_Status">
			<groupExpression><![CDATA[$F{REPORT_STATUS}]]></groupExpression>
		</group>
		<group name="Contract_Status">
			<groupExpression><![CDATA[$F{CONTRACT_STATUS}]]></groupExpression>
		</group>
	</subDataset>
	<parameter name="ctrbook" class="java.util.Collection"/>
	<parameter name="asofdate" class="java.util.Date"/>
	<parameter name="alloc_grp" class="java.util.Collection"/>
	<parameter name="commodity" class="java.util.Collection"/>
	<parameter name="grade" class="java.util.Collection"/>
	<parameter name="instrument_type" class="java.util.Collection"/>
	<parameter name="pc" class="java.util.Collection"/>
	<parameter name="report_status" class="java.util.Collection"/>
	<parameter name="Price_Type_status" class="java.util.Collection"/>
	<queryString>
		<![CDATA[SELECT 1 AS ID]]>
	</queryString>
	<field name="ID" class="java.lang.Integer"/>
	<variable name="currentpage" class="java.lang.Integer" resetType="Page" incrementType="Page">
		<initialValueExpression><![CDATA[$V{PAGE_NUMBER}]]></initialValueExpression>
	</variable>
	<title>
		<band height="60">
			<image scaleImage="FillFrame" onErrorType="Blank">
				<reportElement mode="Opaque" x="9" y="0" width="30" height="30" backcolor="#1F497D" uuid="d7838352-d285-41ff-8c2d-764004420613">
					<property name="com.jaspersoft.studio.unit.x" value="pixel"/>
					<property name="net.sf.jasperreports.export.xls.column.width.ratio" value="1.15"/>
				</reportElement>
				<box>
					<topPen lineWidth="0.5" lineColor="#4F81BD"/>
					<leftPen lineWidth="0.5" lineColor="#4F81BD"/>
					<bottomPen lineWidth="0.5" lineColor="#4F81BD"/>
					<rightPen lineWidth="0.5" lineColor="#4F81BD"/>
				</box>
				<imageExpression><![CDATA["repo:reponew_logo.png"]]></imageExpression>
			</image>
			<textField>
				<reportElement mode="Opaque" x="39" y="0" width="1069" height="30" forecolor="#FFFFFF" backcolor="#1F497D" uuid="edf286fc-735a-465d-9bf5-499637f40aca">
					<property name="local_mesure_unitx" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.x" value="px"/>
					<property name="local_mesure_unitheight" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.height" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.width" value="pixel"/>
				</reportElement>
				<box leftPadding="10" rightPadding="2">
					<topPen lineWidth="0.5" lineColor="#4F81BD"/>
					<leftPen lineWidth="0.5" lineColor="#4F81BD"/>
					<bottomPen lineWidth="0.5" lineColor="#4F81BD"/>
					<rightPen lineWidth="0.0" lineColor="#4F81BD"/>
				</box>
				<textElement verticalAlignment="Middle">
					<font fontName="Arial" size="13" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA["Book Value drilldown details for Physicals & Paper Trades as of Date : " + DATEFORMAT($P{asofdate}, "dd-MMM-yy")]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement mode="Opaque" x="1108" y="0" width="2865" height="30" forecolor="#FFFFFF" backcolor="#1F497D" uuid="2c3723d0-3a10-4dab-8240-5bf2af56a434">
					<property name="local_mesure_unity" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.y" value="px"/>
					<property name="local_mesure_unitx" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.height" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.width" value="pixel"/>
				</reportElement>
				<box leftPadding="2" rightPadding="2">
					<topPen lineWidth="0.5" lineColor="#4F81BD"/>
					<leftPen lineWidth="0.0" lineColor="#4F81BD"/>
					<bottomPen lineWidth="0.5" lineColor="#4F81BD"/>
					<rightPen lineWidth="0.5" lineColor="#4F81BD"/>
				</box>
				<textElement verticalAlignment="Middle">
					<font fontName="Arial" size="13" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA["Run Date : "+DATEFORMAT(TODAY( ),"dd-MMM-yy h:mm:ss a")]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement mode="Opaque" x="-1" y="0" width="10" height="30" forecolor="#FFFFFF" backcolor="#1F497D" uuid="e98ad7f3-dab9-4a91-b366-71dedff920ad"/>
			</textField>
			<textField pattern="">
				<reportElement mode="Opaque" x="0" y="30" width="3973" height="30" forecolor="#FFFFFF" backcolor="#1F497D" uuid="3ce7836a-ee26-4276-9038-60c256d3a3fe">
					<property name="local_mesure_unitx" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.x" value="px"/>
					<property name="local_mesure_unity" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.height" value="pixel"/>
				</reportElement>
				<box>
					<topPen lineWidth="0.5" lineColor="#4F81BD"/>
					<leftPen lineWidth="0.5" lineColor="#4F81BD"/>
					<bottomPen lineWidth="0.5" lineColor="#4F81BD"/>
					<rightPen lineWidth="0.5" lineColor="#4F81BD"/>
				</box>
				<textElement verticalAlignment="Middle">
					<font fontName="Arial" size="13" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA["Contract Book : "+(!$P{ctrbook}.isEmpty()? $P{ctrbook}.toString():"All") +"  "+" ,Unit : "+(!$P{pc}.isEmpty()? $P{pc}.toString():"All")+"  "+" , Trade Type : "+(!$P{instrument_type}.isEmpty()? $P{instrument_type}.toString():"All")
+"  "+" , Report Status: "+(!$P{report_status}.isEmpty()? $P{report_status}.toString():"All")
+"  "+" , Contract Status: "+(!$P{alloc_grp}.isEmpty()? $P{alloc_grp}.toString():"All")
+"  "+" , Price Type Status: "+(!$P{Price_Type_status}.isEmpty()? $P{Price_Type_status}.toString():"All")]]></textFieldExpression>
			</textField>
		</band>
	</title>
	<pageHeader>
		<band splitType="Stretch">
			<property name="local_mesure_unitheight" value="pixel"/>
			<property name="com.jaspersoft.studio.unit.height" value="px"/>
		</band>
	</pageHeader>
	<columnHeader>
		<band splitType="Stretch">
			<property name="local_mesure_unitheight" value="pixel"/>
			<property name="com.jaspersoft.studio.unit.height" value="px"/>
		</band>
	</columnHeader>
	<detail>
		<band height="117" splitType="Stretch">
			<property name="local_mesure_unitheight" value="pixel"/>
			<property name="com.jaspersoft.studio.unit.height" value="pixel"/>
			<componentElement>
				<reportElement key="table" style="table" positionType="Float" x="0" y="0" width="3973" height="105" isRemoveLineWhenBlank="true" uuid="705d6764-2afc-4f55-82e2-11eabbb775fc">
					<property name="com.jaspersoft.studio.unit.height" value="pixel"/>
					<property name="com.jaspersoft.studio.unit.width" value="pixel"/>
					<printWhenExpression><![CDATA[$P{report_status}.toString().replaceAll("\\[", "").replaceAll("\\]","").equals("Closed" ) || $P{report_status}.isEmpty()]]></printWhenExpression>
				</reportElement>
				<jr:table xmlns:jr="http://jasperreports.sourceforge.net/jasperreports/components" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports/components http://jasperreports.sourceforge.net/xsd/components.xsd">
					<datasetRun subDataset="physical" uuid="f7380d75-8cda-42f5-813c-a1d4e8d2a8a2">
						<datasetParameter name="ctrbook">
							<datasetParameterExpression><![CDATA[$P{ctrbook}]]></datasetParameterExpression>
						</datasetParameter>
						<datasetParameter name="asofdate">
							<datasetParameterExpression><![CDATA[$P{asofdate}]]></datasetParameterExpression>
						</datasetParameter>
						<datasetParameter name="alloc_grp">
							<datasetParameterExpression><![CDATA[$P{alloc_grp}]]></datasetParameterExpression>
						</datasetParameter>
						<datasetParameter name="commodity">
							<datasetParameterExpression><![CDATA[$P{commodity}]]></datasetParameterExpression>
						</datasetParameter>
						<datasetParameter name="grade">
							<datasetParameterExpression><![CDATA[$P{grade}]]></datasetParameterExpression>
						</datasetParameter>
						<datasetParameter name="instrument_type">
							<datasetParameterExpression><![CDATA[$P{instrument_type}]]></datasetParameterExpression>
						</datasetParameter>
						<datasetParameter name="pc">
							<datasetParameterExpression><![CDATA[$P{pc}]]></datasetParameterExpression>
						</datasetParameter>
						<datasetParameter name="report_status">
							<datasetParameterExpression><![CDATA[$P{report_status}]]></datasetParameterExpression>
						</datasetParameter>
						<datasetParameter name="Price_Type_status">
							<datasetParameterExpression><![CDATA[$P{Price_Type_status}]]></datasetParameterExpression>
						</datasetParameter>
						<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
					</datasetRun>
					<jr:column width="250" uuid="c8b423b3-886c-42dd-8840-5060ce87b4f5">
						<jr:groupHeader groupName="Contract_Status">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<textField>
									<reportElement mode="Opaque" x="0" y="0" width="250" height="30" backcolor="#C7DAF1" uuid="84880bf1-a91a-435c-8775-00b1cda39cfe"/>
									<box leftPadding="4" rightPadding="4"/>
									<textElement verticalAlignment="Middle">
										<font fontName="Arial" size="11" isBold="true" isItalic="false"/>
									</textElement>
									<textFieldExpression><![CDATA[$F{CONTRACT_STATUS}]]></textFieldExpression>
								</textField>
							</jr:cell>
						</jr:groupHeader>
						<jr:groupHeader groupName="Report_Status">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<textField>
									<reportElement mode="Opaque" x="0" y="0" width="250" height="30" forecolor="#000000" backcolor="#8DB4E2" uuid="a1dc4b15-55e4-4901-a521-209c533a8dd7"/>
									<box leftPadding="4" rightPadding="4"/>
									<textElement verticalAlignment="Middle">
										<font fontName="Arial" size="11" isBold="true" isItalic="false"/>
									</textElement>
									<textFieldExpression><![CDATA[$F{REPORT_STATUS}]]></textFieldExpression>
								</textField>
							</jr:cell>
						</jr:groupHeader>
						<jr:groupHeader groupName="Instrument_Type">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<textField>
									<reportElement mode="Opaque" x="0" y="0" width="250" height="30" forecolor="#FFFFFF" backcolor="#1F497D" uuid="58b27406-7d79-4920-ac61-58aec02f9299"/>
									<box leftPadding="4" rightPadding="4"/>
									<textElement verticalAlignment="Middle">
										<font fontName="Arial" size="12" isBold="true"/>
									</textElement>
									<textFieldExpression><![CDATA[$F{TRADE_TYPE}]]></textFieldExpression>
								</textField>
							</jr:cell>
						</jr:groupHeader>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<box>
								<topPen lineWidth="0.5" lineColor="#4F81BD"/>
								<leftPen lineWidth="0.5" lineColor="#4F81BD"/>
								<bottomPen lineWidth="0.5" lineColor="#4F81BD"/>
								<rightPen lineWidth="0.5" lineColor="#4F81BD"/>
							</box>
							<staticText>
								<reportElement mode="Opaque" x="0" y="0" width="250" height="30" backcolor="#8DB4E2" uuid="a5241d90-6fda-45e0-86ac-af03453178c8"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font fontName="Arial" isBold="true"/>
								</textElement>
								<text><![CDATA[Transaction Date]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<box>
								<topPen lineColor="#4F81BD"/>
								<leftPen lineColor="#4F81BD"/>
								<bottomPen lineColor="#4F81BD"/>
								<rightPen lineColor="#4F81BD"/>
							</box>
							<textField pattern="dd-MMM-yy" isBlankWhenNull="true">
								<reportElement x="0" y="0" width="250" height="30" uuid="d18bf13c-9fad-4d78-a5f4-7a41eb753760"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Right" verticalAlignment="Middle">
									<font fontName="Arial" size="11"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{PURCH_TRANSACTION_DATE}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="140" uuid="9134fa82-3ebc-4200-a50d-76e4439d75ac">
						<jr:groupHeader groupName="Contract_Status">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="140" height="30" backcolor="#C7DAF1" uuid="69e72881-49a5-4962-9e4d-0a496b1f5c8b"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:groupHeader groupName="Report_Status">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="140" height="30" backcolor="#8DB4E2" uuid="fbe56bec-12c4-4df9-84b9-2a34bc511a87"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:groupHeader groupName="Instrument_Type">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="140" height="30" backcolor="#1F497D" uuid="36254c93-4373-431f-a794-8446166063da"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<box>
								<topPen lineWidth="0.5" lineColor="#4F81BD"/>
								<leftPen lineWidth="0.5" lineColor="#4F81BD"/>
								<bottomPen lineWidth="0.5" lineColor="#4F81BD"/>
								<rightPen lineWidth="0.5" lineColor="#4F81BD"/>
							</box>
							<staticText>
								<reportElement mode="Opaque" x="0" y="0" width="140" height="30" backcolor="#8DB4E2" uuid="5825e533-4085-4260-9ee6-44bd1ec1fccd"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font fontName="Arial" isBold="true"/>
								</textElement>
								<text><![CDATA[Purchase Ref No]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<box>
								<topPen lineColor="#4F81BD"/>
								<leftPen lineColor="#4F81BD"/>
								<bottomPen lineColor="#4F81BD"/>
								<rightPen lineColor="#4F81BD"/>
							</box>
							<textField isBlankWhenNull="true">
								<reportElement x="0" y="0" width="140" height="30" uuid="a4bfc1ac-4f5d-48e0-936d-0a798fefb81c"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement verticalAlignment="Middle">
									<font fontName="Arial" size="11"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{PURCHASE_REF_NO}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="130" uuid="6b4b1695-161c-4b6c-b90c-7207dec9b013">
						<jr:groupHeader groupName="Contract_Status">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="130" height="30" backcolor="#C7DAF1" uuid="d320f2ae-613d-4e17-858a-c9b48a5ca647"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:groupHeader groupName="Report_Status">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="130" height="30" backcolor="#8DB4E2" uuid="1dd16131-52a4-4570-bfa2-886190e81fcb"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:groupHeader groupName="Instrument_Type">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="130" height="30" backcolor="#1F497D" uuid="54059f9c-8da5-43a1-ab61-8427a4251246"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<box>
								<topPen lineWidth="0.5" lineColor="#4F81BD"/>
								<leftPen lineWidth="0.5" lineColor="#4F81BD"/>
								<bottomPen lineWidth="0.5" lineColor="#4F81BD"/>
								<rightPen lineWidth="0.5" lineColor="#4F81BD"/>
							</box>
							<staticText>
								<reportElement mode="Opaque" x="0" y="0" width="130" height="30" backcolor="#8DB4E2" uuid="9aa0db22-bc1f-4527-be39-da343bfe4f66"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font fontName="Arial" isBold="true"/>
								</textElement>
								<text><![CDATA[Unit]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<box>
								<topPen lineColor="#4F81BD"/>
								<leftPen lineColor="#4F81BD"/>
								<bottomPen lineColor="#4F81BD"/>
								<rightPen lineColor="#4F81BD"/>
							</box>
							<textField isBlankWhenNull="true">
								<reportElement x="0" y="0" width="130" height="30" uuid="0ce86acd-552a-4207-8212-22fbc8269281"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement verticalAlignment="Middle">
									<font fontName="Arial" size="11"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{PURCH_UNIT}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="150" uuid="22ce94fa-e8d2-4dc8-8e64-162c06cd02d8">
						<jr:groupHeader groupName="Contract_Status">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="150" height="30" backcolor="#C7DAF1" uuid="77291d95-c6bd-4eb1-9c75-59176adc41bd"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:groupHeader groupName="Report_Status">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="150" height="30" backcolor="#8DB4E2" uuid="43523b29-78e3-496a-8faa-8ca01880cbaa"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:groupHeader groupName="Instrument_Type">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="150" height="30" backcolor="#1F497D" uuid="8135190e-b712-4df3-b605-b14c4860f2bb"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<box>
								<topPen lineWidth="0.5" lineColor="#4F81BD"/>
								<leftPen lineWidth="0.5" lineColor="#4F81BD"/>
								<bottomPen lineWidth="0.5" lineColor="#4F81BD"/>
								<rightPen lineWidth="0.5" lineColor="#4F81BD"/>
							</box>
							<staticText>
								<reportElement mode="Opaque" x="0" y="0" width="150" height="30" backcolor="#8DB4E2" uuid="718ed2e5-b094-43b0-a7aa-b3396c0b8f26"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font fontName="Arial" isBold="true"/>
								</textElement>
								<text><![CDATA[Party]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<box>
								<topPen lineColor="#4F81BD"/>
								<leftPen lineColor="#4F81BD"/>
								<bottomPen lineColor="#4F81BD"/>
								<rightPen lineColor="#4F81BD"/>
							</box>
							<textField isBlankWhenNull="true">
								<reportElement x="0" y="0" width="150" height="30" uuid="a14d86d2-4791-42cb-ae3d-94c42b3526fd"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement verticalAlignment="Middle">
									<font fontName="Arial" size="11"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{PURCH_PARTY}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="3f1d1f4a-8f07-478e-83c2-4810b7261031">
						<jr:groupHeader groupName="Contract_Status">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#C7DAF1" uuid="ede6bac9-50de-4ee6-a3cf-6a92972c317d"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:groupHeader groupName="Report_Status">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#8DB4E2" uuid="485ea19b-38be-40c2-87a4-70bec562aef0"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:groupHeader groupName="Instrument_Type">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#1F497D" uuid="ec1f8503-159b-458f-855e-286bf1300600"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<box>
								<topPen lineWidth="0.5" lineColor="#4F81BD"/>
								<leftPen lineWidth="0.5" lineColor="#4F81BD"/>
								<bottomPen lineWidth="0.5" lineColor="#4F81BD"/>
								<rightPen lineWidth="0.5" lineColor="#4F81BD"/>
							</box>
							<staticText>
								<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#8DB4E2" uuid="4274fa47-cc27-4b20-b230-5f09f1373131"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font fontName="Arial" isBold="true"/>
								</textElement>
								<text><![CDATA[Product]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<box>
								<topPen lineColor="#4F81BD"/>
								<leftPen lineColor="#4F81BD"/>
								<bottomPen lineColor="#4F81BD"/>
								<rightPen lineColor="#4F81BD"/>
							</box>
							<textField isBlankWhenNull="true">
								<reportElement x="0" y="0" width="90" height="30" uuid="e81f672a-8fbb-4e4c-9170-c9a0f894d952"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement verticalAlignment="Middle">
									<font fontName="Arial" size="11"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{PURCH_PRODUCT}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="b13f068a-9b31-427e-ba20-a37f148210ad">
						<jr:groupHeader groupName="Contract_Status">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#C7DAF1" uuid="1031f01c-c3e1-4e6f-8c7d-75ab4c990791"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:groupHeader groupName="Report_Status">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#8DB4E2" uuid="af9b7ac0-21ad-4094-83c8-af3b8d9b766d"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:groupHeader groupName="Instrument_Type">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#1F497D" uuid="05bcf1db-e8a6-4e53-b624-d90d2b662fef"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<box>
								<topPen lineWidth="0.5" lineColor="#4F81BD"/>
								<leftPen lineWidth="0.5" lineColor="#4F81BD"/>
								<bottomPen lineWidth="0.5" lineColor="#4F81BD"/>
								<rightPen lineWidth="0.5" lineColor="#4F81BD"/>
							</box>
							<staticText>
								<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#8DB4E2" uuid="f703518e-9d05-4506-a03b-3c424b0dd719"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font fontName="Arial" isBold="true"/>
								</textElement>
								<text><![CDATA[Grade]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<box>
								<topPen lineColor="#4F81BD"/>
								<leftPen lineColor="#4F81BD"/>
								<bottomPen lineColor="#4F81BD"/>
								<rightPen lineColor="#4F81BD"/>
							</box>
							<textField isBlankWhenNull="true">
								<reportElement x="0" y="0" width="90" height="30" uuid="1b5009d7-5d1e-4fa3-b656-0684951b6593"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement verticalAlignment="Middle">
									<font fontName="Arial" size="11"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{PURCH_GRADE}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="cf781924-6abb-4ae4-aed0-7a1321c26589">
						<jr:groupHeader groupName="Contract_Status">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#C7DAF1" uuid="c4a01c52-c9ee-46d9-8021-1aaab83914e8"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:groupHeader groupName="Report_Status">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#8DB4E2" uuid="a5395085-8abe-45fa-8965-2e93dce99a2b"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:groupHeader groupName="Instrument_Type">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#1F497D" uuid="7a907a3b-6ac9-4e7a-ab6d-cc0889fd552f"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<box>
								<topPen lineWidth="0.5" lineColor="#4F81BD"/>
								<leftPen lineWidth="0.5" lineColor="#4F81BD"/>
								<bottomPen lineWidth="0.5" lineColor="#4F81BD"/>
								<rightPen lineWidth="0.5" lineColor="#4F81BD"/>
							</box>
							<staticText>
								<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#8DB4E2" uuid="39e70597-879e-4b9c-ae1c-32b38c8e3053"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font fontName="Arial" isBold="true"/>
								</textElement>
								<text><![CDATA[Shipment Month]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<box>
								<topPen lineColor="#4F81BD"/>
								<leftPen lineColor="#4F81BD"/>
								<bottomPen lineColor="#4F81BD"/>
								<rightPen lineColor="#4F81BD"/>
							</box>
							<textField isBlankWhenNull="true">
								<reportElement x="0" y="0" width="90" height="30" uuid="dc24be53-9b65-4903-972e-064a724fba73"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement verticalAlignment="Middle">
									<font fontName="Arial" size="11"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{PURCH_SHIPMENT_MONTH}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="68ded6a4-7fe5-4ab9-bf41-9bd879ac0565">
						<jr:groupHeader groupName="Contract_Status">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#C7DAF1" uuid="61372893-24ee-458e-8173-8578899bad15"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:groupHeader groupName="Report_Status">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#8DB4E2" uuid="07784a39-6dbe-4238-aed4-dc2fd4bd0742"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:groupHeader groupName="Instrument_Type">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#1F497D" uuid="9c93e673-088e-4d36-a46a-62fb1b73e92f"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<box>
								<topPen lineWidth="0.5" lineColor="#4F81BD"/>
								<leftPen lineWidth="0.5" lineColor="#4F81BD"/>
								<bottomPen lineWidth="0.5" lineColor="#4F81BD"/>
								<rightPen lineWidth="0.5" lineColor="#4F81BD"/>
							</box>
							<staticText>
								<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#8DB4E2" uuid="bac4e19f-75d0-413f-93b1-3149cc04701a"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font fontName="Arial" isBold="true"/>
								</textElement>
								<text><![CDATA[Exch]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<box>
								<topPen lineColor="#4F81BD"/>
								<leftPen lineColor="#4F81BD"/>
								<bottomPen lineColor="#4F81BD"/>
								<rightPen lineColor="#4F81BD"/>
							</box>
							<textField isBlankWhenNull="true">
								<reportElement x="0" y="0" width="90" height="30" uuid="afdc4a9a-ef61-437f-9030-3abc373931b4"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement verticalAlignment="Middle">
									<font fontName="Arial" size="11"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{PURCH_EXCH}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="eb932193-38b9-4e90-8aba-5ddf542b8b1d">
						<jr:groupHeader groupName="Contract_Status">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#C7DAF1" uuid="4873032d-1e84-46de-b2b6-3f3e90d5af7b"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:groupHeader groupName="Report_Status">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#8DB4E2" uuid="5505ffbd-a5e0-48c7-a8e2-470b920ae29e"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:groupHeader groupName="Instrument_Type">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#1F497D" uuid="efdc2c3d-25f9-4bd1-87f9-631d399806f0"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<box>
								<topPen lineWidth="0.5" lineColor="#4F81BD"/>
								<leftPen lineWidth="0.5" lineColor="#4F81BD"/>
								<bottomPen lineWidth="0.5" lineColor="#4F81BD"/>
								<rightPen lineWidth="0.5" lineColor="#4F81BD"/>
							</box>
							<staticText>
								<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#8DB4E2" uuid="f4f936f5-6050-44ec-a07e-d4b48dcd04ba"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font fontName="Arial" isBold="true"/>
								</textElement>
								<text><![CDATA[Terminal Month]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<box>
								<topPen lineColor="#4F81BD"/>
								<leftPen lineColor="#4F81BD"/>
								<bottomPen lineColor="#4F81BD"/>
								<rightPen lineColor="#4F81BD"/>
							</box>
							<textField isBlankWhenNull="true">
								<reportElement x="0" y="0" width="90" height="30" uuid="e943216f-b9b5-4066-b89c-468fd15bb62b"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement verticalAlignment="Middle">
									<font fontName="Arial" size="11"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{PURCH_TERMINAL_MONTH}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="b82b14a7-081e-45c9-9828-bec9a34cacd1">
						<jr:groupHeader groupName="Contract_Status">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#C7DAF1" uuid="73706fe9-e270-469f-b4aa-38a83a132f13"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:groupHeader groupName="Report_Status">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#8DB4E2" uuid="e96488d7-22c8-4716-8ee6-a55de280049a"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:groupHeader groupName="Instrument_Type">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#1F497D" uuid="74e46f8d-4042-486d-b386-09da945a9a7f"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<box>
								<topPen lineWidth="0.5" lineColor="#4F81BD"/>
								<leftPen lineWidth="0.5" lineColor="#4F81BD"/>
								<bottomPen lineWidth="0.5" lineColor="#4F81BD"/>
								<rightPen lineWidth="0.5" lineColor="#4F81BD"/>
							</box>
							<staticText>
								<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#8DB4E2" uuid="fa0a4cb5-52b2-47a2-b136-49ddf14a3719"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font fontName="Arial" isBold="true"/>
								</textElement>
								<text><![CDATA[Strike]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<box>
								<topPen lineColor="#4F81BD"/>
								<leftPen lineColor="#4F81BD"/>
								<bottomPen lineColor="#4F81BD"/>
								<rightPen lineColor="#4F81BD"/>
							</box>
							<textField isBlankWhenNull="true">
								<reportElement x="0" y="0" width="90" height="30" uuid="c6ce7578-258e-45af-9563-6049dcf1ac68"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement verticalAlignment="Middle">
									<font fontName="Arial" size="11"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{PURCH_STRIKE}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="0" y="0" width="90" height="30" forecolor="#FF0000" uuid="d66a7a5d-d8fb-40b9-b729-1ce7af539977">
									<property name="com.jaspersoft.studio.unit.x" value="pixel"/>
									<property name="com.jaspersoft.studio.unit.y" value="pixel"/>
									<printWhenExpression><![CDATA[$F{PURCH_STRIKE}<0]]></printWhenExpression>
								</reportElement>
								<box leftPadding="4" rightPadding="4"/>
								<textElement verticalAlignment="Middle">
									<font fontName="Arial" size="11"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{PURCH_STRIKE}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="dc10dfa6-294d-4b40-b322-283a662e5619">
						<jr:groupHeader groupName="Contract_Status">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#C7DAF1" uuid="5af6e727-e37c-4a05-9781-790ee3f588ea"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:groupHeader groupName="Report_Status">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#8DB4E2" uuid="6106060a-d4c2-4eba-bac5-6eccac4fe812"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:groupHeader groupName="Instrument_Type">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#1F497D" uuid="59655d3e-df65-44a2-adc1-83d86cc908bd"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<box>
								<topPen lineWidth="0.5" lineColor="#4F81BD"/>
								<leftPen lineWidth="0.5" lineColor="#4F81BD"/>
								<bottomPen lineWidth="0.5" lineColor="#4F81BD"/>
								<rightPen lineWidth="0.5" lineColor="#4F81BD"/>
							</box>
							<staticText>
								<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#8DB4E2" uuid="8a1ee109-64cb-4f29-8fc3-2d23ab596a38"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font fontName="Arial" isBold="true"/>
								</textElement>
								<text><![CDATA[Contract Terms]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<box>
								<topPen lineColor="#4F81BD"/>
								<leftPen lineColor="#4F81BD"/>
								<bottomPen lineColor="#4F81BD"/>
								<rightPen lineColor="#4F81BD"/>
							</box>
							<textField isBlankWhenNull="true">
								<reportElement x="0" y="0" width="90" height="30" uuid="e7e982de-d2ff-4976-ac2b-98318eeef437"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement verticalAlignment="Middle">
									<font fontName="Arial" size="11"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{PURCH_CONTRACT_TERMS}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="8a217416-50d5-42ef-9a3f-1e8c269eed86">
						<jr:groupHeader groupName="Contract_Status">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#C7DAF1" uuid="3e84af1f-6062-4cb3-b033-c1de6218be45"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:groupHeader groupName="Report_Status">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#8DB4E2" uuid="8185068d-cda3-419f-89d8-bc53c88c2536"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:groupHeader groupName="Instrument_Type">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#1F497D" uuid="e4c84bae-9ef5-410a-8572-e833339af4d4"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<box>
								<topPen lineWidth="0.5" lineColor="#4F81BD"/>
								<leftPen lineWidth="0.5" lineColor="#4F81BD"/>
								<bottomPen lineWidth="0.5" lineColor="#4F81BD"/>
								<rightPen lineWidth="0.5" lineColor="#4F81BD"/>
							</box>
							<staticText>
								<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#8DB4E2" uuid="a9fc0080-2b37-49c9-8c08-2597fba26908"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font fontName="Arial" isBold="true"/>
								</textElement>
								<text><![CDATA[Price Type]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<box>
								<topPen lineColor="#4F81BD"/>
								<leftPen lineColor="#4F81BD"/>
								<bottomPen lineColor="#4F81BD"/>
								<rightPen lineColor="#4F81BD"/>
							</box>
							<textField isBlankWhenNull="true">
								<reportElement x="0" y="0" width="90" height="30" uuid="70eb96d7-d9ae-4283-b32a-c7097c79a8c5"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement verticalAlignment="Middle">
									<font fontName="Arial" size="11"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{PURCH_PRICE_TYPE}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="8406a40f-8dc7-4b85-8d45-f7259f06fc5d">
						<jr:groupHeader groupName="Contract_Status">
							<jr:cell style="Table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineWidth="0.5" lineColor="#4F81BD"/>
									<leftPen lineWidth="0.5" lineColor="#4F81BD"/>
									<bottomPen lineWidth="0.5" lineColor="#4F81BD"/>
									<rightPen lineWidth="0.5" lineColor="#4F81BD"/>
								</box>
								<textField evaluationTime="Group" evaluationGroup="Contract_Status" pattern="#,##0;(#,##0)" isBlankWhenNull="true">
									<reportElement style="Sub1" mode="Transparent" x="0" y="0" width="90" height="30" backcolor="#C7DAF1" uuid="4787855e-5352-4648-88d7-0a6cbde634c9"/>
									<box leftPadding="4" rightPadding="4"/>
									<textElement textAlignment="Right" verticalAlignment="Middle">
										<font fontName="Arial" size="11" isBold="true" isItalic="false"/>
									</textElement>
									<textFieldExpression><![CDATA[$V{SUB_PURCH_QTY}]]></textFieldExpression>
								</textField>
							</jr:cell>
						</jr:groupHeader>
						<jr:groupHeader groupName="Report_Status">
							<jr:cell style="Table_CH" height="30" rowSpan="1">
								<box>
									<topPen lineWidth="0.5" lineColor="#4F81BD"/>
									<leftPen lineWidth="0.5" lineColor="#4F81BD"/>
									<bottomPen lineWidth="0.5" lineColor="#4F81BD"/>
									<rightPen lineWidth="0.5" lineColor="#4F81BD"/>
								</box>
								<textField evaluationTime="Group" evaluationGroup="Report_Status" pattern="#,##0;(#,##0)" isBlankWhenNull="true">
									<reportElement style="Mid1" mode="Transparent" x="0" y="0" width="90" height="30" backcolor="#8DB4E2" uuid="42cdc034-51e6-4894-a9d1-27e12bc2187b"/>
									<box leftPadding="4" rightPadding="4"/>
									<textElement textAlignment="Right" verticalAlignment="Middle">
										<font fontName="Arial" size="11" isBold="true" isItalic="false"/>
									</textElement>
									<textFieldExpression><![CDATA[$V{PURCH_QTY}]]></textFieldExpression>
								</textField>
							</jr:cell>
						</jr:groupHeader>
						<jr:groupHeader groupName="Instrument_Type">
							<jr:cell style="Table_TH" height="30" rowSpan="1">
								<box>
									<topPen lineWidth="0.5" lineColor="#4F81BD"/>
									<leftPen lineWidth="0.5" lineColor="#4F81BD"/>
									<bottomPen lineWidth="0.5" lineColor="#4F81BD"/>
									<rightPen lineWidth="0.5" lineColor="#4F81BD"/>
								</box>
								<textField evaluationTime="Group" evaluationGroup="Instrument_Type" pattern="#,##0;(#,##0)" isBlankWhenNull="true">
									<reportElement style="Total1" mode="Opaque" x="0" y="0" width="90" height="30" forecolor="#FFFFFF" backcolor="#1F497D" uuid="cff27ef9-3d7c-44d2-951a-43ef97ca7948"/>
									<box leftPadding="4" rightPadding="4"/>
									<textElement textAlignment="Right" verticalAlignment="Middle">
										<font fontName="Arial" size="12" isBold="true" isItalic="false"/>
									</textElement>
									<textFieldExpression><![CDATA[$V{TOT_PURCH_QTY}]]></textFieldExpression>
								</textField>
							</jr:cell>
						</jr:groupHeader>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<box>
								<topPen lineWidth="0.5" lineColor="#4F81BD"/>
								<leftPen lineWidth="0.5" lineColor="#4F81BD"/>
								<bottomPen lineWidth="0.5" lineColor="#4F81BD"/>
								<rightPen lineWidth="0.5" lineColor="#4F81BD"/>
							</box>
							<staticText>
								<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#8DB4E2" uuid="81cbffc5-3ee1-46fe-937e-10d7a33e5e03"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font fontName="Arial" isBold="true"/>
								</textElement>
								<text><![CDATA[Quantity]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<box>
								<topPen lineColor="#4F81BD"/>
								<leftPen lineColor="#4F81BD"/>
								<bottomPen lineColor="#4F81BD"/>
								<rightPen lineColor="#4F81BD"/>
							</box>
							<textField pattern="#,##0;(#,##0)" isBlankWhenNull="true">
								<reportElement x="0" y="0" width="90" height="30" uuid="d6960f95-85ad-4fde-8bc6-70f70d833e09"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Right" verticalAlignment="Middle">
									<font fontName="Arial" size="11"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{PURCH_QUANTITY}]]></textFieldExpression>
							</textField>
							<textField pattern="#,##0;(#,##0)" isBlankWhenNull="true">
								<reportElement x="0" y="0" width="90" height="30" forecolor="#FF0000" uuid="3f371f3a-be18-4b83-8571-5bbfcdd0c88f">
									<property name="com.jaspersoft.studio.unit.x" value="pixel"/>
									<property name="com.jaspersoft.studio.unit.y" value="pixel"/>
									<printWhenExpression><![CDATA[$F{PURCH_QUANTITY}.intValue()<0]]></printWhenExpression>
								</reportElement>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Right" verticalAlignment="Middle">
									<font fontName="Arial" size="11"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{PURCH_QUANTITY}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="13e28dcf-bb2e-4c52-9ee7-67ac5b4674fe">
						<jr:groupHeader groupName="Contract_Status">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#C7DAF1" uuid="c208c0f6-17df-4d95-996a-1002c7eecfd1"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:groupHeader groupName="Report_Status">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#8DB4E2" uuid="72273dbf-d802-4484-8043-6d4d87e01b50"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:groupHeader groupName="Instrument_Type">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#1F497D" uuid="d452266d-29d2-4311-ad3b-7bfcfa21736b"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<box>
								<topPen lineWidth="0.5" lineColor="#4F81BD"/>
								<leftPen lineWidth="0.5" lineColor="#4F81BD"/>
								<bottomPen lineWidth="0.5" lineColor="#4F81BD"/>
								<rightPen lineWidth="0.5" lineColor="#4F81BD"/>
							</box>
							<staticText>
								<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#8DB4E2" uuid="17f9cc73-8092-4d01-ba29-b9716cc3b5f1"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font fontName="Arial" isBold="true"/>
								</textElement>
								<text><![CDATA[Contract Price ($/Ton)]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<box>
								<topPen lineColor="#4F81BD"/>
								<leftPen lineColor="#4F81BD"/>
								<bottomPen lineColor="#4F81BD"/>
								<rightPen lineColor="#4F81BD"/>
							</box>
							<textField pattern="#,##0;(#,##0)" isBlankWhenNull="true">
								<reportElement x="0" y="0" width="90" height="30" uuid="f19c4b97-dafd-4200-b45f-1fccd41667bd"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Right" verticalAlignment="Middle">
									<font fontName="Arial" size="11"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{PURCH_CONTRACT_PRICE}]]></textFieldExpression>
							</textField>
							<textField pattern="#,##0;(#,##0)" isBlankWhenNull="true">
								<reportElement x="0" y="0" width="90" height="30" forecolor="#FF0000" uuid="d6df5dc5-5c2b-4bcb-bd76-4874ef0e64d1">
									<printWhenExpression><![CDATA[$F{PURCH_CONTRACT_PRICE}.intValue()<0]]></printWhenExpression>
								</reportElement>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Right" verticalAlignment="Middle">
									<font fontName="Arial" size="11"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{PURCH_CONTRACT_PRICE}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="1698ab2d-3bf4-4a48-bf3a-018674a7f4e5">
						<jr:groupHeader groupName="Contract_Status">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#C7DAF1" uuid="197a075d-3861-4518-b7a9-6a6b766e5480"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:groupHeader groupName="Report_Status">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#8DB4E2" uuid="49684a0f-29f1-4252-b745-959dd1645f85"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:groupHeader groupName="Instrument_Type">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#1F497D" uuid="dc286ec9-d88a-4aa9-8b5a-4e459f76bee4"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<box>
								<topPen lineWidth="0.5" lineColor="#4F81BD"/>
								<leftPen lineWidth="0.5" lineColor="#4F81BD"/>
								<bottomPen lineWidth="0.5" lineColor="#4F81BD"/>
								<rightPen lineWidth="0.5" lineColor="#4F81BD"/>
							</box>
							<staticText>
								<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#8DB4E2" uuid="e7e8ad64-4377-4706-9a80-5b92970c6b4f"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font fontName="Arial" isBold="true"/>
								</textElement>
								<text><![CDATA[Direct Cost ($/Ton)]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<box>
								<topPen lineColor="#4F81BD"/>
								<leftPen lineColor="#4F81BD"/>
								<bottomPen lineColor="#4F81BD"/>
								<rightPen lineColor="#4F81BD"/>
							</box>
							<textField pattern="#,##0;(#,##0)" isBlankWhenNull="true">
								<reportElement x="0" y="0" width="90" height="30" uuid="e1b1209e-80aa-4a45-90b6-2df3adcfdb7a"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Right" verticalAlignment="Middle">
									<font fontName="Arial" size="11"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{PURCH_DIRECT_COST}]]></textFieldExpression>
							</textField>
							<textField pattern="#,##0;(#,##0)" isBlankWhenNull="true">
								<reportElement x="0" y="0" width="90" height="30" forecolor="#FF0000" uuid="02712802-0c9b-46a4-a368-e168d3cf7a0d">
									<printWhenExpression><![CDATA[$F{PURCH_DIRECT_COST}.intValue()<0]]></printWhenExpression>
								</reportElement>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Right" verticalAlignment="Middle">
									<font fontName="Arial" size="11"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{PURCH_DIRECT_COST}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="80e86a5a-1ac3-47bd-b9c4-903175cec983">
						<jr:groupHeader groupName="Contract_Status">
							<jr:cell style="Table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineWidth="0.5" lineColor="#4F81BD"/>
									<leftPen lineWidth="0.5" lineColor="#4F81BD"/>
									<bottomPen lineWidth="0.5" lineColor="#4F81BD"/>
									<rightPen lineWidth="0.5" lineColor="#4F81BD"/>
								</box>
								<textField evaluationTime="Group" evaluationGroup="Contract_Status" pattern="#,##0;(#,##0)" isBlankWhenNull="true">
									<reportElement style="Sub2" mode="Transparent" x="0" y="0" width="90" height="30" backcolor="#C7DAF1" uuid="e161740f-d2d3-40bd-8399-d61b5756e652"/>
									<box leftPadding="4" rightPadding="4"/>
									<textElement textAlignment="Right" verticalAlignment="Middle">
										<font fontName="Arial" size="11" isBold="true" isItalic="false"/>
									</textElement>
									<textFieldExpression><![CDATA[$V{SUB_TOTAL_COST}]]></textFieldExpression>
								</textField>
							</jr:cell>
						</jr:groupHeader>
						<jr:groupHeader groupName="Report_Status">
							<jr:cell style="Table_CH" height="30" rowSpan="1">
								<box>
									<topPen lineWidth="0.5" lineColor="#4F81BD"/>
									<leftPen lineWidth="0.5" lineColor="#4F81BD"/>
									<bottomPen lineWidth="0.5" lineColor="#4F81BD"/>
									<rightPen lineWidth="0.5" lineColor="#4F81BD"/>
								</box>
								<textField evaluationTime="Group" evaluationGroup="Report_Status" pattern="#,##0;(#,##0)" isBlankWhenNull="true">
									<reportElement style="Mid2" mode="Transparent" x="0" y="0" width="90" height="30" backcolor="#8DB4E2" uuid="77eb0b1a-c66c-4b60-bea3-570bcb672404"/>
									<box leftPadding="4" rightPadding="4"/>
									<textElement textAlignment="Right" verticalAlignment="Middle">
										<font fontName="Arial" size="11" isBold="true" isItalic="false"/>
									</textElement>
									<textFieldExpression><![CDATA[$V{TOTAL_COST}]]></textFieldExpression>
								</textField>
							</jr:cell>
						</jr:groupHeader>
						<jr:groupHeader groupName="Instrument_Type">
							<jr:cell style="Table_TH" height="30" rowSpan="1">
								<box>
									<topPen lineWidth="0.5" lineColor="#4F81BD"/>
									<leftPen lineWidth="0.5" lineColor="#4F81BD"/>
									<bottomPen lineWidth="0.5" lineColor="#4F81BD"/>
									<rightPen lineWidth="0.5" lineColor="#4F81BD"/>
								</box>
								<textField evaluationTime="Group" evaluationGroup="Instrument_Type" pattern="#,##0;(#,##0)" isBlankWhenNull="true">
									<reportElement style="Total2" mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#1F497D" uuid="e2991a0e-f90a-48f2-a5b6-e1fa1bd5ef28"/>
									<box leftPadding="4" rightPadding="4"/>
									<textElement textAlignment="Right" verticalAlignment="Middle">
										<font fontName="Arial" size="12" isBold="true" isItalic="false"/>
									</textElement>
									<textFieldExpression><![CDATA[$V{TOT_TOTAL_COST}]]></textFieldExpression>
								</textField>
							</jr:cell>
						</jr:groupHeader>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<box>
								<topPen lineWidth="0.5" lineColor="#4F81BD"/>
								<leftPen lineWidth="0.5" lineColor="#4F81BD"/>
								<bottomPen lineWidth="0.5" lineColor="#4F81BD"/>
								<rightPen lineWidth="0.5" lineColor="#4F81BD"/>
							</box>
							<staticText>
								<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#8DB4E2" uuid="b9277b6b-81f3-44e8-b5a8-8b72ac20e853"/>
								<box leftPadding="4" rightPadding="4">
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font fontName="Arial" isBold="true"/>
								</textElement>
								<text><![CDATA[Total Cost]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<box>
								<topPen lineColor="#4F81BD"/>
								<leftPen lineColor="#4F81BD"/>
								<bottomPen lineColor="#4F81BD"/>
								<rightPen lineColor="#4F81BD"/>
							</box>
							<textField pattern="#,##0;(#,##0)" isBlankWhenNull="true">
								<reportElement x="0" y="0" width="90" height="30" uuid="fadd6648-346e-4368-b34e-96931ffedcc4"/>
								<box leftPadding="4" rightPadding="4">
									<rightPen lineWidth="0.5" lineColor="#4F81BD"/>
								</box>
								<textElement textAlignment="Right" verticalAlignment="Middle">
									<font fontName="Arial" size="11"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{TOTAL_COST}]]></textFieldExpression>
							</textField>
							<textField pattern="#,##0;(#,##0)" isBlankWhenNull="true">
								<reportElement x="0" y="0" width="90" height="30" forecolor="#FF0000" uuid="c18de8cd-b72d-48fd-9004-a19dfc11333b">
									<printWhenExpression><![CDATA[$F{TOTAL_COST}.intValue()<0]]></printWhenExpression>
								</reportElement>
								<box leftPadding="4" rightPadding="4">
									<rightPen lineWidth="0.5" lineColor="#4F81BD"/>
								</box>
								<textElement textAlignment="Right" verticalAlignment="Middle">
									<font fontName="Arial" size="11"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{TOTAL_COST}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="b16c2573-bb82-4638-a5db-9bebcdf8da82">
						<jr:groupHeader groupName="Contract_Status">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineWidth="2.5" lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#C7DAF1" uuid="6b3b79f2-6ac4-4012-ab3b-09931bc8f2a0"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:groupHeader groupName="Report_Status">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineWidth="2.5" lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#8DB4E2" uuid="a7c717e7-09e7-426d-896e-235e74e6413f"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:groupHeader groupName="Instrument_Type">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineWidth="2.5" lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#1F497D" uuid="197a5311-8576-441c-b2e3-2563d64b7124"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<box>
								<topPen lineWidth="0.5" lineColor="#4F81BD"/>
								<leftPen lineWidth="2.5" lineColor="#4F81BD"/>
								<bottomPen lineWidth="0.5" lineColor="#4F81BD"/>
								<rightPen lineWidth="0.5" lineColor="#4F81BD"/>
							</box>
							<staticText>
								<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#8DB4E2" uuid="5c6475b6-2044-471b-8427-d52099f610d5"/>
								<box leftPadding="4" rightPadding="4">
									<leftPen lineWidth="0.0"/>
								</box>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font fontName="Arial" isBold="true"/>
								</textElement>
								<text><![CDATA[Transaction Date]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<box>
								<topPen lineColor="#4F81BD"/>
								<leftPen lineWidth="2.5" lineColor="#4F81BD"/>
								<bottomPen lineColor="#4F81BD"/>
								<rightPen lineColor="#4F81BD"/>
							</box>
							<textField pattern="dd-MMM-yy" isBlankWhenNull="true">
								<reportElement x="0" y="0" width="90" height="30" uuid="b554465d-6ac6-4867-96c1-d084061fc885"/>
								<box leftPadding="4" rightPadding="4">
									<leftPen lineWidth="1.5" lineColor="#4F81BD"/>
								</box>
								<textElement textAlignment="Right" verticalAlignment="Middle">
									<font fontName="Arial" size="11"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{SALES_TRANSACTION_DATE}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="140" uuid="0f143649-ade7-46ef-9985-9fe0040a89c0">
						<jr:groupHeader groupName="Contract_Status">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="140" height="30" backcolor="#C7DAF1" uuid="04e2334d-dfc4-4fb0-82aa-64887ea5abce"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:groupHeader groupName="Report_Status">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="140" height="30" backcolor="#8DB4E2" uuid="c091df72-b923-419d-97b9-1c35e01e716c"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:groupHeader groupName="Instrument_Type">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="140" height="30" backcolor="#1F497D" uuid="f13f5413-0d6b-41ce-9b0b-ab3f02dd84eb"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<box>
								<topPen lineWidth="0.5" lineColor="#4F81BD"/>
								<leftPen lineWidth="0.5" lineColor="#4F81BD"/>
								<bottomPen lineWidth="0.5" lineColor="#4F81BD"/>
								<rightPen lineWidth="0.5" lineColor="#4F81BD"/>
							</box>
							<staticText>
								<reportElement mode="Opaque" x="0" y="0" width="140" height="30" backcolor="#8DB4E2" uuid="743e3ad8-7e06-486d-a8c4-64a0d9a70ad7"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font fontName="Arial" isBold="true"/>
								</textElement>
								<text><![CDATA[Sales Ref No]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<box>
								<topPen lineColor="#4F81BD"/>
								<leftPen lineColor="#4F81BD"/>
								<bottomPen lineColor="#4F81BD"/>
								<rightPen lineColor="#4F81BD"/>
							</box>
							<textField isBlankWhenNull="true">
								<reportElement x="0" y="0" width="140" height="30" uuid="0419181c-5c5f-4460-a1da-a668ae317ade"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement verticalAlignment="Middle">
									<font fontName="Arial" size="11"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{SALES_REF_NO}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="130" uuid="81417435-3a13-46bc-9360-22f77ef2fb5d">
						<jr:groupHeader groupName="Contract_Status">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="130" height="30" backcolor="#C7DAF1" uuid="555ef9cd-182b-4a0d-903a-f861094de53d"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:groupHeader groupName="Report_Status">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="130" height="30" backcolor="#8DB4E2" uuid="c20d5f98-08fc-483e-b12f-d794a635896d"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:groupHeader groupName="Instrument_Type">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="130" height="30" backcolor="#1F497D" uuid="9d9f6117-339e-4a86-b10f-7ad046b4268c"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<box>
								<topPen lineWidth="0.5" lineColor="#4F81BD"/>
								<leftPen lineWidth="0.5" lineColor="#4F81BD"/>
								<bottomPen lineWidth="0.5" lineColor="#4F81BD"/>
								<rightPen lineWidth="0.5" lineColor="#4F81BD"/>
							</box>
							<staticText>
								<reportElement mode="Opaque" x="0" y="0" width="130" height="30" backcolor="#8DB4E2" uuid="ffe19b70-26f1-4b7e-91c1-6e04ff657520"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font fontName="Arial" isBold="true"/>
								</textElement>
								<text><![CDATA[Unit]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<box>
								<topPen lineColor="#4F81BD"/>
								<leftPen lineColor="#4F81BD"/>
								<bottomPen lineColor="#4F81BD"/>
								<rightPen lineColor="#4F81BD"/>
							</box>
							<textField isBlankWhenNull="true">
								<reportElement x="0" y="0" width="130" height="30" uuid="45dda6bd-3d9d-454f-ae6c-d2326f5838b0"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement verticalAlignment="Middle">
									<font fontName="Arial" size="11"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{SALES_UNIT}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="150" uuid="e94e0d43-3dc0-4518-9aff-ad9114c90499">
						<jr:groupHeader groupName="Contract_Status">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="150" height="30" backcolor="#C7DAF1" uuid="26062d80-5c9c-43df-822b-bcdb7c97729a"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:groupHeader groupName="Report_Status">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="150" height="30" backcolor="#8DB4E2" uuid="d5ee1daa-178d-4332-bfb7-181e92edbe4d"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:groupHeader groupName="Instrument_Type">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="150" height="30" backcolor="#1F497D" uuid="5288ec04-f8f8-4e01-a0cf-d6b514988c6b"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<box>
								<topPen lineWidth="0.5" lineColor="#4F81BD"/>
								<leftPen lineWidth="0.5" lineColor="#4F81BD"/>
								<bottomPen lineWidth="0.5" lineColor="#4F81BD"/>
								<rightPen lineWidth="0.5" lineColor="#4F81BD"/>
							</box>
							<staticText>
								<reportElement mode="Opaque" x="0" y="0" width="150" height="30" backcolor="#8DB4E2" uuid="fb28cfe9-63e4-4a26-af24-183bc98b5688"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font fontName="Arial" isBold="true"/>
								</textElement>
								<text><![CDATA[Party]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<box>
								<topPen lineColor="#4F81BD"/>
								<leftPen lineColor="#4F81BD"/>
								<bottomPen lineColor="#4F81BD"/>
								<rightPen lineColor="#4F81BD"/>
							</box>
							<textField isBlankWhenNull="true">
								<reportElement x="0" y="0" width="150" height="30" uuid="d73aee6f-112e-491d-af64-7594188c7323"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement verticalAlignment="Middle">
									<font fontName="Arial" size="11"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{SALES_PARTY}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="14039b9c-865b-437d-8de6-dddde1fc6ad1">
						<jr:groupHeader groupName="Contract_Status">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#C7DAF1" uuid="38a65939-dba4-4bc8-a277-496e5218d24d"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:groupHeader groupName="Report_Status">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#8DB4E2" uuid="ea47d9b0-2a4f-40fb-a3fc-1874885ea261"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:groupHeader groupName="Instrument_Type">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#1F497D" uuid="d884504f-8818-4b1a-9fae-fb77820c0ce6"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<box>
								<topPen lineWidth="0.5" lineColor="#4F81BD"/>
								<leftPen lineWidth="0.5" lineColor="#4F81BD"/>
								<bottomPen lineWidth="0.5" lineColor="#4F81BD"/>
								<rightPen lineWidth="0.5" lineColor="#4F81BD"/>
							</box>
							<staticText>
								<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#8DB4E2" uuid="00c569cc-655c-4bcd-b436-f1443ee5b495"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font fontName="Arial" isBold="true"/>
								</textElement>
								<text><![CDATA[Product]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<box>
								<topPen lineColor="#4F81BD"/>
								<leftPen lineColor="#4F81BD"/>
								<bottomPen lineColor="#4F81BD"/>
								<rightPen lineColor="#4F81BD"/>
							</box>
							<textField isBlankWhenNull="true">
								<reportElement x="0" y="0" width="90" height="30" uuid="095256c7-2a5c-4fcd-8178-1f7860c3b7c1"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement verticalAlignment="Middle">
									<font fontName="Arial" size="11"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{SALES_PRODUCT}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="d1c08ec1-daa2-47f6-9ccb-48a5b9d34f10">
						<jr:groupHeader groupName="Contract_Status">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#C7DAF1" uuid="e31f4965-291e-42cc-9e94-89c1f116fdf3"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:groupHeader groupName="Report_Status">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#8DB4E2" uuid="9c892d20-e3c9-493d-874f-97ebc7168c0a"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:groupHeader groupName="Instrument_Type">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#1F497D" uuid="c4e7e154-5bd6-448c-bb47-2c8ddcb1bb69"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<box>
								<topPen lineWidth="0.5" lineColor="#4F81BD"/>
								<leftPen lineWidth="0.5" lineColor="#4F81BD"/>
								<bottomPen lineWidth="0.5" lineColor="#4F81BD"/>
								<rightPen lineWidth="0.5" lineColor="#4F81BD"/>
							</box>
							<staticText>
								<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#8DB4E2" uuid="26f2edb6-3f10-4b45-a0ce-0e3fd4923987"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font fontName="Arial" isBold="true"/>
								</textElement>
								<text><![CDATA[Grade]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<box>
								<topPen lineColor="#4F81BD"/>
								<leftPen lineColor="#4F81BD"/>
								<bottomPen lineColor="#4F81BD"/>
								<rightPen lineColor="#4F81BD"/>
							</box>
							<textField isBlankWhenNull="true">
								<reportElement x="0" y="0" width="90" height="30" uuid="672c6341-8df5-490f-895a-56e3c79e96da"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement verticalAlignment="Middle">
									<font fontName="Arial" size="11"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{SALES_GRADE}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="3bce4222-a39e-49d8-8f45-224d7025fe6c">
						<jr:groupHeader groupName="Contract_Status">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#C7DAF1" uuid="297a8b45-f138-4184-9a1b-0c68857750aa"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:groupHeader groupName="Report_Status">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#8DB4E2" uuid="ceaa8701-c923-4cd4-9c3f-e4d09b956985"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:groupHeader groupName="Instrument_Type">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#1F497D" uuid="57276f59-7d1f-4205-9ab5-d66ebd8f2781"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<box>
								<topPen lineWidth="0.5" lineColor="#4F81BD"/>
								<leftPen lineWidth="0.5" lineColor="#4F81BD"/>
								<bottomPen lineWidth="0.5" lineColor="#4F81BD"/>
								<rightPen lineWidth="0.5" lineColor="#4F81BD"/>
							</box>
							<staticText>
								<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#8DB4E2" uuid="2ed68381-d5c0-4873-a756-8640e7224560"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font fontName="Arial" isBold="true"/>
								</textElement>
								<text><![CDATA[Shipment Month]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<box>
								<topPen lineColor="#4F81BD"/>
								<leftPen lineColor="#4F81BD"/>
								<bottomPen lineColor="#4F81BD"/>
								<rightPen lineColor="#4F81BD"/>
							</box>
							<textField isBlankWhenNull="true">
								<reportElement x="0" y="0" width="90" height="30" uuid="a518a46c-0bd0-47e3-933c-fd7c4dcbed61"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement verticalAlignment="Middle">
									<font fontName="Arial" size="11"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{SALES_SHIPMENT_MONTH}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="9d72d7c6-2fda-491c-a7cb-0e16aac784a2">
						<jr:groupHeader groupName="Contract_Status">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#C7DAF1" uuid="9d1709fa-d05c-4874-8f2c-b83bbf727359"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:groupHeader groupName="Report_Status">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#8DB4E2" uuid="d193e522-d034-468b-be81-54eab317c6ec"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:groupHeader groupName="Instrument_Type">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#1F497D" uuid="72ac3453-2ff1-4d13-8d56-e6fae8da5786"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<box>
								<topPen lineWidth="0.5" lineColor="#4F81BD"/>
								<leftPen lineWidth="0.5" lineColor="#4F81BD"/>
								<bottomPen lineWidth="0.5" lineColor="#4F81BD"/>
								<rightPen lineWidth="0.5" lineColor="#4F81BD"/>
							</box>
							<staticText>
								<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#8DB4E2" uuid="9f5141c4-72b4-42be-99a9-f45f0244c252"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font fontName="Arial" isBold="true"/>
								</textElement>
								<text><![CDATA[Exch]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<box>
								<topPen lineColor="#4F81BD"/>
								<leftPen lineColor="#4F81BD"/>
								<bottomPen lineColor="#4F81BD"/>
								<rightPen lineColor="#4F81BD"/>
							</box>
							<textField isBlankWhenNull="true">
								<reportElement x="0" y="0" width="90" height="30" uuid="3e8de754-20cd-461c-8685-24e75ad011c1"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement verticalAlignment="Middle">
									<font fontName="Arial" size="11"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{SALES_EXCH}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="d15261ef-7f20-4b6a-8de7-f0f66359fa2e">
						<jr:groupHeader groupName="Contract_Status">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#C7DAF1" uuid="24d05597-4d4f-478f-b5a7-a2669d4a91ac"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:groupHeader groupName="Report_Status">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#8DB4E2" uuid="bea31e03-54a1-48a9-92a7-a07a43bca49b"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:groupHeader groupName="Instrument_Type">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#1F497D" uuid="4e71de16-fe8e-4515-a8be-14857bce985f"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<box>
								<topPen lineWidth="0.5" lineColor="#4F81BD"/>
								<leftPen lineWidth="0.5" lineColor="#4F81BD"/>
								<bottomPen lineWidth="0.5" lineColor="#4F81BD"/>
								<rightPen lineWidth="0.5" lineColor="#4F81BD"/>
							</box>
							<staticText>
								<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#8DB4E2" uuid="fdb537cf-0737-41e5-ab51-2e02a8ec8061"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font fontName="Arial" isBold="true"/>
								</textElement>
								<text><![CDATA[Terminal Month]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<box>
								<topPen lineColor="#4F81BD"/>
								<leftPen lineColor="#4F81BD"/>
								<bottomPen lineColor="#4F81BD"/>
								<rightPen lineColor="#4F81BD"/>
							</box>
							<textField isBlankWhenNull="true">
								<reportElement x="0" y="0" width="90" height="30" uuid="91775e79-4f2d-4575-9afb-f5a1c2ad644c"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement verticalAlignment="Middle">
									<font fontName="Arial" size="11"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{SALES_TERMINAL_MONTH}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="1f668158-b1d4-45e4-a9f8-f92c69844d55">
						<jr:groupHeader groupName="Contract_Status">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#C7DAF1" uuid="20d83d93-ebde-4aea-b6be-be64a4f5516f"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:groupHeader groupName="Report_Status">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#8DB4E2" uuid="d6b4bb85-0218-4200-bcf4-9499d95cecf7"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:groupHeader groupName="Instrument_Type">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#1F497D" uuid="61549520-6407-4672-88c2-9456e6aff9da"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<box>
								<topPen lineWidth="0.5" lineColor="#4F81BD"/>
								<leftPen lineWidth="0.5" lineColor="#4F81BD"/>
								<bottomPen lineWidth="0.5" lineColor="#4F81BD"/>
								<rightPen lineWidth="0.5" lineColor="#4F81BD"/>
							</box>
							<staticText>
								<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#8DB4E2" uuid="535935c7-4139-40b5-b9cb-73cba8b98a5a"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font fontName="Arial" isBold="true"/>
								</textElement>
								<text><![CDATA[Strike]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<box>
								<topPen lineColor="#4F81BD"/>
								<leftPen lineColor="#4F81BD"/>
								<bottomPen lineColor="#4F81BD"/>
								<rightPen lineColor="#4F81BD"/>
							</box>
							<textField isBlankWhenNull="true">
								<reportElement x="0" y="0" width="90" height="30" uuid="9d9d35dd-fff1-4320-925c-cdc1043060f9"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement verticalAlignment="Middle">
									<font fontName="Arial" size="11"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{SALES_STRIKE}]]></textFieldExpression>
							</textField>
							<textField isBlankWhenNull="true">
								<reportElement x="0" y="0" width="90" height="30" forecolor="#FF0000" uuid="650c4959-0c79-4ad8-8442-f79b174f605c">
									<property name="com.jaspersoft.studio.unit.x" value="pixel"/>
									<property name="com.jaspersoft.studio.unit.y" value="pixel"/>
									<printWhenExpression><![CDATA[$F{SALES_STRIKE}<0]]></printWhenExpression>
								</reportElement>
								<box leftPadding="4" rightPadding="4"/>
								<textElement verticalAlignment="Middle">
									<font fontName="Arial" size="11"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{SALES_STRIKE}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="d3942d5b-0dd5-4ba6-a1f0-dab2b37efa9a">
						<jr:groupHeader groupName="Contract_Status">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#C7DAF1" uuid="0d51074d-8e2b-411d-864f-63793fc1e912"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:groupHeader groupName="Report_Status">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#8DB4E2" uuid="89f3f8c9-6ab2-4ed1-82cc-c36f74d4bc33"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:groupHeader groupName="Instrument_Type">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#1F497D" uuid="07b0ec76-6362-4f85-a3d5-efe67486c521"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<box>
								<topPen lineWidth="0.5" lineColor="#4F81BD"/>
								<leftPen lineWidth="0.5" lineColor="#4F81BD"/>
								<bottomPen lineWidth="0.5" lineColor="#4F81BD"/>
								<rightPen lineWidth="0.5" lineColor="#4F81BD"/>
							</box>
							<staticText>
								<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#8DB4E2" uuid="b6f86829-d3bc-47b6-81df-0c2f31f83e80"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font fontName="Arial" isBold="true"/>
								</textElement>
								<text><![CDATA[Contract Terms]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<box>
								<topPen lineColor="#4F81BD"/>
								<leftPen lineColor="#4F81BD"/>
								<bottomPen lineColor="#4F81BD"/>
								<rightPen lineColor="#4F81BD"/>
							</box>
							<textField isBlankWhenNull="true">
								<reportElement x="0" y="0" width="90" height="30" uuid="1a50b640-9a7f-4e66-97a0-dc2a797d08b1"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement verticalAlignment="Middle">
									<font fontName="Arial" size="11"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{SALES_CONTRACT_TERMS}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="3d97c737-f8d9-48b5-b62b-88980bf7dc86">
						<jr:groupHeader groupName="Contract_Status">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#C7DAF1" uuid="ea393ab8-1986-4b02-abc3-423e7749a670"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:groupHeader groupName="Report_Status">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#8DB4E2" uuid="2036102c-6bd1-4db2-b42e-541082e78f01"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:groupHeader groupName="Instrument_Type">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#1F497D" uuid="fab84136-73bf-4652-8bed-a15ca24a7e79"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<box>
								<topPen lineWidth="0.5" lineColor="#4F81BD"/>
								<leftPen lineWidth="0.5" lineColor="#4F81BD"/>
								<bottomPen lineWidth="0.5" lineColor="#4F81BD"/>
								<rightPen lineWidth="0.5" lineColor="#4F81BD"/>
							</box>
							<staticText>
								<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#8DB4E2" uuid="9b6063bf-74b2-4927-baf7-d8d3f523d100"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font fontName="Arial" isBold="true"/>
								</textElement>
								<text><![CDATA[Price Type]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<box>
								<topPen lineColor="#4F81BD"/>
								<leftPen lineColor="#4F81BD"/>
								<bottomPen lineColor="#4F81BD"/>
								<rightPen lineColor="#4F81BD"/>
							</box>
							<textField isBlankWhenNull="true">
								<reportElement x="0" y="0" width="90" height="30" uuid="fed95a33-a68a-4ebe-91fb-a4d2ed84a913"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement verticalAlignment="Middle">
									<font fontName="Arial" size="11"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{SALES_PRICE_TYPE}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="3754dc99-0471-4c93-a30e-abe09863294b">
						<jr:groupHeader groupName="Contract_Status">
							<jr:cell style="Table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineWidth="0.5" lineColor="#4F81BD"/>
									<leftPen lineWidth="0.5" lineColor="#4F81BD"/>
									<bottomPen lineWidth="0.5" lineColor="#4F81BD"/>
									<rightPen lineWidth="0.5" lineColor="#4F81BD"/>
								</box>
								<textField evaluationTime="Group" evaluationGroup="Contract_Status" pattern="#,##0;(#,##0)" isBlankWhenNull="true">
									<reportElement style="Sub3" mode="Transparent" x="0" y="0" width="90" height="30" backcolor="#C7DAF1" uuid="c805b291-1408-42a2-b16a-f675b3d52700"/>
									<box leftPadding="4" rightPadding="4"/>
									<textElement textAlignment="Right" verticalAlignment="Middle">
										<font fontName="Arial" size="11" isBold="true" isItalic="false"/>
									</textElement>
									<textFieldExpression><![CDATA[$V{SUB_SALES_QTY}]]></textFieldExpression>
								</textField>
							</jr:cell>
						</jr:groupHeader>
						<jr:groupHeader groupName="Report_Status">
							<jr:cell style="Table_CH" height="30" rowSpan="1">
								<box>
									<topPen lineWidth="0.5" lineColor="#4F81BD"/>
									<leftPen lineWidth="0.5" lineColor="#4F81BD"/>
									<bottomPen lineWidth="0.5" lineColor="#4F81BD"/>
									<rightPen lineWidth="0.5" lineColor="#4F81BD"/>
								</box>
								<textField evaluationTime="Group" evaluationGroup="Report_Status" pattern="#,##0;(#,##0)" isBlankWhenNull="true">
									<reportElement style="Mid3" mode="Transparent" x="0" y="0" width="90" height="30" backcolor="#8DB4E2" uuid="57bff641-a347-48e7-9f05-c887f3a764fb"/>
									<box leftPadding="4" rightPadding="4"/>
									<textElement textAlignment="Right" verticalAlignment="Middle">
										<font fontName="Arial" size="11" isBold="true" isItalic="false"/>
									</textElement>
									<textFieldExpression><![CDATA[$V{SALES_QTY}]]></textFieldExpression>
								</textField>
							</jr:cell>
						</jr:groupHeader>
						<jr:groupHeader groupName="Instrument_Type">
							<jr:cell style="Table_TH" height="30" rowSpan="1">
								<box>
									<topPen lineWidth="0.5" lineColor="#4F81BD"/>
									<leftPen lineWidth="0.5" lineColor="#4F81BD"/>
									<bottomPen lineWidth="0.5" lineColor="#4F81BD"/>
									<rightPen lineWidth="0.5" lineColor="#4F81BD"/>
								</box>
								<textField evaluationTime="Group" evaluationGroup="Instrument_Type" pattern="#,##0;(#,##0)" isBlankWhenNull="true">
									<reportElement style="Total3" mode="Transparent" x="0" y="0" width="90" height="30" backcolor="#1F497D" uuid="b26c7792-a4c7-4f22-804a-48f463102272"/>
									<box leftPadding="4" rightPadding="4"/>
									<textElement textAlignment="Right" verticalAlignment="Middle">
										<font fontName="Arial" size="12" isBold="true" isItalic="false"/>
									</textElement>
									<textFieldExpression><![CDATA[$V{TOT_SALES_QTY}]]></textFieldExpression>
								</textField>
							</jr:cell>
						</jr:groupHeader>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<box>
								<topPen lineWidth="0.5" lineColor="#4F81BD"/>
								<leftPen lineWidth="0.5" lineColor="#4F81BD"/>
								<bottomPen lineWidth="0.5" lineColor="#4F81BD"/>
								<rightPen lineWidth="0.5" lineColor="#4F81BD"/>
							</box>
							<staticText>
								<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#8DB4E2" uuid="004f6827-a8de-4db4-8ff0-2008c7e0d333"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font fontName="Arial" isBold="true"/>
								</textElement>
								<text><![CDATA[Quantity]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<box>
								<topPen lineColor="#4F81BD"/>
								<leftPen lineColor="#4F81BD"/>
								<bottomPen lineColor="#4F81BD"/>
								<rightPen lineColor="#4F81BD"/>
							</box>
							<textField pattern="#,##0;(#,##0)" isBlankWhenNull="true">
								<reportElement x="0" y="0" width="90" height="30" uuid="c631ffbb-171c-47d3-a7e0-8e5d271a377d"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Right" verticalAlignment="Middle">
									<font fontName="Arial" size="11"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{SALES_QUANTITY}]]></textFieldExpression>
							</textField>
							<textField pattern="#,##0;(#,##0)" isBlankWhenNull="true">
								<reportElement x="0" y="0" width="90" height="30" forecolor="#FF0000" uuid="4474c567-738e-4764-b460-2baeb418fc73">
									<property name="com.jaspersoft.studio.unit.x" value="pixel"/>
									<property name="com.jaspersoft.studio.unit.y" value="pixel"/>
									<printWhenExpression><![CDATA[$F{SALES_QUANTITY}.intValue()<0]]></printWhenExpression>
								</reportElement>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Right" verticalAlignment="Middle">
									<font fontName="Arial" size="11"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{SALES_QUANTITY}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="5843ddaf-fe9a-43c3-97fa-44327bad5a36">
						<jr:groupHeader groupName="Contract_Status">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#C7DAF1" uuid="9bd12811-757c-4fbf-9d33-365c394b5eea"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:groupHeader groupName="Report_Status">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#8DB4E2" uuid="9ce49288-b2e0-4a72-868c-161e5fbaa9fc"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:groupHeader groupName="Instrument_Type">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#1F497D" uuid="b4a6982e-d165-4b17-b2e9-e646fa59fd21"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<box>
								<topPen lineWidth="0.5" lineColor="#4F81BD"/>
								<leftPen lineWidth="0.5" lineColor="#4F81BD"/>
								<bottomPen lineWidth="0.5" lineColor="#4F81BD"/>
								<rightPen lineWidth="0.5" lineColor="#4F81BD"/>
							</box>
							<staticText>
								<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#8DB4E2" uuid="ae4d7744-7cbd-4040-af39-51c2eb9d65b8"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font fontName="Arial" isBold="true"/>
								</textElement>
								<text><![CDATA[Contract Price ($/Ton)]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<box>
								<topPen lineColor="#4F81BD"/>
								<leftPen lineColor="#4F81BD"/>
								<bottomPen lineColor="#4F81BD"/>
								<rightPen lineColor="#4F81BD"/>
							</box>
							<textField pattern="#,##0;(#,##0)" isBlankWhenNull="true">
								<reportElement x="0" y="0" width="90" height="30" uuid="448622bd-b473-4dab-9c3b-83206902d423"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Right" verticalAlignment="Middle">
									<font fontName="Arial" size="11"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{SALES_CONTRACT_PRICE}]]></textFieldExpression>
							</textField>
							<textField pattern="#,##0;(#,##0)" isBlankWhenNull="true">
								<reportElement x="0" y="0" width="90" height="30" forecolor="#FF0000" uuid="dba7befe-35b1-4525-a01f-e88dbeab4a67">
									<property name="com.jaspersoft.studio.unit.x" value="pixel"/>
									<property name="com.jaspersoft.studio.unit.y" value="pixel"/>
									<printWhenExpression><![CDATA[$F{SALES_CONTRACT_PRICE}.intValue()<0]]></printWhenExpression>
								</reportElement>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Right" verticalAlignment="Middle">
									<font fontName="Arial" size="11"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{SALES_CONTRACT_PRICE}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="26dad8fd-43a3-44a5-97ed-b8c5eab555f0">
						<jr:groupHeader groupName="Contract_Status">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#C7DAF1" uuid="ba2876f3-bea4-4cae-ba4e-77857a060deb"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:groupHeader groupName="Report_Status">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#8DB4E2" uuid="e86e0b8d-d147-4c76-824a-7550122c5e55"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:groupHeader groupName="Instrument_Type">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#1F497D" uuid="7c54e018-61f9-4a67-923e-65a65f65ca52"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<box>
								<topPen lineWidth="0.5" lineColor="#4F81BD"/>
								<leftPen lineWidth="0.5" lineColor="#4F81BD"/>
								<bottomPen lineWidth="0.5" lineColor="#4F81BD"/>
								<rightPen lineWidth="0.5" lineColor="#4F81BD"/>
							</box>
							<staticText>
								<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#8DB4E2" uuid="5aa42509-2563-483b-8495-fe49006efbee"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font fontName="Arial" isBold="true"/>
								</textElement>
								<text><![CDATA[Direct Cost ($/Ton)]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<box>
								<topPen lineColor="#4F81BD"/>
								<leftPen lineColor="#4F81BD"/>
								<bottomPen lineColor="#4F81BD"/>
								<rightPen lineColor="#4F81BD"/>
							</box>
							<textField pattern="#,##0;(#,##0)" isBlankWhenNull="true">
								<reportElement x="0" y="0" width="90" height="30" uuid="6aeff4f2-965c-48c1-b06c-773994142b24"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Right" verticalAlignment="Middle">
									<font fontName="Arial" size="11"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{SALES_DIRECT_COST}]]></textFieldExpression>
							</textField>
							<textField pattern="#,##0;(#,##0)" isBlankWhenNull="true">
								<reportElement x="0" y="0" width="90" height="30" forecolor="#FF0000" uuid="9603bb0c-3cec-4bce-bb6f-0ddd705fe60c">
									<property name="com.jaspersoft.studio.unit.x" value="pixel"/>
									<property name="com.jaspersoft.studio.unit.y" value="pixel"/>
									<printWhenExpression><![CDATA[$F{SALES_DIRECT_COST}.intValue()<0]]></printWhenExpression>
								</reportElement>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Right" verticalAlignment="Middle">
									<font fontName="Arial" size="11"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{SALES_DIRECT_COST}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="38816724-6756-4dfd-9eba-91da6f1dffab">
						<jr:groupHeader groupName="Contract_Status">
							<jr:cell style="Table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineWidth="0.5" lineColor="#4F81BD"/>
									<leftPen lineWidth="0.5" lineColor="#4F81BD"/>
									<bottomPen lineWidth="0.5" lineColor="#4F81BD"/>
									<rightPen lineWidth="0.5" lineColor="#4F81BD"/>
								</box>
								<textField evaluationTime="Group" evaluationGroup="Contract_Status" pattern="#,##0;(#,##0)" isBlankWhenNull="true">
									<reportElement style="Sub4" mode="Transparent" x="0" y="0" width="90" height="30" backcolor="#C7DAF1" uuid="b55cf0f1-11d1-425f-8b0f-0ce50dd26c3b"/>
									<box leftPadding="4" rightPadding="4"/>
									<textElement textAlignment="Right" verticalAlignment="Middle">
										<font fontName="Arial" size="11" isBold="true" isItalic="false"/>
									</textElement>
									<textFieldExpression><![CDATA[$V{SUB_NET_REALIZATION}]]></textFieldExpression>
								</textField>
							</jr:cell>
						</jr:groupHeader>
						<jr:groupHeader groupName="Report_Status">
							<jr:cell style="Table_CH" height="30" rowSpan="1">
								<box>
									<topPen lineWidth="0.5" lineColor="#4F81BD"/>
									<leftPen lineWidth="0.5" lineColor="#4F81BD"/>
									<bottomPen lineWidth="0.5" lineColor="#4F81BD"/>
									<rightPen lineWidth="0.5" lineColor="#4F81BD"/>
								</box>
								<textField evaluationTime="Group" evaluationGroup="Report_Status" pattern="#,##0;(#,##0)" isBlankWhenNull="true">
									<reportElement style="Mid4" mode="Transparent" x="0" y="0" width="90" height="30" backcolor="#8DB4E2" uuid="88ba91d3-770b-4014-9911-ca74a87cd3cc"/>
									<box leftPadding="4" rightPadding="4"/>
									<textElement textAlignment="Right" verticalAlignment="Middle">
										<font fontName="Arial" size="11" isBold="true" isItalic="false"/>
									</textElement>
									<textFieldExpression><![CDATA[$V{NET_REALIZATION}]]></textFieldExpression>
								</textField>
							</jr:cell>
						</jr:groupHeader>
						<jr:groupHeader groupName="Instrument_Type">
							<jr:cell style="Table_TH" height="30" rowSpan="1">
								<box>
									<topPen lineWidth="0.5" lineColor="#4F81BD"/>
									<leftPen lineWidth="0.5" lineColor="#4F81BD"/>
									<bottomPen lineWidth="0.5" lineColor="#4F81BD"/>
									<rightPen lineWidth="0.5" lineColor="#4F81BD"/>
								</box>
								<textField evaluationTime="Group" evaluationGroup="Instrument_Type" pattern="#,##0;(#,##0)" isBlankWhenNull="true">
									<reportElement style="Total4" mode="Transparent" x="0" y="0" width="90" height="30" backcolor="#1F497D" uuid="6b140e5a-13cd-435f-ad40-f81a0b5c5da1"/>
									<box leftPadding="4" rightPadding="4"/>
									<textElement textAlignment="Right" verticalAlignment="Middle">
										<font fontName="Arial" size="12" isBold="true" isItalic="false"/>
									</textElement>
									<textFieldExpression><![CDATA[$V{TOT_NET_REALIZATION}]]></textFieldExpression>
								</textField>
							</jr:cell>
						</jr:groupHeader>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<box>
								<topPen lineWidth="0.5" lineColor="#4F81BD"/>
								<leftPen lineWidth="0.5" lineColor="#4F81BD"/>
								<bottomPen lineWidth="0.5" lineColor="#4F81BD"/>
								<rightPen lineWidth="0.5" lineColor="#4F81BD"/>
							</box>
							<staticText>
								<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#8DB4E2" uuid="94f4aadc-4e0b-4e10-9631-ec4485fa6e5d"/>
								<box leftPadding="4" rightPadding="4">
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font fontName="Arial" isBold="true"/>
								</textElement>
								<text><![CDATA[Net Realization]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<box>
								<topPen lineColor="#4F81BD"/>
								<leftPen lineColor="#4F81BD"/>
								<bottomPen lineColor="#4F81BD"/>
								<rightPen lineColor="#4F81BD"/>
							</box>
							<textField pattern="#,##0;(#,##0)" isBlankWhenNull="true">
								<reportElement x="0" y="0" width="90" height="30" uuid="b3e2f9c3-7e89-4113-9cd6-e4ea62b8e9dc"/>
								<box leftPadding="4" rightPadding="4">
									<rightPen lineWidth="0.5" lineColor="#4F81BD"/>
								</box>
								<textElement textAlignment="Right" verticalAlignment="Middle">
									<font fontName="Arial" size="11"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{NET_REALIZATION}]]></textFieldExpression>
							</textField>
							<textField pattern="#,##0;(#,##0)" isBlankWhenNull="true">
								<reportElement x="0" y="0" width="90" height="30" forecolor="#FF0000" uuid="f0ad759c-2a2b-419c-8d3e-06e2eef9f7c9">
									<property name="com.jaspersoft.studio.unit.x" value="pixel"/>
									<property name="com.jaspersoft.studio.unit.y" value="pixel"/>
									<printWhenExpression><![CDATA[$F{NET_REALIZATION}.intValue()<0]]></printWhenExpression>
								</reportElement>
								<box leftPadding="4" rightPadding="4">
									<rightPen lineWidth="0.5" lineColor="#4F81BD"/>
								</box>
								<textElement textAlignment="Right" verticalAlignment="Middle">
									<font fontName="Arial" size="11"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{NET_REALIZATION}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="0d956cde-7f40-441d-ae20-7b4ee705b03b">
						<jr:groupHeader groupName="Contract_Status">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineWidth="2.5" lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#C7DAF1" uuid="a5edb95c-d49f-4c5e-9190-e9a4900b2ddf"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:groupHeader groupName="Report_Status">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineWidth="2.5" lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#8DB4E2" uuid="76e55f77-9117-4a64-b726-3867866f52d9"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:groupHeader groupName="Instrument_Type">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineWidth="2.5" lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#1F497D" uuid="aef7903f-3826-4c05-88f8-9e02b377d363"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<box>
								<topPen lineWidth="0.5" lineColor="#4F81BD"/>
								<leftPen lineWidth="2.5" lineColor="#4F81BD"/>
								<bottomPen lineWidth="0.5" lineColor="#4F81BD"/>
								<rightPen lineWidth="0.5" lineColor="#4F81BD"/>
							</box>
							<staticText>
								<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#8DB4E2" uuid="7d30fec9-4b61-436e-aa61-ab15ff0050ca"/>
								<box leftPadding="4" rightPadding="4">
									<leftPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font fontName="Arial" isBold="true"/>
								</textElement>
								<text><![CDATA[Market Price ($/Ton)]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<box>
								<topPen lineColor="#4F81BD"/>
								<leftPen lineWidth="2.5" lineColor="#4F81BD"/>
								<bottomPen lineColor="#4F81BD"/>
								<rightPen lineColor="#4F81BD"/>
							</box>
							<textField pattern="#,##0;(#,##0)" isBlankWhenNull="true">
								<reportElement x="0" y="0" width="90" height="30" uuid="e3114d50-6fe4-407b-b61b-04bb2f3b005b"/>
								<box leftPadding="4" rightPadding="4">
									<leftPen lineWidth="0.5" lineColor="#4F81BD"/>
								</box>
								<textElement textAlignment="Right" verticalAlignment="Middle">
									<font fontName="Arial" size="11"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{MARKET_PRICE}]]></textFieldExpression>
							</textField>
							<textField pattern="#,##0;(#,##0)" isBlankWhenNull="true">
								<reportElement x="0" y="0" width="90" height="30" forecolor="#FF0000" uuid="6a083dd7-2c3d-4a5b-9342-798520c7e516">
									<property name="com.jaspersoft.studio.unit.x" value="pixel"/>
									<property name="com.jaspersoft.studio.unit.y" value="pixel"/>
									<printWhenExpression><![CDATA[$F{MARKET_PRICE}.intValue()<0]]></printWhenExpression>
								</reportElement>
								<box leftPadding="4" rightPadding="4">
									<leftPen lineWidth="0.5" lineColor="#4F81BD"/>
								</box>
								<textElement textAlignment="Right" verticalAlignment="Middle">
									<font fontName="Arial" size="11"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{MARKET_PRICE}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="71660b7e-cd77-4420-86b4-167e1249c3bf">
						<jr:groupHeader groupName="Contract_Status">
							<jr:cell style="Table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineWidth="0.5" lineColor="#4F81BD"/>
									<leftPen lineWidth="0.5" lineColor="#4F81BD"/>
									<bottomPen lineWidth="0.5" lineColor="#4F81BD"/>
									<rightPen lineWidth="0.5" lineColor="#4F81BD"/>
								</box>
								<textField evaluationTime="Group" evaluationGroup="Contract_Status" pattern="#,##0;(#,##0)" isBlankWhenNull="true">
									<reportElement style="Sub5" mode="Transparent" x="0" y="0" width="90" height="30" backcolor="#C7DAF1" uuid="0c055f77-d898-42ed-aa79-e62cf0e57ab4"/>
									<box leftPadding="4" rightPadding="4"/>
									<textElement textAlignment="Right" verticalAlignment="Middle">
										<font fontName="Arial" size="11" isBold="true" isItalic="false"/>
									</textElement>
									<textFieldExpression><![CDATA[$V{SUB_MARKET_VALUE}]]></textFieldExpression>
								</textField>
							</jr:cell>
						</jr:groupHeader>
						<jr:groupHeader groupName="Report_Status">
							<jr:cell style="Table_CH" height="30" rowSpan="1">
								<box>
									<topPen lineWidth="0.5" lineColor="#4F81BD"/>
									<leftPen lineWidth="0.5" lineColor="#4F81BD"/>
									<bottomPen lineWidth="0.5" lineColor="#4F81BD"/>
									<rightPen lineWidth="0.5" lineColor="#4F81BD"/>
								</box>
								<textField evaluationTime="Group" evaluationGroup="Report_Status" pattern="#,##0;(#,##0)" isBlankWhenNull="true">
									<reportElement style="Mid5" mode="Transparent" x="0" y="0" width="90" height="30" backcolor="#8DB4E2" uuid="5bbe6924-e870-4626-a3da-6e7e9e814d65"/>
									<box leftPadding="4" rightPadding="4"/>
									<textElement textAlignment="Right" verticalAlignment="Middle">
										<font fontName="Arial" size="11" isBold="true" isItalic="false"/>
									</textElement>
									<textFieldExpression><![CDATA[$V{MARKET_VALUE}]]></textFieldExpression>
								</textField>
							</jr:cell>
						</jr:groupHeader>
						<jr:groupHeader groupName="Instrument_Type">
							<jr:cell style="Table_TH" height="30" rowSpan="1">
								<box>
									<topPen lineWidth="0.5" lineColor="#4F81BD"/>
									<leftPen lineWidth="0.5" lineColor="#4F81BD"/>
									<bottomPen lineWidth="0.5" lineColor="#4F81BD"/>
									<rightPen lineWidth="0.5" lineColor="#4F81BD"/>
								</box>
								<textField evaluationTime="Group" evaluationGroup="Instrument_Type" pattern="#,##0;(#,##0)" isBlankWhenNull="true">
									<reportElement style="Total5" mode="Transparent" x="0" y="0" width="90" height="30" backcolor="#1F497D" uuid="b2332b03-0d4e-4077-b49c-75104397fad4"/>
									<box leftPadding="4" rightPadding="4"/>
									<textElement textAlignment="Right" verticalAlignment="Middle">
										<font fontName="Arial" size="12" isBold="true" isItalic="false"/>
									</textElement>
									<textFieldExpression><![CDATA[$V{TOT_MARKET_VALUE}]]></textFieldExpression>
								</textField>
							</jr:cell>
						</jr:groupHeader>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<box>
								<topPen lineWidth="0.5" lineColor="#4F81BD"/>
								<leftPen lineWidth="0.5" lineColor="#4F81BD"/>
								<bottomPen lineWidth="0.5" lineColor="#4F81BD"/>
								<rightPen lineWidth="0.5" lineColor="#4F81BD"/>
							</box>
							<staticText>
								<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#8DB4E2" uuid="0e03df59-b384-4c82-881f-2ce466299f12"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font fontName="Arial" isBold="true"/>
								</textElement>
								<text><![CDATA[Market Value]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<box>
								<topPen lineColor="#4F81BD"/>
								<leftPen lineColor="#4F81BD"/>
								<bottomPen lineColor="#4F81BD"/>
								<rightPen lineColor="#4F81BD"/>
							</box>
							<textField pattern="#,##0;(#,##0)" isBlankWhenNull="true">
								<reportElement x="0" y="0" width="90" height="30" uuid="73ca87a3-bf49-4af1-8923-dc1d18c8f6fc"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Right" verticalAlignment="Middle">
									<font fontName="Arial" size="11"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{MARKET_VALUE}]]></textFieldExpression>
							</textField>
							<textField pattern="#,##0;(#,##0)" isBlankWhenNull="true">
								<reportElement x="0" y="0" width="90" height="30" forecolor="#FF0000" uuid="8b6e6ea6-6b09-4c36-ba6b-613875d26a37">
									<property name="com.jaspersoft.studio.unit.x" value="pixel"/>
									<property name="com.jaspersoft.studio.unit.y" value="pixel"/>
									<printWhenExpression><![CDATA[$F{MARKET_VALUE}.intValue()<0]]></printWhenExpression>
								</reportElement>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Right" verticalAlignment="Middle">
									<font fontName="Arial" size="11"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{MARKET_VALUE}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="4b3558bd-4f03-47a1-83f8-2374f2d3a436">
						<jr:groupHeader groupName="Contract_Status">
							<jr:cell style="Table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineWidth="0.5" lineColor="#4F81BD"/>
									<leftPen lineWidth="0.5" lineColor="#4F81BD"/>
									<bottomPen lineWidth="0.5" lineColor="#4F81BD"/>
									<rightPen lineWidth="0.5" lineColor="#4F81BD"/>
								</box>
								<textField evaluationTime="Group" evaluationGroup="Contract_Status" pattern="#,##0;(#,##0)" isBlankWhenNull="true">
									<reportElement style="Sub6" mode="Transparent" x="0" y="0" width="90" height="30" backcolor="#C7DAF1" uuid="9d2c54d2-ebfe-4694-b400-5df11a108f17"/>
									<box leftPadding="4" rightPadding="4"/>
									<textElement textAlignment="Right" verticalAlignment="Middle">
										<font fontName="Arial" size="11" isBold="true" isItalic="false"/>
									</textElement>
									<textFieldExpression><![CDATA[$V{SUB_PNL}]]></textFieldExpression>
								</textField>
							</jr:cell>
						</jr:groupHeader>
						<jr:groupHeader groupName="Report_Status">
							<jr:cell style="Table_CH" height="30" rowSpan="1">
								<box>
									<topPen lineWidth="0.5" lineColor="#4F81BD"/>
									<leftPen lineWidth="0.5" lineColor="#4F81BD"/>
									<bottomPen lineWidth="0.5" lineColor="#4F81BD"/>
									<rightPen lineWidth="0.5" lineColor="#4F81BD"/>
								</box>
								<textField evaluationTime="Group" evaluationGroup="Report_Status" pattern="#,##0;(#,##0)" isBlankWhenNull="true">
									<reportElement style="Mid6" mode="Transparent" x="0" y="0" width="90" height="30" backcolor="#8DB4E2" uuid="820fe9b1-dd38-4a3c-8172-1b120681046e"/>
									<box leftPadding="4" rightPadding="4"/>
									<textElement textAlignment="Right" verticalAlignment="Middle">
										<font fontName="Arial" size="11" isBold="true" isItalic="false"/>
									</textElement>
									<textFieldExpression><![CDATA[$V{PNL}]]></textFieldExpression>
								</textField>
							</jr:cell>
						</jr:groupHeader>
						<jr:groupHeader groupName="Instrument_Type">
							<jr:cell style="Table_TH" height="30" rowSpan="1">
								<box>
									<topPen lineWidth="0.5" lineColor="#4F81BD"/>
									<leftPen lineWidth="0.5" lineColor="#4F81BD"/>
									<bottomPen lineWidth="0.5" lineColor="#4F81BD"/>
									<rightPen lineWidth="0.5" lineColor="#4F81BD"/>
								</box>
								<textField evaluationTime="Group" evaluationGroup="Instrument_Type" pattern="#,##0;(#,##0)" isBlankWhenNull="true">
									<reportElement style="Total6" mode="Transparent" x="0" y="0" width="90" height="30" backcolor="#1F497D" uuid="d683b94f-b2b3-454c-8225-5843d231d128"/>
									<box leftPadding="4" rightPadding="4"/>
									<textElement textAlignment="Right" verticalAlignment="Middle">
										<font fontName="Arial" size="12" isBold="true" isItalic="false"/>
									</textElement>
									<textFieldExpression><![CDATA[$V{TOT_PNL}]]></textFieldExpression>
								</textField>
							</jr:cell>
						</jr:groupHeader>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<box>
								<topPen lineWidth="0.5" lineColor="#4F81BD"/>
								<leftPen lineWidth="0.5" lineColor="#4F81BD"/>
								<bottomPen lineWidth="0.5" lineColor="#4F81BD"/>
								<rightPen lineWidth="0.5" lineColor="#4F81BD"/>
							</box>
							<staticText>
								<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#8DB4E2" uuid="fc304894-b576-4876-b821-bc4d5354b2a7"/>
								<box leftPadding="4" rightPadding="4">
									<rightPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font fontName="Arial" isBold="true"/>
								</textElement>
								<text><![CDATA[PnL]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<box>
								<topPen lineColor="#4F81BD"/>
								<leftPen lineColor="#4F81BD"/>
								<bottomPen lineColor="#4F81BD"/>
								<rightPen lineColor="#4F81BD"/>
							</box>
							<textField pattern="#,##0;(#,##0)" isBlankWhenNull="true">
								<reportElement x="0" y="0" width="90" height="30" uuid="c3fcfa54-c2da-431c-848f-5984309f69ad"/>
								<box leftPadding="4" rightPadding="4">
									<rightPen lineWidth="0.0"/>
								</box>
								<textElement textAlignment="Right" verticalAlignment="Middle">
									<font fontName="Arial" size="11"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{PNL}]]></textFieldExpression>
							</textField>
							<textField pattern="#,##0;(#,##0)" isBlankWhenNull="true">
								<reportElement x="0" y="0" width="90" height="30" forecolor="#FF0000" uuid="99583f0c-ddab-48b2-92cf-c3955fc726de">
									<property name="com.jaspersoft.studio.unit.x" value="pixel"/>
									<property name="com.jaspersoft.studio.unit.y" value="pixel"/>
									<printWhenExpression><![CDATA[$F{PNL}.intValue()<0]]></printWhenExpression>
								</reportElement>
								<box leftPadding="4" rightPadding="4">
									<rightPen lineWidth="0.0"/>
								</box>
								<textElement textAlignment="Right" verticalAlignment="Middle">
									<font fontName="Arial" size="11"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{PNL}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="87e29229-5d55-4c7e-8750-82f0996b2c7e">
						<jr:groupHeader groupName="Contract_Status">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineWidth="2.5" lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#C7DAF1" uuid="b7896807-b96d-4885-9c96-7c0439dd2660"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:groupHeader groupName="Report_Status">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<pen lineWidth="2.5"/>
									<topPen lineWidth="0.5" lineColor="#4F81BD"/>
									<leftPen lineWidth="2.5" lineColor="#4F81BD"/>
									<bottomPen lineWidth="0.5" lineColor="#4F81BD"/>
									<rightPen lineWidth="0.5" lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#8DB4E2" uuid="d0423f89-8442-4069-9f3b-4c4043b32ef6"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:groupHeader groupName="Instrument_Type">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineWidth="2.5" lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#1F497D" uuid="84e750de-15ac-499f-844f-61b662b6b16a"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<box>
								<topPen lineWidth="0.5" lineColor="#4F81BD"/>
								<leftPen lineWidth="2.5" lineColor="#4F81BD"/>
								<bottomPen lineWidth="0.5" lineColor="#4F81BD"/>
								<rightPen lineWidth="0.5" lineColor="#4F81BD"/>
							</box>
							<staticText>
								<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#8DB4E2" uuid="1e8d0ace-759f-4caf-9677-36c9b864fa02"/>
								<box leftPadding="4" rightPadding="4">
									<leftPen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font fontName="Arial" isBold="true"/>
								</textElement>
								<text><![CDATA[Trade Type]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<box>
								<topPen lineColor="#4F81BD"/>
								<leftPen lineWidth="2.5" lineColor="#4F81BD"/>
								<bottomPen lineColor="#4F81BD"/>
								<rightPen lineColor="#4F81BD"/>
							</box>
							<textField isStretchWithOverflow="true" isBlankWhenNull="true">
								<reportElement x="0" y="0" width="90" height="30" uuid="dace1018-c24a-4031-8997-0dc3792c182a"/>
								<box leftPadding="4" rightPadding="4">
									<leftPen lineWidth="0.0"/>
								</box>
								<textElement verticalAlignment="Middle">
									<font fontName="Arial" size="11"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{TRADE_TYPE}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="9414995c-3cdd-4da8-8b27-2f14a85e2b29">
						<jr:groupHeader groupName="Contract_Status">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#C7DAF1" uuid="06d90849-205c-4e8e-801c-c1f52f401451"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:groupHeader groupName="Report_Status">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#8DB4E2" uuid="fcc74cb4-6c1c-497a-9879-f5faec111896"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:groupHeader groupName="Instrument_Type">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#1F497D" uuid="54f00500-439c-4d28-9389-5ae5cafe22ac"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<box>
								<topPen lineWidth="0.5" lineColor="#4F81BD"/>
								<leftPen lineWidth="0.5" lineColor="#4F81BD"/>
								<bottomPen lineWidth="0.5" lineColor="#4F81BD"/>
								<rightPen lineWidth="0.5" lineColor="#4F81BD"/>
							</box>
							<staticText>
								<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#8DB4E2" uuid="83c89254-089a-4232-9575-a1cb81a06dfa"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font fontName="Arial" isBold="true"/>
								</textElement>
								<text><![CDATA[Report Status]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<box>
								<topPen lineColor="#4F81BD"/>
								<leftPen lineColor="#4F81BD"/>
								<bottomPen lineColor="#4F81BD"/>
								<rightPen lineColor="#4F81BD"/>
							</box>
							<textField isStretchWithOverflow="true" isBlankWhenNull="true">
								<reportElement x="0" y="0" width="90" height="30" uuid="acc5ba35-c764-40f3-8822-3b992cd4fe2e"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement verticalAlignment="Middle">
									<font fontName="Arial" size="11"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{REPORT_STATUS}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="24b93e1f-a5eb-4fd1-adef-fc3919bb55cb">
						<jr:groupHeader groupName="Contract_Status">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#C7DAF1" uuid="88267ca0-05f0-4bda-af6d-d56018dedbec"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:groupHeader groupName="Report_Status">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#8DB4E2" uuid="26e8971f-6706-4710-b498-53da064701c1"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:groupHeader groupName="Instrument_Type">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#1F497D" uuid="ba22cf7a-9826-431f-887b-36a5a40d53a8"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<box>
								<topPen lineWidth="0.5" lineColor="#4F81BD"/>
								<leftPen lineWidth="0.5" lineColor="#4F81BD"/>
								<bottomPen lineWidth="0.5" lineColor="#4F81BD"/>
								<rightPen lineWidth="0.5" lineColor="#4F81BD"/>
							</box>
							<staticText>
								<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#8DB4E2" uuid="dc777edd-fce4-4da9-84d5-a6e2952ed567"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font fontName="Arial" isBold="true"/>
								</textElement>
								<text><![CDATA[Contract Status]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<box>
								<topPen lineColor="#4F81BD"/>
								<leftPen lineColor="#4F81BD"/>
								<bottomPen lineColor="#4F81BD"/>
								<rightPen lineColor="#4F81BD"/>
							</box>
							<textField isStretchWithOverflow="true" isBlankWhenNull="true">
								<reportElement x="0" y="0" width="90" height="30" uuid="b66a4bf5-8bac-4d24-a2a2-fad4a618a11c"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement verticalAlignment="Middle">
									<font fontName="Arial" size="11"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{CONTRACT_STATUS}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="340390a6-b250-4e95-b669-38e57ec6e5d9">
						<jr:groupHeader groupName="Contract_Status">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#C7DAF1" uuid="c622d549-10f7-4fc1-a300-5eed0a81f1c2"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:groupHeader groupName="Report_Status">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#8DB4E2" uuid="8afe97bf-c5af-4995-b23f-95e4b68ca7b5"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:groupHeader groupName="Instrument_Type">
							<jr:cell style="table_TD" height="30" rowSpan="1">
								<box>
									<topPen lineColor="#4F81BD"/>
									<leftPen lineColor="#4F81BD"/>
									<bottomPen lineColor="#4F81BD"/>
									<rightPen lineColor="#4F81BD"/>
								</box>
								<staticText>
									<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#1F497D" uuid="11eca3a8-f6bb-4c7b-a7ab-9c45f1ea38b2"/>
									<text><![CDATA[]]></text>
								</staticText>
							</jr:cell>
						</jr:groupHeader>
						<jr:columnHeader style="table_CH" height="30" rowSpan="1">
							<box>
								<topPen lineWidth="0.5" lineColor="#4F81BD"/>
								<leftPen lineWidth="0.5" lineColor="#4F81BD"/>
								<bottomPen lineWidth="0.5" lineColor="#4F81BD"/>
								<rightPen lineWidth="0.5" lineColor="#4F81BD"/>
							</box>
							<staticText>
								<reportElement mode="Opaque" x="0" y="0" width="90" height="30" backcolor="#8DB4E2" uuid="48f90f74-0005-4b7a-9c69-8f738b2e290b"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font fontName="Arial" isBold="true"/>
								</textElement>
								<text><![CDATA[Price Type Status]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="table_TD" height="30" rowSpan="1">
							<box>
								<topPen lineColor="#4F81BD"/>
								<leftPen lineColor="#4F81BD"/>
								<bottomPen lineColor="#4F81BD"/>
								<rightPen lineColor="#4F81BD"/>
							</box>
							<textField isStretchWithOverflow="true" isBlankWhenNull="true">
								<reportElement x="0" y="0" width="90" height="30" uuid="cb7347b7-b079-40d3-83d5-33ca7f2a9657"/>
								<box leftPadding="4" rightPadding="4"/>
								<textElement verticalAlignment="Middle">
									<font fontName="Arial" size="11"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{PRICE_TYPE_STATUS}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
				</jr:table>
			</componentElement>
		</band>
	</detail>
	<pageFooter>
		<band height="20" splitType="Stretch">
			<property name="local_mesure_unitheight" value="pixel"/>
			<property name="com.jaspersoft.studio.unit.height" value="px"/>
			<textField evaluationTime="Auto">
				<reportElement positionType="Float" x="3800" y="0" width="120" height="20" uuid="a4e9b26e-a143-4523-91ef-6262d08988c7"/>
				<textElement verticalAlignment="Middle"/>
				<textFieldExpression><![CDATA["Page " + ($V{currentpage} == null? 1 : $V{currentpage} + 1) + " of " + $V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
		</band>
	</pageFooter>
</jasperReport>
